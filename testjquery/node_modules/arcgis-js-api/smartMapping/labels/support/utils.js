/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../symbols","../../../layers/support/LabelClass","../../../layers/support/LabelExpressionInfo","../../../renderers/support/UniqueValueInfo","../../support/clusterUtils","../../../symbols/TextSymbol"],(function(e,n,t,o,l,a,r){"use strict";function u(e,n){const t=n.featureReduction;if("fields"in t)for(const o of t.fields)if(o.name.toLowerCase()===e.toLowerCase())return o;return null}function s(e){return`\n  $feature["${e}"];\n  var value = $feature["${e}"];\n  var num = Count(Text(Round(value)));\n  var label = When(\n    num < 4, Text(value, "#.#"),\n    num == 4, Text(value / Pow(10, 3), "#.0k"),\n    num <= 6, Text(value / Pow(10, 3), "#k"),\n    num == 7, Text(value / Pow(10, 6), "#.0m"),\n    num > 7, Text(value / Pow(10, 6), "#m"),\n    Text(value, "#,###")\n  );\n  return label;\n  `}function i(e,n,t,o){const r=t.name;if("mode"===t.statisticType){const u="getFieldDomain"in e?e.getFieldDomain(t.onStatisticField):null;let s=null;return"coded-value"===u?.type?s=u.codedValues.map((e=>new l({value:e.code,label:e.name}))):"unique-value"===n?.type&&"string"==typeof n.field&&n.field.toLowerCase()===r.toLowerCase()&&(s=(n.uniqueValueInfos??[]).map((e=>e.clone()))),s?a.getPredominantTypeExpression(s,r,o):`Text($feature["${r}"])`}return s(r)}function f(e,n=!1){const l=new r({haloColor:"#373837",haloSize:"1px",color:"#f0f0f0",font:{family:"Noto Sans",size:"12px",weight:"bold"}});return new t({symbol:l,deconflictionStrategy:"none",labelPlacement:n?"always-horizontal":"center-center",labelExpressionInfo:new o({expression:e})})}e.createLabelClass=f,e.createLabelExpressionForAggregateField=i,e.createNumericLabelExpression=s,e.getAggregateFieldInfo=u,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
