/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../core/Error","../../support/utils","../../support/adapters/support/layerUtils"],(function(e,t,n,a){"use strict";const r=new Set(["date","number"]),i=["years","months","days","hours","minutes","seconds"];function s(e,a,i,s){const o=[];let u=null;return[a,i].every((t=>{const a=n.getDateType(e,t);return a&&o.push(a),!!a}))?o[0]===o[1]?"field"===o[0]?a===i&&(u=new t(s,"'startTime' and 'endTime' parameters cannot be identical")):u=new t(s,"Invalid combination of 'startTime' and 'endTime' parameters"):r.has(o[0])&&r.has(o[1])&&(u=new t(s,"Invalid combination of 'startTime' and 'endTime' parameters")):u=new t(s,"'startTime' and 'endTime' parameters must be one of these values: a date object, unix epoch time, name of a valid date field or <now>"),u}function o(e){const t=e.map((e=>`$feature["${e}"];`));return t.length?t.join("\n")+"\n":""}function u(e,t,n){let a;return a="number"===t?e:"date"===t?e.getTime():'$feature["'+e+'"]',"var "+n+" = "+a+";"}function m(e,t,a,r){const i=n.getDateType(e,t),s=n.getDateType(e,a),m=[u(t,i,"startTime"),u(a,s,"endTime"),`var retVal = null;\n\n    if (startTime != null && endTime != null) {\n      startTime = Date(startTime);\n      endTime = Date(endTime);\n      retVal = DateDiff(endTime, startTime, "${r}");\n    }\n\n    return retVal;`],d=[];return"field"===i&&d.push(t),"field"===s&&d.push(a),o(d)+m.join("\n")}function d(e){const{layer:t,startTime:r,endTime:i}=e,s=a.createLayerAdapter(t),o=e.unit||"days",u=n.getDateDiffSQL(s,r,i,o);return{valueExpression:m(s,r,i,o),statisticsQuery:u,histogramQuery:u}}e.getAgeExpressions=d,e.supportedAgeUnits=i,e.verifyDates=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
