/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../../core/Error","./support/utils","../support/binningUtils","../support/utils","../support/adapters/support/layerUtils"],(function(e,i,r,s,a){"use strict";async function n(n){if(!n?.layer||!n.field&&!n.valueExpression)throw new e("unique-values:missing-parameters","'layer' and 'field' or 'valueExpression' parameters are required");const t=n.valueExpression||n.sqlExpression,l=t&&!n.sqlExpression;if(t)if(l){if(!n.view)throw new e("unique-values:missing-parameters","View is required when 'valueExpression' is specified")}else if(!n.valueExpression)throw new e("unique-values:missing-parameters","'valueExpression' parameters are required");n.forBinning&&r.verifyBinningParams(n,"unique-values");const{layer:u,...o}=n,p=n.forBinning?a.binningCapableLayerTypes:a.defaultSupportedLayerTypes,f=a.createLayerAdapter(u,p,n.forBinning);if(!f)throw new e("unique-values:invalid-parameters","'layer' must be one of these types: "+a.getLayerTypeLabels(p).join(", "));const d={layerAdapter:f,...o},y=null!=d.signal?{signal:d.signal}:null;await f.load(y);const v=await s.getFieldsList({field:d.field,field2:d.field2,field3:d.field3,valueExpression:d.valueExpression}),c=i.verifyBasicFieldValidity(f,v,"unique-values:invalid-parameters");if(c)throw c;const w=i.verifyFilterValidty(d.filter,"summary-statistics:invalid-parameters");if(w)throw w;return d}async function t(e){const{layerAdapter:i,...r}=await n(e);return i.uniqueValues(r)}return t}));
