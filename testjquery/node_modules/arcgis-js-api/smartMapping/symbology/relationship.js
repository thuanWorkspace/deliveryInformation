/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../Color","../../core/arrayUtils","../../core/lang","./support/colors","./support/symbologyUtils","./support/utils"],(function(e,o,r,a,l,n,s){"use strict";const t={light:{color:[153,153,153,.25],width:"1px"},dark:{color:[153,153,153,.25],width:"1px"},darker:{color:[26,26,26,.25],width:"1px"}},i={lightBasemaps:{primary:"relationship-blue-orange-brown",secondary:["relationship-brewer-yellow-blue-black","relationship-brewer-pink-blue-purple","relationship-purple-green-blue","relationship-blue-green-purple","relationship-blue-orange-green","relationship-mustard-blue-wine","relationship-pink-blue-purple","relationship-olive-blue-green","relationship-yellow-cyan-blue","relationship-blue-pink-purple","relationship-purple-green-wine","relationship-blue-peach-purple","relationship-mint-mustard-green","relationship-purple-mustard-darkpurple","relationship-blue-orange-purple","relationship-pink-periwinkle-violet","relationship-blue-tan-green","relationship-blue-red-pink","relationship-blue-green-brightgreen","relationship-blue-orange-lavender","relationship-pink-purple-peach","relationship-purple-mustard-eggshell","relationship-blue-brick-green","relationship-orange-purple-lavender","relationship-brown-purple-lilac","relationship-teal-yellow-lightteal"]},darkBasemaps:{primary:"relationship-blue-green-brightgreen",secondary:["relationship-blue-red-pink","relationship-blue-orange-lavender","relationship-pink-purple-peach","relationship-purple-mustard-eggshell","relationship-blue-brick-green","relationship-orange-purple-lavender","relationship-brown-purple-lilac","relationship-teal-yellow-lightteal","relationship-blue-orange-brown","relationship-brewer-yellow-blue-black","relationship-brewer-pink-blue-purple","relationship-purple-green-blue","relationship-blue-green-purple","relationship-blue-orange-green","relationship-mustard-blue-wine","relationship-pink-blue-purple","relationship-olive-blue-green","relationship-yellow-cyan-blue","relationship-blue-pink-purple","relationship-purple-green-wine","relationship-blue-peach-purple","relationship-mint-mustard-green","relationship-purple-mustard-darkpurple","relationship-blue-orange-purple","relationship-pink-periwinkle-violet","relationship-blue-tan-green"]}},p="#aaaaaa",c="8px",u="2px",m={default:{name:"default",label:"Default",description:"Default theme for visualizing features based on relationship between two attributes.",schemes:{point:{light:{common:{noDataColor:p,outline:t.light,size:c},primary:i.lightBasemaps.primary,secondary:i.lightBasemaps.secondary},dark:{common:{noDataColor:p,outline:t.darker,size:c},primary:i.darkBasemaps.primary,secondary:i.darkBasemaps.secondary}},polyline:{light:{common:{noDataColor:p,width:u},primary:i.lightBasemaps.primary,secondary:i.lightBasemaps.secondary},dark:{common:{noDataColor:p,width:u},primary:i.darkBasemaps.primary,secondary:i.darkBasemaps.secondary}},polygon:{light:{common:{noDataColor:p,outline:t.light,fillOpacity:.8},primary:i.lightBasemaps.primary,secondary:i.lightBasemaps.secondary},dark:{common:{noDataColor:p,outline:t.dark,fillOpacity:.8},primary:i.darkBasemaps.primary,secondary:i.darkBasemaps.secondary}}}}},h=n.createThemes({themeDictionary:m});function g(e){return n.getThemesforBasemap(h,e)}function d(e){const o="default",a=n.getRawSchemes({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme,theme:h.get(o)});if(!a)return;const{schemesInfo:l,basemapId:s,basemapTheme:t}=a,i={...e,basemap:s};return{primaryScheme:F(i,l.primary,l.common),secondarySchemes:l.secondary.map((e=>F(i,e,l.common))).filter(r.isSome),basemapId:s,basemapTheme:t}}function y(e){return n.filterSchemesByName(e.name,d(e))}function b(e){return n.filterSchemesByTag(e.includedTags,e.excludedTags,d(e))}function f(e){if(!e)return;const r={...e};return r.colorsForClassBreaks=r.colorsForClassBreaks.map((e=>({numClasses:e.numClasses,colors:e.colors.map((e=>e.map((e=>new o(e)))))}))),r.tags=[...r.tags],r.noDataColor&&(r.noDataColor=new o(r.noDataColor)),"outline"in r&&r.outline&&(r.outline={color:r.outline.color&&new o(r.outline.color),width:r.outline.width}),r}function w(e,o){e=a.clone(e);let r=[];const l=(o||"HH").split(""),n=l[0],s=l[1];"L"===n&&e.reverse();const t="H"===s;return e.forEach((e=>{t&&e.reverse(),r=r.concat(e)})),r}function C(e,r,a){let l;return e.colorsForClassBreaks.some((e=>(e.numClasses===r&&(l=e.colors),!!l))),l=l?.map((e=>e.map((e=>new o(e))))),l?w(l,a):null}function k(e,o){const r=o?e:f(e);return r.colorsForClassBreaks.forEach((e=>{const o=e.colors.reverse(),r=[];for(let a=0;a<e.numClasses;a++){const e=[];o.forEach((o=>{e.push(o[a])})),r.push(e)}e.colors=r})),r}function B(e){const o=e.theme||"default",r=e.geometryType,a=e.colors,l=e.numClasses,n=h.get(o);if(!n)return[];const s=n.supportedBasemaps,t=[];return s.forEach((e=>{const n=d({theme:o,basemap:e,geometryType:r});if(n){let e=T(n.primaryScheme,a,l);e&&t.push(e),n.secondarySchemes.forEach((o=>{e=T(o,a,l),e&&t.push(e)}))}})),t}function D(e,o,r,a){let l;const n=C(e,r,a);if(n){1===s.hasIdenticalColors(o,n)&&(l=e)}return l}function S(e,o,r,a){let l,n=1;do{l=D(e,o,r,a),l||(e=k(e),n++)}while(!l&&n<=4);return l}function T(e,o,r){return S(e,o,r,"HH")||S(e,o,r,"HL")||S(e,o,r,"LH")||S(e,o,r,"LL")}function F(e,o,r){const a="mesh"!==e.geometryType&&e.worldScale?e.view:null,n=l[o],s=e.theme||"default";if(!n)return;const t=s+"/"+e.basemap+"/"+o,i=[];for(const l in n)if("stops"!==l&&"name"!==l&&"tags"!==l){const e=+l,o=n[l];i.push({numClasses:e,colors:o})}switch(e.geometryType){case"point":case"multipoint":{const e=r;return v({id:t,name:n.name,tags:n.tags,colorsForClassBreaks:i,noDataColor:e.noDataColor,opacity:1,outline:e.outline,size:e.size},a)}case"polyline":{const e=r;return z({id:t,name:n.name,tags:n.tags,colorsForClassBreaks:i,noDataColor:e.noDataColor,opacity:1,width:e.width},a)}case"polygon":{const e=r;return x({id:t,name:n.name,tags:n.tags,colorsForClassBreaks:i,noDataColor:e.noDataColor,opacity:e.fillOpacity,outline:e.outline})}case"mesh":{const e=r;return H({id:t,name:n.name,tags:n.tags,colorsForClassBreaks:i,noDataColor:e.noDataColor,opacity:e.fillOpacity})}}}function v(e,r){return{id:e.id,name:e.name,tags:[...e.tags],colorsForClassBreaks:E(e.colorsForClassBreaks),noDataColor:new o(e.noDataColor),outline:{color:new o(e.outline.color),width:e.outline.width},size:r?s.toWorldScale(e.size,r):e.size,opacity:e.opacity}}function z(e,r){return{id:e.id,name:e.name,tags:[...e.tags],colorsForClassBreaks:E(e.colorsForClassBreaks),noDataColor:new o(e.noDataColor),opacity:e.opacity,width:r?s.toWorldScale(e.width,r):e.width}}function x(e){return{id:e.id,name:e.name,tags:[...e.tags],colorsForClassBreaks:E(e.colorsForClassBreaks),noDataColor:new o(e.noDataColor),outline:{color:new o(e.outline.color),width:e.outline.width},opacity:e.opacity}}function H(e){return{id:e.id,name:e.name,tags:[...e.tags],colorsForClassBreaks:E(e.colorsForClassBreaks),noDataColor:new o(e.noDataColor),opacity:e.opacity}}function E(e){return e.map((e=>({numClasses:e.numClasses,colors:e.colors.map((e=>e.map((e=>new o(e)))))})))}e.cloneScheme=f,e.flatten2DArray=w,e.flipColors=k,e.getColors=C,e.getMatchingSchemes=B,e.getSchemeByName=y,e.getSchemes=d,e.getSchemesByTag=b,e.getThemes=g,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
