/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../TimeExtent","../core/arrayUtils","../core/timeUtils"],(function(e,t,n,i){"use strict";function o(e){return void 0!==e.timeInfo}async function s(e,i){if(0===e.length)return t.allTime;const s=e.filter(o);await Promise.all(s.map((e=>e.load({signal:i}))));const l=[],a=[];for(const t of s)"feature"!==t?.type&&"map-image"!==t?.type||!t.timeInfo?.hasLiveData?a.push(t):l.push(t);const f=e=>null==e||e.isAllTime,r=a.map((e=>e.timeInfo?.fullTimeExtent));if(r.some(f))return t.allTime;const u=l.map((async e=>{const{timeExtent:t}=await e.fetchRecomputedExtents({signal:i});return t||e.timeInfo?.fullTimeExtent})),m=(await Promise.allSettled(u)).map((e=>"fulfilled"===e.status?e.value:null));if(m.some(f))return t.allTime;return[...m,...r].filter(n.isSome).reduce(((e,t)=>e.union(t)))}function l(e){if(!e)return e;const{start:n,end:o}=e;return new t({start:null!=n?i.offsetDate(n,-n.getTimezoneOffset(),"minutes"):n,end:null!=o?i.offsetDate(o,-o.getTimezoneOffset(),"minutes"):o})}function a(e){if(!e)return e;const{start:n,end:o}=e;return new t({start:null!=n?i.offsetDate(n,n.getTimezoneOffset(),"minutes"):n,end:null!=o?i.offsetDate(o,o.getTimezoneOffset(),"minutes"):o})}e.getTimeExtentFromLayers=s,e.toLocalTimeExtent=a,e.toUTCTimeExtent=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
