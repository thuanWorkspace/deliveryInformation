/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../chunks/tslib.es6","../core/Collection","../core/collectionUtils","../core/Logger","../core/promiseUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass","../layers/Layer"],(function(e,r,t,s,o,a,i,n,l,d,y,c){"use strict";function h(e,r,t){let s,o;if(e)for(let a=0,i=e.length;a<i;a++){if(s=e.at(a),s?.[r]===t)return s;if("group"===s?.type&&(o=h(s.layers,r,t),o))return o}}const p=e=>{let n=class extends e{constructor(...e){super(...e),this.layers=new t;const r=e=>{e.parent&&"remove"in e.parent&&e.parent.remove(e)},s=e=>{e.parent=this,this.layerAdded(e),"elevation"!==e.type&&"base-elevation"!==e.type||o.getLogger(this).error(`Layer 'title:${e.title}, id:${e.id}' of type '${e.type}' is not supported as an operational layer and will therefore be ignored.`)},a=e=>{e.parent=null,this.layerRemoved(e)};this.addHandles([this.layers.on("before-add",(e=>r(e.item))),this.layers.on("after-add",(e=>s(e.item))),this.layers.on("after-remove",(e=>a(e.item)))])}destroy(){const e=this.layers.toArray();for(const r of e)r.destroy();this.layers.destroy()}set layers(e){this._set("layers",s.referenceSetter(e,this._get("layers")))}add(e,r){const t=this.layers;if(r=t.getNextIndex(r),e instanceof c){const s=e;s.parent===this?this.reorder(s,r):t.add(s,r)}else a.isPromiseLike(e)?e.then((e=>{this.destroyed||this.add(e,r)})):o.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(e,r){const t=this.layers;let s=t.getNextIndex(r);e.slice().forEach((e=>{e.parent!==this?(t.add(e,s),s+=1):this.reorder(e,s)}))}findLayerById(e){return h(this.layers,"id",e)}findLayerByUid(e){return h(this.layers,"uid",e)}remove(e){return this.layers.remove(e)}removeMany(e){return this.layers.removeMany(e)}removeAll(){return this.layers.removeAll()}reorder(e,r){return this.layers.reorder(e,r)}layerAdded(e){}layerRemoved(e){}};return r.__decorate([i.property()],n.prototype,"layers",null),n=r.__decorate([y.subclass("esri.support.LayersMixin")],n),n};e.LayersMixin=p,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
