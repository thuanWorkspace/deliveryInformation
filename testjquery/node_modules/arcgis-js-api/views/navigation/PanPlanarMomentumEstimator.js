/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../chunks/vec3","../../chunks/vec3f64","./FilteredFiniteDifference","./Momentum"],(function(e,t,i,s,n){"use strict";class r extends n.Momentum{constructor(e,t,i,s,n){super(e,t,i),this._sceneVelocity=s,this.direction=n}value(e){return super.valueFromInitialVelocity(this._sceneVelocity,e)}}class l{constructor(e=300,t=12,n=.84){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=n,this.enabled=!0,this._time=new s.FilteredFiniteDifference(.6),this._screen=[new s.FilteredFiniteDifference(.4),new s.FilteredFiniteDifference(.4)],this._scene=[new s.FilteredFiniteDifference(.6),new s.FilteredFiniteDifference(.6),new s.FilteredFiniteDifference(.6)],this._tmpDirection=i.create()}add(e,t,i){if(this.enabled){if(this._time.hasLastValue()){if(this._time.computeDelta(i)<.015)return}this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._scene[0].update(t[0]),this._scene[1].update(t[1]),this._scene[2].update(t[2]),this._time.update(i)}}reset(){this._screen[0].reset(),this._screen[1].reset(),this._scene[0].reset(),this._scene[1].reset(),this._scene[2].reset(),this._time.reset()}evaluateMomentum(){if(!this.enabled||!this._screen[0].hasFilteredDelta()||!this._time.hasFilteredDelta())return null;const e=this._screen[0].filteredDelta,t=this._screen[1].filteredDelta,i=null==e||null==t?0:Math.sqrt(e*e+t*t),s=this._time.filteredDelta,n=null==s||null==i?0:i/s;return Math.abs(n)<this._minimumInitialVelocity?null:this.createMomentum(n,this._stopVelocity,this._friction)}createMomentum(e,i,s){t.set(this._tmpDirection,this._scene[0].filteredDelta??0,this._scene[1].filteredDelta??0,this._scene[2].filteredDelta??0);const n=t.length(this._tmpDirection);n>0&&t.scale(this._tmpDirection,this._tmpDirection,1/n);const l=this._time.filteredDelta;return new r(e,i,s,null==l?0:n/l,this._tmpDirection)}}e.PanPlanarMomentum=r,e.PanPlanarMomentumEstimator=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
