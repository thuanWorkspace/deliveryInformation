/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../core/quantityUtils","../../core/unitUtils","../../chunks/earcut","../../chunks/vec3","../../chunks/vec3f64","../../geometry/projection/projectVectorToVector","../../geometry/support/plane","../../geometry/support/triangle","./measurementUtils"],(function(e,t,n,r,o,c,a,l,u,i){"use strict";function s(e,t=h()){return p(e,t)}function f(e,t=h()){return p(e,t,!1)}function p(e,r,s=e.hasZ){const f=i.computeEuclideanMeasurementSR(e.spatialReference),p=n.areaUnitFromSpatialReference(f);if(null==p)return null;const h=(e,t)=>!(t.length<2)&&(o.set(e,t[0],t[1],s&&t[2]||0),!0);let A=0;for(const t of e.rings){const n=t.length;if(n<3)continue;const{positionsWorldCoords:i}=r;for(;i.length<n;)i.push(c.create());const s=d,p=o.set(g,0,0,0),P=1/n;for(let r=0;r<n;r++){if(!h(s,t[r]))return null;if(!a.projectVectorToVector(s,e.spatialReference,i[r],f))return null;o.scaleAndAdd(p,p,i[r],P)}const y=l.fromPoints(i[0],i[1],p,l.wrap());if(0===o.squaredLength(l.normal(y)))continue;for(let e=0;e<n;e++)l.projectPointLocal(y,p,i[e],i[e]);const j=m(i);for(let e=0;e<j.length;e+=3)A+=u.areaPoints2d(i[j[e]],i[j[e+1]],i[j[e+2]])}return t.createArea(A,p)}const d=c.create(),g=c.create();function h(){return{positionsWorldCoords:[]}}function m(e){return r.earcut(A(e),[],2)}function A(e){const t=new Float64Array(2*e.length);for(let n=0;n<e.length;++n){const r=e[n],o=2*n;t[o]=r[0],t[o+1]=r[1]}return t}e.computeEuclideanPlanarArea=p,e.createEuclideanPlanarAreaCache=h,e.euclideanHorizontalPlanarArea=f,e.euclideanPlanarArea=s,e.triangulate=m,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
