/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../core/devEnvironmentUtils","../../../../core/Error","../../../../core/promiseUtils","../../../../core/urlUtils","../../../../portal/Portal","../../../../chunks/persistableUrlUtils","../../../../symbols/support/styleUtils","../../../../symbols/support/webStyleSymbolUtils"],(function(e,t,r,l,o,n,s,a,m){"use strict";async function i(e,t,o){if(!e.name)throw new r("style-symbol-reference-name-missing","Missing name in style symbol reference");if(e.styleName&&"Esri2DPointSymbolsStyle"===e.styleName)return y(e,o);try{return c(await a.fetchStyle(e,t,o),e.name,t,o)}catch(n){return l.throwIfAbortError(n),null}}async function y(e,t){const r=a.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,e.name);try{const e=await a.requestJSON(r,t);return a.makeCIMSymbolRef(e.data)}catch(o){return l.throwIfAbortError(o),null}}async function c(e,i,y,c){const u={portal:null!=y?.portal?y.portal:n.getDefault(),url:o.urlToObject(e.baseUrl),origin:"portal-item"},b=m.getStyleItemFromStyle(i,e.data);if(!b){throw new r("symbolstyleutils:symbol-name-not-found",`The symbol name '${i}' could not be found`,{symbolName:i})}let f=s.fromJSON(a.symbolUrlFromStyleItem(b,"cimRef"),u);t.isDevEnvironment()&&(f=t.adjustStaticAGOUrl(f));try{const e=await a.requestJSON(f,c);return a.makeCIMSymbolRef(e.data)}catch(S){return l.throwIfAbortError(S),null}}e.fetchCIMSymbolReference=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
