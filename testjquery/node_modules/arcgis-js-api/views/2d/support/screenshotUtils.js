/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../support/screenshotUtils"],(function(t,e){"use strict";const i={flipY:!0,premultipliedAlpha:!0};async function n(t,n){const h=await o(t,n),{format:a,quality:r}=e.getFormatAndQuality(n?.format,n?.quality);return e.encode(h,{format:a,quality:r,rotation:0,disableDecorations:!1},i)}async function h(t,n){const h=await o(t,n);return e.encodeData(h,i)}function o(t,e){const i=l(e||{},r(t.stage,t.size),t.size,t.padding),n=a(e,t.allLayerViews);return t.stage.takeScreenshot(i,n,t.backgroundColor,e?.rotation)}function a(t={},e){if(!t.layers)return;const i=[];return t.layers.forEach((t=>{const n=e.find((e=>e.layer.id===t.id));n?.container&&i.push(n.container)})),i}function r(t,i){return Math.min(4,e.getMaximumResolutionScale(i,Math.min(4096,t.context.parameters.maxTextureSize)))}function l(t,e,i,n){t.ignorePadding&&(n={left:0,right:0,top:0,bottom:0});let h=null;null!=t.width&&null!=t.height?h=[t.width,t.height]:null==t.width&&null!=t.height?h=[t.height,t.height]:null!=t.width&&null==t.height?h=[t.width,t.width]:null==t.width&&null==t.height&&(h=null);const o=i[0]-(n.left+n.right),a=i[1]-(n.top+n.bottom);let r,l,u=t.area||{x:0,y:0,width:o,height:a};if(h){const t=o/a,e=h[0]/h[1];if(e>t){const t=u.width/e;u={x:u.x,y:Math.round(u.y+(u.height-t)/2),width:u.width,height:Math.round(t)}}else{const t=u.height*e;u={x:Math.round(u.x+(u.width-t)/2),y:u.y,width:Math.round(t),height:u.height}}}else h=[u.width,u.height];return h[0]>u.width?(r=Math.min(h[0]/u.width,e),l=h[0]/u.width/r):(r=1,l=h[0]/u.width),{cropArea:{x:Math.round((u.x+n.left)*r),y:Math.round((u.y+n.top)*r),width:Math.round(u.width*r),height:Math.round(u.height*r)},outputScale:l,resolutionScale:r}}t.createScreenshotRegion=l,t.takeRawScreenshot=h,t.takeScreenshot=n,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
