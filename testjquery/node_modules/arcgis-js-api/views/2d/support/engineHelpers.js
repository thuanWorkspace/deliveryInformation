/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../core/BidiText","../../../core/screenUtils","../engine/webgl/alignmentUtils","../engine/webgl/definitions","../engine/webgl/mesh/templates/shapingUtils"],(function(e,t,i,n,o,s){"use strict";async function a(e,a,r){const g=n.getXAnchorDirection("center"),l=n.getYAnchorDirection("middle"),c=a.painter.textureManager.rasterizeItem(e.toJSON(),window.devicePixelRatio||1,void 0,r),[,d]=t.bidiText(e.text),h=(await c).glyphMosaicItems;return s.shapeGlyphs(h??[],d,{angle:e.angle??0,xOffset:i.pt2px(e.xoffset??0),yOffset:i.pt2px(e.yoffset??0),lineHeight:o.magicLabelLineHeight*Math.max(.25,e.lineHeight),maxLineWidth:Math.max(32,Math.min(i.pt2px(e.lineWidth),512)),decoration:e.font.decoration,scale:Math.min(Math.round(i.pt2px(e.font.size)),127)/o.glyphSize,hAlign:g,vAlign:l,isCIM:!1,hasBackground:!!e.backgroundColor,borderLineSize:e.borderLineSize}).boundsT}let r=a;async function g(e,t,i){return r(e,t.stage,i)}const l={stubGetTextBounds:e=>r=e,restoreGetTextBounds:()=>r=a};e.getTextBounds=g,e.test=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
