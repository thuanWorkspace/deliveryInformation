/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../enums","./Programs"],(function(r,e){"use strict";class a{constructor(){this._programByKey=new Map}dispose(){this._programByKey.forEach((r=>r.dispose())),this._programByKey.clear()}getMaterialProgram(r,e,a){const t=e.key<<3|this._getMaterialOptionsValue(e.type,a);if(this._programByKey.has(t))return this._programByKey.get(t);const s=this._getProgramTemplate(e.type),{shaders:n}=s,{vertexShader:o,fragmentShader:c}=n(a),g=e.getShaderHeader(),i=e.getShaderMain(),p=o.replace("#pragma header",g).replace("#pragma main",i),d=r.programCache.acquire(p,c,e.getAttributeLocations());return this._programByKey.set(t,d),d}_getMaterialOptionsValue(e,a){switch(e){case r.ShaderProgramType.BACKGROUND:{const r=a;return(r.pattern?1:0)<<1|(r.id?1:0)}case r.ShaderProgramType.FILL:{const r=a;return(r.pattern?1:0)<<1|(r.id?1:0)}case r.ShaderProgramType.OUTLINE:return a.id?1:0;case r.ShaderProgramType.LINE:{const r=a;return(r.sdf?1:0)<<2|(r.pattern?1:0)<<1|(r.id?1:0)}case r.ShaderProgramType.ICON:{const r=a;return(r.sdf?1:0)<<1|(r.id?1:0)}case r.ShaderProgramType.CIRCLE:return a.id?1:0;case r.ShaderProgramType.TEXT:return a.id?1:0;default:return 0}}_getProgramTemplate(a){switch(a){case r.ShaderProgramType.BACKGROUND:return e.background;case r.ShaderProgramType.CIRCLE:return e.circle;case r.ShaderProgramType.FILL:return e.fill;case r.ShaderProgramType.ICON:return e.icon;case r.ShaderProgramType.LINE:return e.line;case r.ShaderProgramType.OUTLINE:return e.outline;case r.ShaderProgramType.TEXT:return e.text;default:return null}}}return a}));
