/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../../../../../chunks/vec4f32","../Utils","./WGLBrush","../shaders/BackgroundPrograms","../../../../webgl/enums","../../../../webgl/ProgramTemplate"],(function(e,t,r,s,o,a){"use strict";const i=()=>t.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:o.DataType.SHORT}]});class n extends r{constructor(){super(...arguments),this._color=e.fromValues(0,1,0,1)}dispose(){this._program&&this._program.dispose()}prepareState({context:e}){e.setStencilTestEnabled(!0),e.setBlendingEnabled(!1),e.setFaceCullingEnabled(!1),e.setColorMask(!1,!1,!1,!1),e.setStencilOp(o.StencilOperation.KEEP,o.StencilOperation.KEEP,o.StencilOperation.REPLACE),e.setStencilWriteMask(255),e.setStencilFunction(o.CompareFunction.ALWAYS,0,255)}draw(e,t){const{context:r,state:n,requestRender:l,allowDelayedRender:c}=e,p=i(),u=t.getVAO(r,n,p.attributes,p.bufferLayouts);null!=u.indexBuffer&&(this._program||(this._program=a.createProgram(r,s.background)),!c||null==l||this._program.compiled?(r.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",n.displayMat3),r.bindVAO(u),r.drawElements(o.PrimitiveType.TRIANGLES,u.indexBuffer.size,o.DataType.UNSIGNED_INT,0),r.bindVAO()):l())}}return n}));
