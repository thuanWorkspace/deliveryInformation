/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../definitions","./heuristics","../util/Writer"],(function(e,t,r,s){"use strict";class i{constructor(e,t,i){this._start={index:0,vertex:0};const h=r.getMeshSizeHint(e,t,i),n=t/4;this.geometryType=e,this._records=new s(Int32Array,h.recordBytes),this._indices=new s(Uint32Array,h.indexBytes),this._vertices=new s(Uint32Array,h.vertexBytes),this._metrics=new s(Float32Array,0),this._strideInt=n}serialize(e){const t=this._records.buffer(),r=this._indices.buffer(),s=this._vertices.buffer(),i=this._metrics.length?this._metrics.buffer():null,h=4*this._strideInt;return e.push(t,r,s),{stride:h,records:t,indices:r,vertices:s,metrics:i}}get strideInt(){return this._strideInt}get recordCount(){return this._records.length/t.displayRecordIntPerElement}get vertexCount(){return this._vertices.length/this._strideInt}get indexCount(){return this._indices.length}get indexWriter(){return this._indices}get vertexWriter(){return this._vertices}get metricWriter(){return this._metrics}vertexEnsureSize(e){this._vertices.ensureSize(e)}indexEnsureSize(e){this._indices.ensureSize(e)}recordStart(){this._start.index=this._indices.length,this._start.vertex=this._vertices.length}recordEnd(e,t,r,s,i,h,n,c){this._records.push(e),this._records.push(t??0),this._records.push(r),this._records.push(s),this._records.push(i),this._records.push(h),this._records.push(n),this._records.writeF32(c)}writeIndex(e){this._indices.push(e)}writeVertex(e){this._vertices.push(e)}writeVertexF32(e){this._vertices.writeF32(e)}copyLastFrom(e,r,s){const i=e._records.length-t.displayRecordIntPerElement,h=e._records.getValue(i),n=e._records.getValue(i+1),c=e._records.getValue(i+2),d=e._records.getValue(i+4),_=e._records.getValue(i+6),o=e._records.getValue(i+7),u=this._vertices.length,l=(e._start.vertex-this._vertices.length)/this._strideInt,g=this._indices.length,a=this.vertexCount;for(let t=e._start.index;t!==e._indices.length;t++){const r=e._indices.getValue(t);this._indices.push(r-l)}for(let t=e._start.vertex;t!==e._vertices.length;t++){const r=e._vertices.getValue(t);this._vertices.push(r)}for(let t=u;t<=this._vertices.length;t+=this._strideInt)this._vertices.i1616Add(t,r,s);this._records.push(h),this._records.push(n),this._records.push(c),this._records.push(g),this._records.push(d),this._records.push(a),this._records.push(_),this._records.push(o)}}e.VertexDataWriter=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
