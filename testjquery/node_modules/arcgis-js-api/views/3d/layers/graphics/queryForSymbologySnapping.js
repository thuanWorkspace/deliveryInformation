/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../core/promiseUtils","../../../../support/arcadeOnDemand"],(function(e,n,t){"use strict";async function r(e,r,o){if(null==e||0===r.candidates.length)return a;const i=e.graphics3DGraphicsByObjectID??e.graphics3DGraphics,c=[],s=[],{renderer:d}=e,l=null!=d&&"arcadeRequired"in d&&d.arcadeRequired?t.loadArcade():null,u=async(n,{graphic:t,graphics3DSymbol:r})=>{const a=await l,i=await e.getRenderingInfoAsync(t,d,a,{signal:o});return null==i?[]:r.queryForSnapping(n,g,i,o)},{candidates:p,spatialReference:g}=r;for(let n=0;n<p.length;++n){const e=p[n],{objectId:t}=e,r="number"==typeof t?i?.get(t):void 0;if(null==r)continue;const{graphics3DSymbol:a}=r;a.symbologySnappingSupported&&(c.push(u(e,r)),s.push(n))}if(0===c.length)return a;const h=await Promise.all(c);n.throwIfAborted(o);const f=[],y=[];for(let n=0;n<h.length;++n){const e=h[n],t=s[n];for(const n of e)f.push(n),y.push(t)}return{candidates:f,sourceCandidateIndices:y}}const a={candidates:[],sourceCandidateIndices:[]};e.queryForSymbologySnapping=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
