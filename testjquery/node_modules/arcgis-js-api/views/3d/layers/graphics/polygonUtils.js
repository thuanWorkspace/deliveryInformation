/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../geometry","../../../../core/mathUtils","../../../../core/unitUtils","../../../../chunks/earcut","../../../../chunks/vec3","../../../../geometry/support/Axis","../../../../geometry/support/Indices","../../../../geometry/support/plane","../../webgl-engine/lib/Attribute","../../webgl-engine/lib/ContentObjectType","../../webgl-engine/lib/Geometry","../../webgl-engine/lib/VertexAttribute","../../../../geometry/Extent","../../../../geometry/Polygon"],(function(t,e,r,i,n,a,o,u,s,c,b,l,g,A,y){"use strict";function p(t,e,r,n){const o=(t=>!Array.isArray(t[0]))(e)?(t,r)=>e[3*t+r]:(t,r)=>e[t][r],u=n?i.getMetersPerUnitForSR(n)/i.getMetersPerVerticalUnitForSR(n):1;return s.fromManyPoints(t,((t,e)=>a.set(t,o(e,0)*u,o(e,1)*u,o(e,2))),r)}function h(t,e,i){const n=p(m,t,e,i)?s.normal(m):[0,0,1];return Math.abs(n[2])>Math.cos(r.deg2rad(80))?o.Axis.Z:Math.abs(n[1])>Math.abs(n[0])?o.Axis.Y:o.Axis.X}const m=s.create();function d(t,e,r){const i=h(t,(e.length>0?e[0]:t.length/3)-1,r);if(i!==o.Axis.Z){t=t.slice();for(let e=0;e<t.length;e+=3)t[e+i]=t[e+2]}return n.earcut(t,e,3)}function x(t){const e=[[g.VertexAttribute.POSITION,new c.Attribute(t.attributeData.position,t.indices,3,!0)]],r=u.getZeroIndexArray(t.indices.length);return null!=t.attributeData.colorFeature?e.push([g.VertexAttribute.COLORFEATUREATTRIBUTE,new c.Attribute([t.attributeData.colorFeature],r,1,!0)]):t.attributeData.color&&e.push([g.VertexAttribute.COLOR,new c.Attribute(t.attributeData.color,r,4,!0)]),t.attributeData.uvMapSpace&&e.push([g.VertexAttribute.UVMAPSPACE,new c.Attribute(t.attributeData.uvMapSpace,t.indices,4,!0)]),t.attributeData.boundingRect&&e.push([g.VertexAttribute.BOUNDINGRECT,new c.Attribute(t.attributeData.boundingRect,t.indices,9,!0)]),new l.Geometry(t.material,e,t.mapPositions,b.ContentObjectType.Mesh,t.attributeData.objectAndLayerIdColor)}function f(t,e=null){const r=[[g.VertexAttribute.POSITION,new c.Attribute(t.attributeData.position,t.indices,3,!0)],[g.VertexAttribute.UV0,new c.Attribute(t.attributeData.uv0,t.indices,2,!0)]];return new l.Geometry(t.material,r,t.mapPositions,b.ContentObjectType.Mesh,e)}function D(t){switch(t.type){case"extent":if(t instanceof A)return y.fromExtent(t);break;case"polygon":return t}return null}class w{constructor(t,e,r){this.renderData=t,this.layerUid=e,this.graphicUid=r,this.outGeometries=new Array}}t.PolygonCreationDataBase=w,t.createColorGeometry=x,t.createIndices3D=d,t.createWaterGeometry=f,t.fitPlane=p,t.geometryAsPolygon=D,t.leastSignificantAxis=h,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
