/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/tslib.es6","../../../../core/Accessor","../../../../core/accessorSupport/decorators/property","../../../../core/accessorSupport/ensureType","../../../../core/arrayUtils","../../../../core/has","../../../../core/accessorSupport/decorators/subclass","../graphics/ExtentSet","../../../support/Scheduler"],(function(e,t,s,n,r,o,i,d,a,c){"use strict";e.I3SAsyncElevationUpdater=class extends s{constructor(e,t,s){super({}),this._updateExtent=t,this._updateNode=s,this.running=!1,this._extentSet=new a.ExtentSet,this._nodeSet=new Set,this.addHandles(e.registerTask(c.TaskPriority.ELEVATION_ALIGNMENT,this))}normalizeCtorArgs(){return{}}addExtent(e){this._extentSet.add(e),this.running=!0}schedule(e){this._nodeSet.add(e),this.running=!0}remove(e){this._nodeSet.delete(e),this._updateRunning()}runTask(e){const t=this._extentSet;for(e.run((()=>t.merge(e)));!t.empty&&!e.done;){const s=this._updateExtent(t.pop());null!=s&&s.forAll((e=>this.schedule(e))),e.madeProgress()}if(e.done)return;const s=this._nodeSet;for(const n of s)if(s.delete(n),this._updateNode(n),e.madeProgress(),e.done)break;this._updateRunning()}_updateRunning(){this.running=this._nodeSet.size>0||this._extentSet.size>0}},t.__decorate([n.property()],e.I3SAsyncElevationUpdater.prototype,"running",void 0),e.I3SAsyncElevationUpdater=t.__decorate([d.subclass("esri.views.3d.layers.i3s.I3SAsyncElevationUpdater.ts")],e.I3SAsyncElevationUpdater),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
