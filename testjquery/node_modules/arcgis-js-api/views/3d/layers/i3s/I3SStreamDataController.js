/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../core/promiseUtils"],(function(e,t){"use strict";class r{constructor(e,t){this._requester=e,this._apiKey=t,this._activeRequests=new Set}get busy(){return this._requester.busy}request(e,r,o){const s=new AbortController,a=t.onAbortOrThrow(o,(()=>s.abort())),l={signal:s.signal,query:{token:this._apiKey}},n=this._requester.request(e,r,l),i={response:n,abortController:s,abortHandle:a};return this._activeRequests.add(i),t.always(n,(()=>{i.abortController=null,i.abortHandle?.remove(),i.abortHandle=null,this._activeRequests.delete(i)})),n}cancelAll(){this._activeRequests.forEach((e=>{e.abortController?.abort(),e.abortController=null,e.abortHandle?.remove()})),this._activeRequests.clear()}}e.I3SStreamDataController=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
