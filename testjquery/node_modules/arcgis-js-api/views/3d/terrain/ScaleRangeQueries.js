/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/tslib.es6","../../../core/Accessor","../../../core/ObjectPool","../../../core/PooledArray","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/ensureType","../../../core/arrayUtils","../../../core/has","../../../core/accessorSupport/decorators/subclass","../../../chunks/vec4","../../../chunks/vec4f64"],(function(e,t,s,r,i,u,n,a,c,o,l,h){"use strict";class _{constructor(){this.extent=h.create(),this.minLevel=0,this.maxLevel=0,this.callback=null}}e.ScaleRangeQueries=class extends s{constructor(){super(...arguments),this._queries=new i({initialSize:10}),this._queriesInvPtr=0,this._queryQueue=new i({initialSize:30}),this._queryPool=new r(_)}queryVisibleLevelRange(e,t,s,r){const i=this._queryPool.acquire();l.copy(i.extent,e),i.minLevel=t??-Number.MAX_VALUE,i.maxLevel=s??Number.MAX_VALUE,i.callback=r,this._queryQueue.push(i),this.notifyChange("updating")}get updating(){return 0!==this._queryQueue.length}prepare(){for(;this._queries.length<this._queries.data.length&&this._queryQueue.length>0;){const e=this._queryQueue.pop();this._queries.push(e)}this._queriesInvPtr=this._queries.length}process(){for(let e=0;e<this._queries.length;e++){const t=this._queries.data[e];this._queryPool.release(t),t.callback(e>=this._queriesInvPtr),t.callback=null}this._queries.clear(),this.notifyChange("updating")}queriesForTile(e){const t=e.level;let s=0;for(;s<this._queriesInvPtr;){const r=this._queries.data[s],i=r.extent;t>=r.minLevel&&t<=r.maxLevel&&i[0]<=e.extent[2]&&i[2]>=e.extent[0]&&i[1]<=e.extent[3]&&i[3]>=e.extent[1]?(this._queries.swapElements(s,this._queriesInvPtr-1),this._queriesInvPtr--):s++}}},t.__decorate([u.property()],e.ScaleRangeQueries.prototype,"updating",null),e.ScaleRangeQueries=t.__decorate([o.subclass("esri.views.3d.terrain.ScaleRangeQueries")],e.ScaleRangeQueries),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
