/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../core/Handles","../../../../core/reactiveUtils","../../state/controllers/GamepadKeyboardController","../../../input/InputHandler"],(function(a,e,t,r,i){"use strict";class n extends i.InputHandler{constructor(a){super(!0),this._view=a,this._watchHandles=new e,this._handle=this.registerIncoming("gamepad",(a=>this._handleEventGamepad(a))),this._handle.pause()}onInstall(a){super.onInstall(a),this._watchHandles.add([t.watch((()=>this._view.navigation.gamepad.enabled),(a=>{a?this._handle.resume():(this._handle.pause(),this._cameraControllerGamepad&&(this._cameraControllerGamepad.finishController(),this._cameraControllerGamepad=null))}),t.initial),t.watch((()=>this._view.navigation.gamepad.device),(a=>{this._cameraControllerGamepad&&a&&this._cameraControllerGamepad.gamepadDevice!==a&&(this._cameraControllerGamepad.finishController(),this._cameraControllerGamepad=null)}))])}onUninstall(){this._watchHandles.removeAll(),super.onUninstall()}_handleEventGamepad(a){const e=this._view.navigation.gamepad.device;if(e&&a.data.device!==e)return;const t=this._cameraControllerGamepad&&this._cameraControllerGamepad.active;if(t||r.GamepadKeyboardController.activatesFor(this._view,a.data)){if(!t){const e=new r.GamepadKeyboardController({view:this._view,gamepadDevice:a.data.device});this._view.state.switchCameraController(e)&&(this._cameraControllerGamepad=e)}this._cameraControllerGamepad&&this._cameraControllerGamepad.active&&this._cameraControllerGamepad.gamepadDevice===a.data.device&&this._cameraControllerGamepad.handleEventGamepad(a.data)}}}a.GamepadNavigation=n,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})}));
