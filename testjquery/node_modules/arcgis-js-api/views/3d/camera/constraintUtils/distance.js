/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/vec3","../../../../chunks/vec3f64","../../../../geometry/support/ray","../../../../chunks/sphere","./common","./InteractionType"],(function(t,n,e,r,i,o,c){"use strict";function a(t,n,e=o.defaultConstraintOptions){if(!t.state.isLocal)return 0;const r=t.state.constraints.distance;if(!t.pointsOfInterest.surfaceOrigin.renderLocation||r===1/0)return 0;p.min=0,p.max=r,u(t,e,p);const i=f(t,n),c=p.max-i;return c>=-1e-6?0:c}function s(t,e,c=o.defaultConstraintOptions){const s=a(t,e,c);if(0===s)return!1;const u=t.pointsOfInterest.surfaceOrigin;if(!u.renderLocation)return!1;const p=f(t,e)+s,C=n.copy(y,e.eye),I=o.interactionDirectionTowardsConstraintMinimization(e,c.interactionDirection,d(e,u.renderLocation,O),l);if(!i.intersectRay(i.fromCenterAndRadius(u.renderLocation,p),r.wrap(e.eye,I),g))return!1;e.eye=g;const L=n.subtract(m,e.eye,C);e.center=n.add(g,e.center,L);const T=t.renderCoordsHelper.getAltitude(e.center),x=t.renderCoordsHelper.intersectInfiniteManifold(e.ray,T,g);return null!=x&&(e.center=x),!0}function u(t,n,e){const r=n.interactionType;if(r===c.InteractionType.NONE)return;const{min:i,max:s}=e,{interactionStartCamera:u,interactionFactor:d}=n;if(!u)return;const p=r===c.InteractionType.ZOOM||r===c.InteractionType.PAN,y=a(t,u),m=0===y?0:f(t,u);e.min=i,e.max=s;const l=.05*m;o.adjustRangeForInteraction(y,m,p,d,l,e)}function f(t,e){const r=t.pointsOfInterest.surfaceOrigin;return r.renderLocation?n.distance(e.eye,r.renderLocation):0}function d(t,e,r){return n.direction(r,t.eye,e)}const p={min:0,max:0},y=e.create(),m=e.create(),l=e.create(),O=e.create(),g=e.create();t.applyDistanceConstraint=s,t.getDistanceConstraintError=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
