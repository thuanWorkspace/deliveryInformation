/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../Color","../../../../core/colorUtils","../../../../core/reactiveUtils","./sliceToolUtils","../../interactive/Manipulator3D","../../interactive/manipulatorUtils","../../interactive/RenderObject","../../webgl-engine/lib/Attribute","../../webgl-engine/lib/Geometry","../../webgl-engine/lib/GeometryUtil","../../webgl-engine/lib/Material","../../webgl-engine/lib/VertexAttribute","../../webgl-engine/materials/ImageMaterial","../../webgl-engine/materials/RibbonLineMaterial","../../../interactive/interfaces"],(function(e,t,r,i,a,n,l,o,c,s,u,d,b,g,p,M){"use strict";class m extends n.Manipulator3D{constructor(e,a){const n=new g.ImageMaterial({transparent:!0,writeDepth:!1,renderOccluded:d.RenderOccludedFlag.Opaque,isDecoration:!0}),o=l.rotateManipulatorDefaults.calloutWidth,c=new p.RibbonLineMaterial({width:o,renderOccluded:d.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});super({view:e,...w({imageMaterial:n,calloutMaterial:c})}),this._currentTexture=null,this._themeHandle=i.watch((()=>e.effectiveTheme.accentColor),(e=>{const i=r.multiplyOpacity(e,.5),l=r.getContrast(e),o=this._currentTexture,s=a(i,l);n.setParameters({textureId:s.texture.id}),c.setParameters({color:t.toUnitRGBA(e)}),this._currentTexture=s,o?.release()}),i.initial)}destroy(){this._themeHandle.remove(),this._currentTexture?.release(),super.destroy()}}function w({imageMaterial:e,calloutMaterial:t}){const{focusMultiplier:r,calloutLength:i,discRadius:n}=l.rotateManipulatorDefaults,d=n*r,g=(e,t)=>{const r=[0,1,2,2,3,0];return new s.Geometry(t,[[b.VertexAttribute.POSITION,new c.Attribute([i-e,-e,0,i+e,-e,0,i+e,e,0,i-e,e,0],r,3,!0)],[b.VertexAttribute.UV0,new c.Attribute([0,0,1,0,1,1,0,1],r,2,!0)]])},p=u.createPolylineGeometry(t,[[0,0,0],[i-n,0,0]]),m=u.createPolylineGeometry(t,[[0,0,0],[i-d,0,0]]),w=a.DidPointerMoveRecentlyFlag;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[i,0,0]},focusMultiplier:r,radius:n,renderObjects:[new o.RenderObject(g(n,e),M.ManipulatorStateFlags.Unfocused|w),new o.RenderObject(p,M.ManipulatorStateFlags.Unfocused|w),new o.RenderObject(g(d,e),M.ManipulatorStateFlags.Focused|w),new o.RenderObject(m,M.ManipulatorStateFlags.Focused|w)],state:w}}e.RotateManipulator=m,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
