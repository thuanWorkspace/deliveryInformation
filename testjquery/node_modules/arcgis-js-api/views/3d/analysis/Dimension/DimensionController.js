/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/tslib.es6","../../../../analysis/dimensionUtils","../../../../core/Accessor","../../../../core/handleUtils","../../../../core/Logger","../../../../core/reactiveUtils","../../../../core/unitUtils","../../../../core/accessorSupport/decorators/property","../../../../core/accessorSupport/ensureType","../../../../core/arrayUtils","../../../../core/has","../../../../core/accessorSupport/decorators/subclass","../../../../support/getDefaultUnitForView","./lengthDimensionUtils"],(function(e,t,o,i,n,s,r,a,l,c,p,d,u,m,y){"use strict";e.DimensionController=class extends i{constructor(e){super(e)}initialize(){const e=r.mapCollection((()=>this.analysisViewData.computations),(({computation:e})=>this._watchComputation(e)));this.addHandles(n.destroyHandle(e))}get analysis(){return this.analysisViewData.analysis}get _defaultUnit(){return m.getDefaultUnitForView(this.view)}_watchComputation(e){return r.watch((()=>y.computationToGeometryDependencies(e)),(t=>{const{measureType:i}=t;if(y.isGeodesicDimension(t)&&i!==o.LengthDimensionMeasureType.Direct){const t=Math.round(a.convertUnit(y.geodesicDistanceThreshold,"meters","kilometers"));return s.getLogger(this).warnOnce(`A ${i} dimension in the analysis (id: '${this.analysis.id}') will not display, because only direct dimensions can measure lengths greater than ${t} km. Update the measureType of the affected dimension to "direct" to display it.`),void(e.geometry=null)}const n=y.computeGeometryFromDimension(t,this.view.renderCoordsHelper,e.geometry);e.geometry=n,e.result.length=y.computeLength(n,i,this._defaultUnit)}),r.syncAndInitial)}},t.__decorate([l.property({constructOnly:!0})],e.DimensionController.prototype,"analysisViewData",void 0),t.__decorate([l.property({constructOnly:!0})],e.DimensionController.prototype,"view",void 0),t.__decorate([l.property()],e.DimensionController.prototype,"analysis",null),t.__decorate([l.property()],e.DimensionController.prototype,"_defaultUnit",null),e.DimensionController=t.__decorate([u.subclass("esri.views.3d.analysis.Dimension.support.DimensionController")],e.DimensionController),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
