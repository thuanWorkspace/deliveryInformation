/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../../geometry/support/buffer/BufferView","../../../../webgl/enums","../../../../webgl/Texture","../../../../webgl/TextureDescriptor"],(function(t,e,i,s,r){"use strict";class u{constructor(t,u=1){this._rctx=t,this._fieldCount=u,this.textureWidth=4096,this._dirty=!0;const d=new r.TextureDescriptor(this.textureWidth,1);d.samplingMode=i.TextureSamplingMode.NEAREST,d.wrapMode=i.TextureWrapMode.CLAMP_TO_EDGE,this._texture=new s.Texture(this._rctx,d),this._data=new e.BufferViewVec4u8(new ArrayBuffer(4*this.textureWidth))}dispose(){this._texture.dispose(),this._texture=void 0,this._data=void 0}setData(t,e,i,s,r,u){const d=t*this._fieldCount+e;this._dirty=!0,this._data.set(d,0,i),this._data.set(d,1,s),this._data.set(d,2,r),this._data.set(d,3,u)}setDataElement(t,e,i,s){const r=t*this._fieldCount+e;this._dirty=!0,this._data.set(r,i,s)}getDataElement(t,e,i){const s=t*this._fieldCount+e;return this._dirty=!0,this._data.get(s,i)}resizeToFit(t){const i=(t+1)*this._fieldCount;if(i>this._data.count){const t=Math.ceil(i/this.textureWidth)*this.textureWidth,s=new e.BufferViewVec4u8(new ArrayBuffer(4*t));s.typedBuffer.set(this._data.typedBuffer),this._data=s}}updateTexture(){if(!this._dirty)return;const t=this._texture.descriptor.width,e=this._texture.descriptor.height;this._data.count>t*e&&this._texture.resize(t,this._data.count/t),this._texture.setData(this._data.typedBuffer),this._dirty=!1}get texture(){return this._texture}}t.TextureBackedBuffer=u,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
