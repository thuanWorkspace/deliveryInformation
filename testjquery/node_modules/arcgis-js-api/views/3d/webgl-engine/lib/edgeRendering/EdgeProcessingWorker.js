/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../../../support/buffer/workerHelper","./bufferLayouts","./edgePreprocessing","./edgeProcessing"],(function(e,t,n,r){"use strict";class s{async extract(e){const t=a(e),n=r.extract(t),s=[t.data.buffer];return{result:i(n,s),transferList:s}}async extractComponentsEdgeLocations(t){const s=a(t),i=r.extractEdgeInformation(s.data,s.skipDeduplicate,s.indices,s.indicesLength),c=n.extractEdges(i,l,d),o=[];return{result:e.packInterleavedBuffer(c.regular.instancesData,o),transferList:o}}async extractEdgeLocations(t){const s=a(t),i=r.extractEdgeInformation(s.data,s.skipDeduplicate,s.indices,s.indicesLength),c=n.extractEdges(i,u,d),o=[];return{result:e.packInterleavedBuffer(c.regular.instancesData,o),transferList:o}}}function a(e){return{data:t.EdgeInputBufferLayout.createView(e.dataBuffer),indices:"Uint32Array"===e.indicesType?new Uint32Array(e.indices):"Uint16Array"===e.indicesType?new Uint16Array(e.indices):e.indices,indicesLength:e.indicesLength,writerSettings:e.writerSettings,skipDeduplicate:e.skipDeduplicate}}function i(t,n){n.push(t.regular.lodInfo.lengths.buffer),n.push(t.silhouette.lodInfo.lengths.buffer);return{regular:{instancesData:e.packInterleavedBuffer(t.regular.instancesData,n),lodInfo:{lengths:t.regular.lodInfo.lengths.buffer}},silhouette:{instancesData:e.packInterleavedBuffer(t.silhouette.instancesData,n),lodInfo:{lengths:t.silhouette.lodInfo.lengths.buffer}},averageEdgeLength:t.averageEdgeLength}}class c{allocate(e){return r.extractEdgeLocationsLayout.createBuffer(e)}trim(e,t){return e.slice(0,t)}write(e,t,n){e.position0.setVec(t,n.position0),e.position1.setVec(t,n.position1)}}class o{allocate(e){return r.extractComponentsEdgeLocationsLayout.createBuffer(e)}trim(e,t){return e.slice(0,t)}write(e,t,n){e.position0.setVec(t,n.position0),e.position1.setVec(t,n.position1),e.componentIndex.set(t,n.componentIndex)}}const u=new c,l=new o,d={allocate:()=>null,write:()=>{},trim:()=>null};return s}));
