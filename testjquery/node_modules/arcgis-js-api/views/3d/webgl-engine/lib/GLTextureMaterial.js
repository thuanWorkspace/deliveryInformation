/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../core/maybe","../../../../core/promiseUtils","../core/shaderModules/interfaces","./basicInterfaces","./GLMaterial"],(function(e,t,s,i,r,u){"use strict";class l extends u{constructor(e){super(e),this._numLoading=0,this._disposed=!1,this._textureRepository=e.textureRepository,this._textureId=e.textureId,this._acquire(e.textureId,(e=>this._texture=e)),this._acquire(e.normalTextureId,(e=>this._textureNormal=e)),this._acquire(e.emissiveTextureId,(e=>this._textureEmissive=e)),this._acquire(e.occlusionTextureId,(e=>this._textureOcclusion=e)),this._acquire(e.metallicRoughnessTextureId,(e=>this._textureMetallicRoughness=e))}dispose(){this._texture=t.releaseMaybe(this._texture),this._textureNormal=t.releaseMaybe(this._textureNormal),this._textureEmissive=t.releaseMaybe(this._textureEmissive),this._textureOcclusion=t.releaseMaybe(this._textureOcclusion),this._textureMetallicRoughness=t.releaseMaybe(this._textureMetallicRoughness),this._disposed=!0}ensureResources(e){return 0===this._numLoading?r.ResourceState.LOADED:r.ResourceState.LOADING}get textureBindParameters(){return new a(null!=this._texture?this._texture.glTexture:null,null!=this._textureNormal?this._textureNormal.glTexture:null,null!=this._textureEmissive?this._textureEmissive.glTexture:null,null!=this._textureOcclusion?this._textureOcclusion.glTexture:null,null!=this._textureMetallicRoughness?this._textureMetallicRoughness.glTexture:null)}updateTexture(e){null!=this._texture&&e===this._texture.id||(this._texture=t.releaseMaybe(this._texture),this._textureId=e,this._acquire(this._textureId,(e=>this._texture=e)))}_acquire(e,i){if(null==e)return void i(null);const r=this._textureRepository.acquire(e);if(s.isPromiseLike(r))return++this._numLoading,void r.then((e=>{if(this._disposed)return t.releaseMaybe(e),void i(null);i(e)})).finally((()=>--this._numLoading));i(r)}}class a extends i.NoParameters{constructor(e=null,t=null,s=null,i=null,r=null){super(),this.texture=e,this.textureNormal=t,this.textureEmissive=s,this.textureOcclusion=i,this.textureMetallicRoughness=r}}e.GLTextureMaterial=l,e.GLTextureMaterialBindParameters=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
