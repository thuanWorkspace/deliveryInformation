/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../../core/arrayUtils","../../../../../core/promiseUtils","../../../../../chunks/vec3f64","../../../../../geometry/support/aaBoundingBox","./LodComponentData"],(function(e,n,t,o,i,r){"use strict";class s{static async create(e,o,i){const c=await Promise.allSettled(o.components.map((n=>e.controller.schedule((()=>new r.LodComponentData(e,n)),i)))),u=c.map((e=>"fulfilled"===e.status?e.value:null)).filter(n.isSome);if(t.isAborted(i)||u.length!==c.length){u.forEach((e=>e.destroy())),t.throwIfAborted(i);for(const e of c)if("rejected"===e.status)throw e.reason}return new s(o.minScreenSpaceRadius,u)}constructor(e,n){this.minScreenSpaceRadius=e,this.components=n}destroy(){this.components.forEach((e=>e.destroy()))}intersect(e,n,t,o,i,r,s){this.components.forEach((c=>c.intersect(e,n,t,o,i,r,this.boundingSphere,s)))}get boundingBox(){if(null==this._boundingBox){const e=i.empty();this.components.forEach((n=>{null!=n.boundingInfo&&(i.expandWithVec3(e,n.boundingInfo.bbMin),i.expandWithVec3(e,n.boundingInfo.bbMax))})),this._boundingBox=e}return this._boundingBox}get boundingSphere(){if(null==this._boundingSphere){const e=this.boundingBox,n=o.create();i.center(e,n),this._boundingSphere={center:n,radius:.5*i.diameter(e)}}return this._boundingSphere}get triangleCount(){return this.components.reduce(((e,n)=>e+n.triangleCount),0)}}e.LodLevel=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
