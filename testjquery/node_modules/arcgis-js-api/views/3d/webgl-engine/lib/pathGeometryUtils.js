/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/vec2","../../../../chunks/vec3","../../../../chunks/vec3f64","../../../../geometry/support/plane","../../../../geometry/support/ray","./GeometryUtil"],(function(e,t,r,o,a,c,i){"use strict";function n(e,t,r){e[0]=r[0]*t.right[0]+r[1]*t.up[0],e[1]=r[0]*t.right[1]+r[1]*t.up[1],e[2]=r[0]*t.right[2]+r[1]*t.up[2]}function p(e,o,a){t.set(e,r.dot(a,o.right),r.dot(a,o.up))}function s(e,t){let n=null;const p=e.vertices.length,s=.99619469809,f=o.create(),l=o.create(),m=o.create(),h=o.create(),g=o.create(),v=o.create(),y=a.create();let d=e.vertices[0];r.copy(l,t),r.set(f,0,1,0),i.makeOrthoBasisDirUpFallback(d.vRight,l,f,f,m,l,s),r.copy(d.frame.up,l),r.copy(d.frame.right,m);const k=e.positions;let R=e.offset;n=d;for(let o=1;o<p;++o){d=e.vertices[o],r.add(g,d.vLeft,d.vRight);let t=r.length(g);t>0?(t=1/Math.sqrt(t),g[0]=g[0]*t,g[1]=g[1]*t,g[2]=g[2]*t):(g[0]=d.vRight[0],g[1]=d.vRight[1],g[2]=d.vRight[2]),v[0]=k[R]+n.frame.up[0],v[1]=k[R+1]+n.frame.up[1],v[2]=k[R+2]+n.frame.up[2],R+=3;const p=r.set(u,k[R],k[R+1],k[R+2]);a.fromPositionAndNormal(p,g,y);a.intersectRay(y,c.wrap(v,d.vLeft),h)?(h[0]-=k[R],h[1]-=k[R+1],h[2]-=k[R+2],r.normalize(l,h),r.cross(m,g,l),r.normalize(m,m)):i.makeOrthoBasisDirUpFallback(g,n.frame.up,n.frame.right,f,m,l,s),r.copy(d.frame.up,l),r.copy(d.frame.right,m),n=d}}const u=o.create();e.computeMinimumRotationTangentFrame=s,e.profileSpaceToVertexSpace=n,e.vertexSpaceToProfileSpace=p,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
