/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../../chunks/tslib.es6","../../../../../core/accessorSupport/decorators/property","../../../../../core/accessorSupport/ensureType","../../../../../core/arrayUtils","../../../../../core/has","../../../../../core/accessorSupport/decorators/subclass","../RenderPlugin","../../lib/RenderSlot","../../../../../chunks/Compositing.glsl","../../shaders/CompositingTechnique","../../shaders/CompositingTechniqueConfiguration"],(function(e,t,o,i,r,s,n,c,a,l,p,u){"use strict";e.Blit=class extends c.SyncRenderPlugin{constructor(e){super(e),this._context=null,this.opacity=1,this.alphaMode=u.AlphaMode.None,this._blitConfiguration=new u.CompositingTechniqueConfiguration,this._blitParameters=new l.CompositingPassParameters,this.produces=new Map([[a.RenderSlot.BLIT,()=>null!=this._context]])}consumes(){return c.ConsumesCompositeColor}initializeRenderContext(e){this._context=e}uninitializeRenderContext(){this._context=null}destroy(){}renderNode(e,t,o,i){const r=o?.composite?.colorTexture;if(!this._context||!r)return i;const s=this._context.techniqueRepository.acquire(p.CompositingTechnique,this._blitConfiguration);return s?.compiled?(e.rctx.bindFramebuffer(i?.fbo),this._blitParameters.texture=r,this._blitParameters.opacity=this.opacity,e.rctx.bindTechnique(s,this._blitParameters,e.bindParameters),e.rctx.screen.draw(),s.release(),i):(this._context.requestRender(),i)}},t.__decorate([o.property()],e.Blit.prototype,"_context",void 0),t.__decorate([o.property()],e.Blit.prototype,"opacity",void 0),t.__decorate([o.property()],e.Blit.prototype,"alphaMode",void 0),e.Blit=t.__decorate([n.subclass("esri.views.3d.webgl-engine.effects.blit.Blit")],e.Blit),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
