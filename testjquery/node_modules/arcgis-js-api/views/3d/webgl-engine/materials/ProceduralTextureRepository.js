/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../core/uid"],(function(e,t){"use strict";class r{constructor(e,r,s){this._createTexture=e,this._parametersKey=r,this._repository=new Map,this._orphanCache=s.newCache(`procedural-texture-repository:${t.generateUID()}`,(e=>e.dispose()))}destroy(){for(const[e,{texture:t}]of this._repository)t.dispose();this._repository.clear(),this._orphanCache.destroy()}swap(e,t=null){const r=this._acquire(e);return this.release(t),r}release(e){if(null==e)return;const t=this._parametersKey(e),r=this._repository.get(t);if(r&&(r.refCount--,0===r.refCount)){this._repository.delete(t);const{texture:e}=r,s=e.gpuMemoryUsage;this._orphanCache.put(t,e,s)}}_acquire(e){if(null==e)return null;const t=this._parametersKey(e),r=this._repository.get(t);if(r)return r.refCount++,r.texture;const o=this._orphanCache.pop(t)??this._createTexture(e),i=new s(o);return this._repository.set(t,i),o}}class s{constructor(e){this.texture=e,this.refCount=1}}e.ProceduralTextureRepository=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
