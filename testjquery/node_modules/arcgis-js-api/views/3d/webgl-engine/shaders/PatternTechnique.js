/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["require","exports","../../../../chunks/tslib.es6","../core/shaderLibrary/ShaderOutput","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../core/shaderTechnique/ShaderTechniqueConfiguration","../lib/basicInterfaces","../lib/OrderIndependentTransparency","../lib/Program","../lib/StencilUtils","../lib/TransparencyPassType","../lib/VertexAttribute","../materials/DefaultTechniqueConfiguration","../materials/PatternStyle","../../../../chunks/Pattern.glsl","../../../webgl/renderState"],(function(e,t,r,a,o,i,n,s,p,l,c,u,d,h,y,_,P){"use strict";class T extends i.ShaderTechnique{initializeProgram(e){return new l.Program(e.rctx,T.shader.get().build(this.configuration),m)}_setPipelineState(e,t){const r=this.configuration,o=e===u.TransparencyPassType.NONE,i=e===u.TransparencyPassType.FrontFace;return P.makePipelineState({blending:r.output===a.ShaderOutput.Color||r.output===a.ShaderOutput.Alpha?o?p.blendingDefault:p.oitBlending(e):null,culling:P.cullingParams(r.cullFace),depthTest:{func:p.oitDepthTest(e)},depthWrite:o?r.writeDepth?P.defaultDepthWriteParams:null:p.oitDepthWrite(e),colorWrite:P.defaultColorWriteParams,stencilWrite:r.hasOccludees?c.stencilWriteMaskOn:null,stencilTest:r.hasOccludees?t?c.stencilToolMaskBaseParams:c.stencilBaseAllZerosParams:null,polygonOffset:o||i?r.polygonOffset?O:null:p.getOITPolygonOffset(r.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipeline(e){return e?this._occludeePipelineState:super.getPipeline()}}T.shader=new o.ReloadableShaderModule(_.Pattern,(()=>new Promise(((t,r)=>e(["./Pattern.glsl"],t,r)))));const O={factor:1,units:1};class f extends h.DefaultTechniqueConfiguration{constructor(){super(...arguments),this.output=a.ShaderOutput.Color,this.cullFace=s.CullFaceOptions.None,this.transparencyPassType=u.TransparencyPassType.NONE,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.writeDepth=!0,this.hasOccludees=!1,this.enableOffset=!0,this.multipassEnabled=!1,this.cullAboveGround=!1,this.vvColor=!1}}r.__decorate([n.parameter({count:a.ShaderOutput.COUNT})],f.prototype,"output",void 0),r.__decorate([n.parameter({count:s.CullFaceOptions.COUNT})],f.prototype,"cullFace",void 0),r.__decorate([n.parameter({count:y.Style.COUNT})],f.prototype,"style",void 0),r.__decorate([n.parameter({count:u.TransparencyPassType.COUNT})],f.prototype,"transparencyPassType",void 0),r.__decorate([n.parameter()],f.prototype,"hasSlicePlane",void 0),r.__decorate([n.parameter()],f.prototype,"hasVertexColors",void 0),r.__decorate([n.parameter()],f.prototype,"polygonOffset",void 0),r.__decorate([n.parameter()],f.prototype,"writeDepth",void 0),r.__decorate([n.parameter()],f.prototype,"hasOccludees",void 0),r.__decorate([n.parameter()],f.prototype,"patternSpacing",void 0),r.__decorate([n.parameter()],f.prototype,"lineWidth",void 0),r.__decorate([n.parameter()],f.prototype,"enableOffset",void 0),r.__decorate([n.parameter()],f.prototype,"draped",void 0),r.__decorate([n.parameter()],f.prototype,"multipassEnabled",void 0),r.__decorate([n.parameter()],f.prototype,"cullAboveGround",void 0),r.__decorate([n.parameter()],f.prototype,"vvColor",void 0),r.__decorate([n.parameter({constValue:!1})],f.prototype,"occlusionPass",void 0),r.__decorate([n.parameter({constValue:!1})],f.prototype,"hasVvInstancing",void 0),r.__decorate([n.parameter({constValue:!1})],f.prototype,"vvSize",void 0),r.__decorate([n.parameter({constValue:!1})],f.prototype,"vvOpacity",void 0);const m=new Map([[d.VertexAttribute.POSITION,0],[d.VertexAttribute.COLOR,3],[d.VertexAttribute.UVMAPSPACE,4],[d.VertexAttribute.COLORFEATUREATTRIBUTE,5],[d.VertexAttribute.BOUNDINGRECT,6]]);t.PatternTechnique=T,t.PatternTechniqueConfiguration=f,t.vertexAttributeLocations=m,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
