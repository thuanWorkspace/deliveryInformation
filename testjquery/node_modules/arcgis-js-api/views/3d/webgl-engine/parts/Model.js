/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../chunks/tslib.es6","../../../../core/Accessor","../../../../core/accessorSupport/decorators/property","../../../../core/accessorSupport/ensureType","../../../../core/arrayUtils","../../../../core/has","../../../../core/accessorSupport/decorators/subclass","../../../../chunks/mat4f64","../lib/ContentObjectType","../lib/GridLocalOriginFactory","../lib/ModelDirtySet","../lib/RenderGeometry","../lib/Util","../lib/WebGLLayer"],(function(t,e,o,r,n,s,i,a,c,d,l,y,h,u,b){"use strict";t.Model=class extends o{constructor(){super(...arguments),this.dirtySet=new y({model:this}),this._content=new Map,this._originFactory=new l.GridLocalOriginFactory(null)}getObject(t){return this._content.get(t)}add(t){const e=t.id;u.assert(!this._content.has(e),"Model/Stage already contains object to be added"),this._content.set(e,t),b.isWebGLLayer(t)&&this.dirtySet.layerAdded(t)}remove(t){return!!this._content.has(t.id)&&(this._content.delete(t.id),b.isWebGLLayer(t)&&this.dirtySet.layerRemoved(t),!0)}addMany(t){for(const e of t)e&&(u.assert(!this._content.has(e.id),"Model/Stage already contains object to be added"),this._content.set(e.id,e))}removeMany(t){for(const e of t)e&&(u.assert(this._content.has(e.id),"Model/Stage doesn't contain object to be removed"),this._content.delete(e.id))}has(t){return this._content.has(t.id)}forEachOfType(t,e){this._content.forEach((o=>{o.type===t&&e(o)}))}getRenderGeometry(t,e){const o=new h.RenderGeometry(e,{castShadow:t.castShadow,objectShaderTransformation:t.shaderTransformation});o.transformation=t.getCombinedStaticTransformation(e,g);const{localOrigin:r}=e;return o.localOrigin=null!=r?r:this._originFactory.getOrigin(o.boundingSphere),o}updateRenderGeometryTransformation(t,e,o){if(null==t)return!1;o.transformation=t.getCombinedStaticTransformation(e,g);const r=this._originFactory.getOrigin(o.boundingSphere);return o.localOrigin!==r}getStats(){const t={},e=Array.from(this._content.values());for(let o=0;o<d.ContentObjectType.COUNT;++o)t[o]=e.filter((t=>t.type===o)).length;return{contentTypes:t,dirtySet:this.dirtySet.formatDebugInfo()}}get test(){return{content:Array.from(this._content.values())}}},e.__decorate([r.property({constructOnly:!0})],t.Model.prototype,"dirtySet",void 0),t.Model=e.__decorate([a.subclass("esri.views.3d.webgl-engine.parts.Model")],t.Model);const g=c.create();Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
