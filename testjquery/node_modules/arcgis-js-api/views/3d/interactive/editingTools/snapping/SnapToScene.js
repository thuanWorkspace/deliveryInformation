/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../../../support/elevationInfoUtils","../../../../interactive/dragEventPipeline"],(function(t,e,n){"use strict";class a{constructor(){this._view=null,this._elevationInfo=null,this._lastDragEvent=null,this._next=null,this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&null!=this._lastDragEvent&&null!=this._next){const e=this._lastDragEvent.mapEnd,n=this._snap(this._lastDragEvent.screenEnd);if(null!=n){const a={action:"update",mapStart:this._lastDragEvent.mapStart,mapEnd:!0===t?n:e,screenStart:this._lastDragEvent.screenEnd,screenEnd:this._lastDragEvent.screenEnd};this._next.execute(a)}}this._enabled=t}_snap(t){const n=null!=this._view?this._view.toMap(t,{exclude:[]}):null;return null!=n&&null!=this._view&&(n.z=e.getZForElevationMode(n,this._view,this._elevationInfo)),n}createDragEventPipelineStep(t,e){this._view=t,this._elevationInfo=e,this._lastDragEvent=null;const a=new n.EventPipeline;this._next=a;return[t=>{if(this._lastDragEvent="end"!==t.action?{...t}:null,this._enabled){const e=this._snap(t.screenEnd);return null!=e?{action:t.action,mapStart:t.mapStart,mapEnd:e,screenStart:t.screenStart,screenEnd:t.screenEnd}:null}return{action:t.action,mapStart:t.mapStart,mapEnd:t.mapEnd,screenStart:t.screenStart,screenEnd:t.screenEnd}},a]}}t.SnapToScene=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
