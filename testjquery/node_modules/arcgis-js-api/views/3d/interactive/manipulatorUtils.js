/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../core/colorUtils","../../../chunks/mat4","../../../chunks/vec3","../../../geometry/support/vectorStacks","../../../layers/graphics/hydratedFeatures","./Manipulator3D","./RenderObject","../layers/graphics/graphicUtils","../webgl-engine/lib/basicInterfaces","../webgl-engine/lib/GeometryUtil","../webgl-engine/lib/Material","../webgl-engine/materials/ColorMaterial","../webgl-engine/materials/ShadedColorMaterial","../../interactive/interfaces"],(function(e,t,r,n,a,o,c,l,i,s,u,d,p,g,h){"use strict";function m(e,r=d.RenderOccludedFlag.OccludeAndTransparent,n=!0){const a=t.colorVectorToColorAndOpacity(e),o=!(e[3]<1);return n?new g.ShadedColorMaterial({color:a,writeDepth:o,cullFace:s.CullFaceOptions.Back,renderOccluded:r,isDecoration:!0}):new p.ColorMaterial({color:a,writeDepth:o,cullFace:s.CullFaceOptions.Back,renderOccluded:r,isDecoration:!0})}function O(e,r=d.RenderOccludedFlag.OccludeAndTransparent){const n=t.colorVectorToColorAndOpacity(e);return new p.ColorMaterial({color:n,writeDepth:!0,cullFace:s.CullFaceOptions.Front,renderOccluded:r,isDecoration:!0})}const f=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1});function M(e,t,r=h.ManipulatorStateCustomFlags.None){const n=m(t),a=[new l.RenderObject(u.createSphereGeometry(n,1,32,32),r)];return new c.Manipulator3D({view:e,renderObjects:a})}const b=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function w(e,t,o,c){const l=n.subtract(a.sv3d.get(),e,o),i=y(l,n.cross(a.sv3d.get(),c,l),o,a.sm4d.get());r.invert(i,i);const s=n.transformMat4(a.sv3d.get(),t,i);return Math.atan2(s[1],s[0])}function y(e,t,r,o){const c=n.normalize(a.sv3d.get(),e),l=n.normalize(a.sv3d.get(),t),i=n.cross(a.sv3d.get(),c,l);return o[0]=c[0],o[1]=c[1],o[2]=c[2],o[3]=0,o[4]=l[0],o[5]=l[1],o[6]=l[2],o[7]=0,o[8]=i[0],o[9]=i[1],o[10]=i[2],o[11]=0,o[12]=r[0],o[13]=r[1],o[14]=r[2],o[15]=1,o}function v(e,t){const r=e.getViewForGraphic(t);return null!=r&&"computeAttachmentOrigin"in r?r.computeAttachmentOrigin(t,e.spatialReference):null}function F(e,t,r){const n=v(e,r);null==n?C(t,r.geometry):t.elevationAlignedLocation=n}function C(e,t){if(null==t)return;const r="mesh"===t.type?t.anchor:i.computeCentroid(t);null!=r&&(e.location=o.hydrateGeometry(r))}e.calculateInputRotationTransform=w,e.calculateTranslateRotateFromBases=y,e.createManipulatorMaterial=m,e.createManipulatorOutlineMaterial=O,e.createSphereManipulator=M,e.getGraphicAttachmentOrigin=v,e.placeAtGraphic=F,e.rotateManipulatorDefaults=f,e.worldScaledManipulatorSettings=b,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
