/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../core/maybe","../../../chunks/mat4","../../../chunks/mat4f64","./AtmosphereType","../../../chunks/SimpleAtmosphere.glsl","./SimpleAtmosphereTechnique","./SimpleAtmosphereTechniqueConfiguration","./resources/SimpleAtmosphereTexture","../support/buffer/glUtil","../support/buffer/InterleavedLayout","../webgl-engine/lib/DefaultVertexAttributeLocations","../webgl-engine/lib/GeometryUtil","../webgl-engine/lib/VertexArrayObject","../webgl-engine/lib/VertexAttribute","../../webgl/BufferObject","../../webgl/enums","../../webgl/Texture","../../webgl/TextureDescriptor","../../webgl/Util"],(function(e,t,r,i,s,o,a,n,u,c,h,p,l,m,b,g,f,y,x,A){"use strict";class _{constructor(e,t){this.type=s.AtmosphereType.Local,this._configuration=new n.SimpleAtmosphereTechniqueConfiguration,this._passParameters=new o.SimpleAtmospherePassParameters,this._configuration.geometry=n.SimpleAtmosphereGeometry.Cylinder,this._technique=t.techniqueRepository.acquire(a.SimpleAtmosphereTechnique,this._configuration);const r=t.renderContext.rctx;this._vao=this._createVertexArrayObject(r),this._vaoCount=A.vertexCount(this._vao,"geometry");const i=new x.TextureDescriptor;i.wrapMode=f.TextureWrapMode.CLAMP_TO_EDGE,i.flipped=!0,i.width=1,i.height=512,this._passParameters.texture=new y.Texture(r,i,u.earthAtmosphereTextureSimple)}destroy(){this._passParameters.texture=t.disposeMaybe(this._passParameters.texture),this._vao.dispose(),this._technique.release()}render(e){const t=e.rctx,r=t.bindTechnique(this._technique,this._passParameters,e.bindParameters);d(T,e.bindParameters.camera.viewMatrix),r.setUniformMatrix4fv("view",T),t.bindVAO(this._vao),r.assertCompatibleVertexAttributeLocations(this._vao),t.drawArrays(f.PrimitiveType.TRIANGLES,0,this._vaoCount)}renderHaze(){return!1}_createVertexArrayObject(e){const t=l.createPolySphereData(1,2,!1),{data:r,indices:i}=t[0][1],s=w.createBuffer(i.length),o=s.position;for(let a=0;a<i.length;++a){const e=3*i[a%3==0?a+2:a%3==2?a-2:a];o.set(a,0,r[e]),o.set(a,1,r[e+1]),o.set(a,2,r[e+2])}return new m.VertexArrayObject(e,p.Default3D,{geometry:c.glLayout(w)},{geometry:g.BufferObject.createVertex(e,f.Usage.STATIC_DRAW,s.buffer)})}}function d(e,t){r.copy(e,t),e[12]=0,e[13]=0,e[14]=0,e[15]=1}const T=i.create(),w=h.newLayout().vec3f(b.VertexAttribute.POSITION);e.LocalAtmosphere=_,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
