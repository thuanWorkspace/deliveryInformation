/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../../../chunks/tslib.es6","../../../core/compilerUtils","../../../core/handleUtils","../../../core/lang","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/decorators/cast","../../../core/accessorSupport/decorators/subclass","../../../core/accessorSupport/ensureType","./lightingUtils","./SceneViewAtmosphere","./SunLighting","./VirtualLighting","../../../webscene/Environment","../../../webscene/SunLighting","../../../webscene/VirtualLighting"],(function(e,t,i,n,s,r,g,h,o,c,l,a,p,u,d){"use strict";var b;let m=b=class extends p{constructor(e){super(e),this.atmosphere=new c.SceneViewAtmosphere,this.lighting=this.castLighting(),this.cachedCameraTrackingEnabled=null}static fromWebsceneEnvironment(e){const t=e.cloneConstructProperties();return new b({...t,lighting:t.lighting?"virtual"===t.lighting.type?a.fromWebsceneLighting(t.lighting):l.fromWebsceneLighting(t.lighting):void 0})}castLighting(e){return this._convertLightingWithDestroy(e)}applyLighting(e){this.lighting=this._convertLightingWithDestroy(e)}_convertLightingWithDestroy(e){const t=this._convertLighting(e);return t!==e&&this.addHandles(i.destroyHandle(t)),t}_convertLighting(e){return e?e instanceof l||e instanceof a?e:e instanceof u?this.lighting&&"virtual"!==this.lighting.type?this.lighting.cloneWithWebsceneLighting(e):new l({...e.cloneConstructProperties(),...this.lighting?.cloneNonPersistentConstructProperties()}):e instanceof d?this.lighting&&"virtual"===this.lighting.type?this.lighting.cloneWithWebsceneLighting(e):new a({...e.cloneConstructProperties(),...this.lighting?.cloneNonPersistentConstructProperties()}):h.ensureOneOfType(o.lightingTypes,e):new l}clone(){return new b({lighting:this.lighting.clone(),atmosphere:this.atmosphere.clone(),weather:this.weather.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:n.clone(this.background)})}cloneWithWebsceneEnvironment(e){return new b({atmosphere:this.atmosphere.clone(),weather:this.weather.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:n.clone(this.background),...e.cloneConstructProperties(),lighting:this._getLighting(e)})}_getLighting(e){switch(e.lighting.type){case"sun":return this.lighting&&"sun"===this.lighting.type?this.lighting.cloneWithWebsceneLighting(e.lighting):l.fromWebsceneLighting(e.lighting);case"virtual":return this.lighting&&"virtual"===this.lighting.type?this.lighting.cloneWithWebsceneLighting(e.lighting):a.fromWebsceneLighting(e.lighting);default:return t.neverReached(e.lighting),l.fromWebsceneLighting(e.lighting)}}};e.__decorate([s.property({type:c.SceneViewAtmosphere,json:{read:!1},nonNullable:!0})],m.prototype,"atmosphere",void 0),e.__decorate([s.property({nonNullable:!0})],m.prototype,"lighting",void 0),e.__decorate([r.cast("lighting")],m.prototype,"castLighting",null),m=b=e.__decorate([g.subclass("esri.views.3d.environment.SceneViewEnvironment")],m);return m}));
