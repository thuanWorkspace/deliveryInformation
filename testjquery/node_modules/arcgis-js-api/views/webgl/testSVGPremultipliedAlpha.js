/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../2d/engine/webgl/DefaultVertexAttributeLayouts","./BufferObject","./enums","./FramebufferObject","./Texture","./TextureDescriptor","./VertexArrayObject","./WebGLDriverTestModule"],(function(e,r,t,i,n,o,s,a,u){"use strict";class p extends u.WebGLDriverTestModule{constructor(e){super(),this._rctx=e;const r="\n    precision highp float;\n\n    attribute vec2 a_pos;\n    varying vec2 v_uv;\n\n    void main() {\n      v_uv = a_pos;\n      gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ",t="\n    precision highp float;\n\n    varying vec2 v_uv;\n\n    uniform sampler2D u_texture;\n\n    void main() {\n      gl_FragColor = texture2D(u_texture, v_uv);\n    }\n    ";this._program=e.programCache.acquire(r,t,new Map([["a_pos",0]]))}dispose(){super.dispose()}_test(e){const u=this._rctx;if(!u.gl)return e.dispose(),!0;const p=new s.TextureDescriptor(1);p.wrapMode=i.TextureWrapMode.CLAMP_TO_EDGE,p.samplingMode=i.TextureSamplingMode.NEAREST;const d=new n.FramebufferObject(u,p),l=t.BufferObject.createVertex(u,i.Usage.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),g=new a.VertexArrayObject(u,new Map([["a_pos",0]]),r.Pos2us,{geometry:l}),x=new s.TextureDescriptor;x.samplingMode=i.TextureSamplingMode.LINEAR,x.wrapMode=i.TextureWrapMode.CLAMP_TO_EDGE;const f=new o.Texture(u,x,c);u.useProgram(e),u.bindTexture(f,0),e.setUniform1i("u_texture",0);const m=u.getBoundFramebufferObject(),{x:v,y:_,width:w,height:T}=u.getViewport();u.bindFramebuffer(d),u.setViewport(0,0,1,1),u.setClearColor(0,0,0,0),u.setBlendingEnabled(!1),u.clearSafe(i.ClearBufferBit.COLOR_BUFFER_BIT),u.bindVAO(g),u.drawArrays(i.PrimitiveType.TRIANGLE_STRIP,0,4);const b=new Uint8Array(4);return d.readPixels(0,0,1,1,i.PixelFormat.RGBA,i.PixelType.UNSIGNED_BYTE,b),g.dispose(),d.dispose(),f.dispose(),u.setViewport(v,_,w,T),u.bindFramebuffer(m),255!==b[0]}}const c=new Image;c.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",c.width=5,c.height=5,c.decode(),e.SVGPremultipliedAlpha=p,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
