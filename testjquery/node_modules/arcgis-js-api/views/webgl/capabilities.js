/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","./contextUtils"],(function(t,e){"use strict";let r,n;function o(t){const r=e.getContextTypes(t);for(;r.length>1;){const t=s(r.shift());if(t.available)return t}return s(r.shift())}function s(t){switch(t){case e.ContextType.WEBGL1:return l();case e.ContextType.WEBGL2:return a()}}function l(){return r||(r=c()),r}function a(){return n||(n=x()),n}class u{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsElementIndexUint=!1,this.supportsStandardDerivatives=!1,this.supportsInstancedArrays=!1,this.supportsTextureFloat=!1,this.supportsTextureHalfFloat=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1}}class i extends u{constructor(){super(...arguments),this.type=e.ContextType.WEBGL1}}class p extends u{constructor(){super(...arguments),this.type=e.ContextType.WEBGL2,this.supportsElementIndexUint=!0,this.supportsStandardDerivatives=!0,this.supportsInstancedArrays=!0,this.supportsTextureFloat=!0,this.supportsTextureHalfFloat=!0}}function f(t,r){if(t===e.ContextType.WEBGL1&&"undefined"==typeof WebGLRenderingContext||t===e.ContextType.WEBGL2&&"undefined"==typeof WebGL2RenderingContext)return null;const n=document.createElement("canvas");if(!n)return null;let o=e.createContext(n,t,{failIfMajorPerformanceCaveat:!0});if(null==o&&(o=e.createContext(n,t),null!=o&&(r.majorPerformanceCaveat=!0)),null==o)return o;if(t===e.ContextType.WEBGL1){const t=o.getParameter(o.VERSION),e=t?.match(/^WebGL\s+([\d.]*)/);if(e){const t=parseFloat(e[1]);r.available=t>=.94}}else r.available=!0;r.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),r.supportsVertexShaderSamplers=o.getParameter(o.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const s=o.getShaderPrecisionFormat(o.FRAGMENT_SHADER,o.HIGH_FLOAT);return s&&(r.supportsHighPrecisionFragment=s.precision>0),o}function c(){const t=new i,r=f(e.ContextType.WEBGL1,t);return null==r||(t.supportsElementIndexUint=null!==r.getExtension("OES_element_index_uint"),t.supportsStandardDerivatives=null!==r.getExtension("OES_standard_derivatives"),t.supportsInstancedArrays=null!==r.getExtension("ANGLE_instanced_arrays"),t.supportsTextureFloat=null!==r.getExtension("OES_texture_float"),t.supportsTextureHalfFloat=null!==r.getExtension("OES_texture_half_float"),t.supportsColorBufferFloat=null!==r.getExtension("WEBGL_color_buffer_float"),t.supportsColorBufferFloatBlend=null!==r.getExtension("EXT_float_blend"),t.supportsColorBufferHalfFloat=null!==r.getExtension("EXT_color_buffer_half_float")),t}function x(){const t=new p,r=f(e.ContextType.WEBGL2,t);return null==r||(t.supportsColorBufferFloat=null!==r.getExtension("EXT_color_buffer_float"),t.supportsColorBufferFloatBlend=null!==r.getExtension("EXT_float_blend"),t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||null!==r.getExtension("EXT_color_buffer_half_float")),t}t.getWebGL1Capabilities=l,t.getWebGL2Capabilities=a,t.getWebGLCapabilities=o,t.getWebGLVersionCapabilities=s,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
