/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/tslib.es6","../../../core/Accessor","../../../core/maybe","../../../core/reactiveUtils","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/ensureType","../../../core/arrayUtils","../../../core/has","../../../core/accessorSupport/decorators/subclass","../../../support/themeUtils","./css","./content/tooltipContentFactory","../../../widgets/support/widgetUtils"],(function(t,e,o,n,i,s,r,c,a,l,p,d,u,y){"use strict";const h={base:`${d.base}`};function _({container:t,contentWidget:e,screenPoint:o,positionMode:n}){const{style:i}=t;if("docked"===n)return i.display="block",void(i.transform="none");if("fixed"!==n)if(null!=o&&null!=e){i.display="block";const e=y.isRTL(t),n=`translate(${Math.round(o.x)+g[0]*(e?-1:1)}px, ${Math.round(o.y)+g[1]}px)`;i.transform=e?`translate(-100%, 0) ${n}`:n}else i.display="none"}t.Tooltip=class extends o{constructor(t){super(t),this.info=null,this.positionMode="follow-cursor",this._contentContainer=(()=>{const t=document.createElement("div");return t.classList.add(h.base),p.setCalciteThemeClass(t),t})(),this._contentWidget=null}initialize(){const t=this._contentContainer;this.addHandles([i.watch((()=>this.view.overlay?.surface),(e=>{t.remove(),e?.appendChild(t)}),i.syncAndInitial),i.watch((()=>this.info),((e,o)=>{if(null!=this._contentWidget&&null!=e&&null!=o&&e.type===o.type)this._contentWidget.info=e;else{this._contentWidget=n.destroyMaybe(this._contentWidget);const o=u.tooltipContentFactory(this,e);o&&(this._contentWidget=o,o.container&&t.appendChild(o.container))}}),i.syncAndInitial),i.watch((()=>({container:this._contentContainer,contentWidget:this._contentWidget,screenPoint:this._screenPoint,positionMode:this.positionMode})),_,i.syncAndInitial)])}destroy(){this._contentWidget=n.destroyMaybe(this._contentWidget),this._contentContainer.remove()}clear(){this.info=null}get _screenPoint(){const t=this.view.inputManager;return t?.multiTouchActive?null:t?.latestPointerLocation}get test(){return{contentContainer:this._contentContainer,visible:"none"!==this._contentContainer?.style.display}}},e.__decorate([s.property({nonNullable:!0})],t.Tooltip.prototype,"view",void 0),e.__decorate([s.property()],t.Tooltip.prototype,"info",void 0),e.__decorate([s.property()],t.Tooltip.prototype,"positionMode",void 0),e.__decorate([s.property()],t.Tooltip.prototype,"_contentContainer",void 0),e.__decorate([s.property()],t.Tooltip.prototype,"_contentWidget",void 0),e.__decorate([s.property()],t.Tooltip.prototype,"_screenPoint",null),t.Tooltip=e.__decorate([l.subclass("esri.views.interactive.tooltip.Tooltip")],t.Tooltip);const g=[20,20];Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
