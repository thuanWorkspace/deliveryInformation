/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../core/Collection"],(function(t,i){"use strict";var a;t.ManipulatorVisibilityPredicate=void 0,(a=t.ManipulatorVisibilityPredicate||(t.ManipulatorVisibilityPredicate={}))[a.WhenToolEditable=0]="WhenToolEditable",a[a.WhenToolNotEditable=1]="WhenToolNotEditable",a[a.Always=2]="Always";class e{constructor(){this._isToolEditable=!0,this._manipulators=new i,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(t){this._isToolEditable=t}get length(){return this._manipulators.length}add(i,a=t.ManipulatorVisibilityPredicate.WhenToolEditable){this.addMany([i],a)}addMany(i,a=t.ManipulatorVisibilityPredicate.WhenToolEditable){for(const t of i){const i={manipulator:t,visibilityPredicate:a,attached:!1};this._manipulators.add(i),this._attached&&this._updateManipulatorAttachment(i)}}remove(t){for(let i=0;i<this._manipulators.length;i++)if(this._manipulators.at(i).manipulator===t){const t=this._manipulators.splice(i,1)[0];this._detachManipulator(t);break}}removeAll(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._manipulators.removeAll()}attach(){this._manipulators.forEach((t=>{this._updateManipulatorAttachment(t)})),this._attached=!0}detach(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach((({manipulator:t})=>t.destroy())),this._manipulators.destroy(),this._resourceContexts=null}on(t,i){return this._manipulators.on(t,(t=>{i(t)}))}forEach(t){for(const i of this._manipulators.items)t(i)}some(t){return this._manipulators.items.some(t)}toArray(){const t=[];return this.forEach((i=>t.push(i.manipulator))),t}intersect(t,i){let a=null,e=Number.MAX_VALUE;return this._manipulators.forEach((({manipulator:o,attached:r})=>{if(!r||!o.interactive)return;const l=o.intersectionDistance(t,i);null!=l&&l<e&&(e=l,a=o)})),a}_updateManipulatorAttachment(t){this._isManipulatorItemVisible(t)?this._attachManipulator(t):this._detachManipulator(t)}_attachManipulator(t){t.attached||(t.manipulator.attach&&t.manipulator.attach(this._resourceContexts),t.attached=!0)}_detachManipulator(t){if(!t.attached)return;const i=t.manipulator;i.grabbing=!1,i.dragging=!1,i.hovering=!1,i.selected=!1,i.detach&&i.detach(this._resourceContexts),t.attached=!1}_isManipulatorItemVisible(i){return i.visibilityPredicate===t.ManipulatorVisibilityPredicate.Always||(this._isToolEditable?i.visibilityPredicate===t.ManipulatorVisibilityPredicate.WhenToolEditable:i.visibilityPredicate===t.ManipulatorVisibilityPredicate.WhenToolNotEditable)}}t.ManipulatorCollection=e,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
