/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../executionError","../kernel","../../chunks/languageUtils","../featureset/actions/SpatialFilter","../featureset/sources/Empty","../../geometry/Geometry","../../geometry/geometryEngineAsync"],(function(e,t,n,r,i,a,s,o){"use strict";function u(e){return e instanceof s}function c(e,c,l,f){return f(e,c,(async(f,d,p)=>{if(p.length<2)throw new t.ArcadeExecutionError(e,t.ExecutionErrorCodes.WrongNumberOfParameters,c);if(null===(p=r.autoCastFeatureToGeometry(p))[0]&&null===p[1])return!1;if(r.isFeatureSet(p[0])){if(p[1]instanceof s)return new i({parentfeatureset:p[0],relation:l,relationGeom:p[1]});if(null===p[1])return new a({parentfeatureset:p[0]});throw new t.ArcadeExecutionError(e,t.ExecutionErrorCodes.InvalidParameter,c)}if(u(p[0])){if(u(p[1])){switch(l){case"esriSpatialRelEnvelopeIntersects":return o.intersects(n.shapeExtent(p[0]),n.shapeExtent(p[1]));case"esriSpatialRelIntersects":return o.intersects(p[0],p[1]);case"esriSpatialRelContains":return o.contains(p[0],p[1]);case"esriSpatialRelOverlaps":return o.overlaps(p[0],p[1]);case"esriSpatialRelWithin":return o.within(p[0],p[1]);case"esriSpatialRelTouches":return o.touches(p[0],p[1]);case"esriSpatialRelCrosses":return o.crosses(p[0],p[1])}throw new t.ArcadeExecutionError(e,t.ExecutionErrorCodes.InvalidParameter,c)}if(r.isFeatureSet(p[1]))return new i({parentfeatureset:p[1],relation:l,relationGeom:p[0]});if(null===p[1])return!1;throw new t.ArcadeExecutionError(e,t.ExecutionErrorCodes.InvalidParameter,c)}if(null!==p[0])throw new t.ArcadeExecutionError(e,t.ExecutionErrorCodes.InvalidParameter,c);return r.isFeatureSet(p[1])?new a({parentfeatureset:p[1]}):!(p[1]instanceof s||null===p[1])&&void 0}))}function l(e){"async"===e.mode&&(e.functions.intersects=function(t,n){return c(t,n,"esriSpatialRelIntersects",e.standardFunctionAsync)},e.functions.envelopeintersects=function(t,n){return c(t,n,"esriSpatialRelEnvelopeIntersects",e.standardFunctionAsync)},e.signatures.push({name:"envelopeintersects",min:2,max:2}),e.functions.contains=function(t,n){return c(t,n,"esriSpatialRelContains",e.standardFunctionAsync)},e.functions.overlaps=function(t,n){return c(t,n,"esriSpatialRelOverlaps",e.standardFunctionAsync)},e.functions.within=function(t,n){return c(t,n,"esriSpatialRelWithin",e.standardFunctionAsync)},e.functions.touches=function(t,n){return c(t,n,"esriSpatialRelTouches",e.standardFunctionAsync)},e.functions.crosses=function(t,n){return c(t,n,"esriSpatialRelCrosses",e.standardFunctionAsync)},e.functions.relate=function(n,i){return e.standardFunctionAsync(n,i,((e,c,l)=>{if(l=r.autoCastFeatureToGeometry(l),r.pcCheck(l,3,3,n,i),u(l[0])&&u(l[1]))return o.relate(l[0],l[1],r.toString(l[2]));if(l[0]instanceof s&&null===l[1])return!1;if(l[1]instanceof s&&null===l[0])return!1;if(r.isFeatureSet(l[0])&&null===l[1])return new a({parentfeatureset:l[0]});if(r.isFeatureSet(l[1])&&null===l[0])return new a({parentfeatureset:l[1]});if(r.isFeatureSet(l[0])&&l[1]instanceof s)return l[0].relate(l[1],r.toString(l[2]));if(r.isFeatureSet(l[1])&&l[0]instanceof s)return l[1].relate(l[0],r.toString(l[2]));if(null===l[0]&&null===l[1])return!1;throw new t.ArcadeExecutionError(n,t.ExecutionErrorCodes.InvalidParameter,i)}))})}e.registerFunctions=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
