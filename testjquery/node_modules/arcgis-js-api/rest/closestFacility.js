/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../request","../core/accessorSupport/get","../geometry/support/normalizeUtils","./networkService","./utils","./route/utils","./support/ClosestFacilitySolveResult","./support/FeatureSet"],(function(e,r,t,i,s,o,a,l,n){"use strict";function c(e){return e instanceof n}async function u(e,n,u){const f=[],p=[],y={},m={},d=o.parseUrl(e),{path:g}=d;c(n.incidents)&&s.collectGeometries(n.incidents.features,p,"incidents.features",y),c(n.facilities)&&s.collectGeometries(n.facilities.features,p,"facilities.features",y),c(n.pointBarriers)&&s.collectGeometries(n.pointBarriers.features,p,"pointBarriers.features",y),c(n.polylineBarriers)&&s.collectGeometries(n.polylineBarriers.features,p,"polylineBarriers.features",y),c(n.polygonBarriers)&&s.collectGeometries(n.polygonBarriers.features,p,"polygonBarriers.features",y);const B=await i.normalizeCentralMeridian(p);for(const r in y){const e=y[r];f.push(r),m[r]=B.slice(e[0],e[1])}if(s.isInputGeometryZAware(m,f)){let e=null;try{e=await s.fetchServiceDescription(g,n.apiKey,u)}catch{}e&&!e.hasZ&&s.dropZValuesOffInputGeometry(m,f)}for(const r in m)m[r].forEach(((e,i)=>{t.get(n,r)[i].geometry=e}));const S={...u,query:{...d.query,...a.closestFacilityParametersToQueryParameters(n),f:"json"}},{data:G}=await r(`${g}/solveClosestFacility`,S);return l.fromJSON(G)}e.solve=u,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
