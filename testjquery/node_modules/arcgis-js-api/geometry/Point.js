/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../chunks/tslib.es6","../core/Logger","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/reader","../core/accessorSupport/decorators/subclass","../core/accessorSupport/decorators/writer","../core/accessorSupport/ensureType","./Geometry","./SpatialReference","./support/pointUtils","./support/spatialReferenceUtils","./support/webMercatorUtils"],(function(e,t,r,i,s,o,a,n,l,c,u,p,h,d,y){"use strict";var g;const f=[0,0];function _(e){return e&&("esri.geometry.SpatialReference"===e.declaredClass||null!=e.wkid)}let m=g=class extends u{static copy(e,t){t._set("x",e._get("x")),t._set("y",e._get("y")),t._set("z",e._get("z")),t._set("m",e._get("m"));const r=e._get("spatialReference");t._set("spatialReference",Object.isFrozen(r)?r:r.clone())}constructor(...e){super(...e),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(e,r,i,s,o){let a;if(Array.isArray(e))a=e,o=r,e=a[0],r=a[1],i=a[2],s=a[3];else if(e&&"object"==typeof e){if(a=e,e=null!=a.x?a.x:a.longitude,r=null!=a.y?a.y:a.latitude,i=a.z,s=a.m,(o=a.spatialReference)&&"esri.geometry.SpatialReference"!==o.declaredClass&&(o=new p(o)),null!=a.longitude||null!=a.latitude)if(null==a.longitude)t.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(null==a.latitude)t.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!a.declaredClass&&o&&o.isWebMercator){const t=y.lngLatToXY(a.longitude,a.latitude,f);e=t[0],r=t[1]}}else _(i)?(o=i,i=null):_(s)&&(o=s,s=null);const n={x:e,y:r};return null==n.x&&null!=n.y?t.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):null==n.y&&null!=n.x&&t.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),null!=o&&(n.spatialReference=o),null!=i&&(n.z=i),null!=s&&(n.m=s),n}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return void 0!==this.m}set hasM(e){e!==(void 0!==this._get("m"))&&(this._set("m",e?0:void 0),this._set("hasM",e))}get hasZ(){return void 0!==this.z}set hasZ(e){e!==(void 0!==this._get("z"))&&(this._set("z",e?0:void 0),this._set("hasZ",e))}get latitude(){const{spatialReference:e,x:t,y:r}=this;if(e){if(e.isWebMercator)return y.xyToLngLat(t,r,f)[1];if(e.isGeographic)return r}return null}set latitude(e){const{spatialReference:t,x:r}=this;null!=e&&t&&(t.isWebMercator?this._set("y",y.lngLatToXY(r,e,f)[1]):t.isGeographic&&this._set("y",e),this._set("latitude",e))}get longitude(){const{x:e,y:t,spatialReference:r}=this;if(r){if(r.isWebMercator)return y.xyToLngLat(e,t,f)[0];if(r.isGeographic)return e}return null}set longitude(e){const{y:t,spatialReference:r}=this;null!=e&&r&&(r.isWebMercator?this._set("x",y.lngLatToXY(e,t,f)[0]):r.isGeographic&&this._set("x",e),this._set("longitude",e))}writeX(e,t,r){t[r]=isNaN(e)?"NaN":e}readX(e){return"string"==typeof e?NaN:e}clone(){const e=new g;return e.x=this.x,e.y=this.y,e.z=this.z,e.m=this.m,e.spatialReference=this.spatialReference,e}copy(e){return g.copy(e,this),this}equals(e){if(null==e)return!1;const{x:t,y:r,z:i,m:s,spatialReference:o}=this,{z:a,m:n}=e;let{x:l,y:c,spatialReference:u}=e;if(!o.equals(u))if(o.isWebMercator&&u.isWGS84)[l,c]=y.lngLatToXY(l,c),u=o;else{if(!o.isWGS84||!u.isWebMercator)return!1;[l,c]=y.xyToLngLat(l,c),u=o}return t===l&&r===c&&i===a&&s===n&&o.wkid===u.wkid}offset(e,t,r){return this.x+=e,this.y+=t,null!=r&&(this.z=(this.z??0)+r),this}normalize(){if(!this.spatialReference)return this;const e=d.getInfo(this.spatialReference);if(!e)return this;let t=this.x;const[r,i]=e.valid,s=2*i;let o;return t>i?(o=Math.ceil(Math.abs(t-i)/s),t-=o*s):t<r&&(o=Math.ceil(Math.abs(t-r)/s),t+=o*s),this._set("x",t),this}distance(e){return h.distance(this,e)}toArray(){const e=this.hasZ,t=this.hasM;return e&&t?[this.x,this.y,this.z,this.m]:e?[this.x,this.y,this.z]:t?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(e){return this.write({},e)}};e.__decorate([r.property({readOnly:!0})],m.prototype,"cache",null),e.__decorate([r.property({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],m.prototype,"hasM",null),e.__decorate([r.property({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],m.prototype,"hasZ",null),e.__decorate([r.property({type:Number})],m.prototype,"latitude",null),e.__decorate([r.property({type:Number})],m.prototype,"longitude",null),e.__decorate([r.property({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),i.cast((e=>isNaN(e)?e:c.ensureNumber(e)))],m.prototype,"x",void 0),e.__decorate([l.writer("x")],m.prototype,"writeX",null),e.__decorate([a.reader("x")],m.prototype,"readX",null),e.__decorate([r.property({type:Number,json:{write:!0}})],m.prototype,"y",void 0),e.__decorate([r.property({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],m.prototype,"z",void 0),e.__decorate([r.property({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],m.prototype,"m",void 0),m=g=e.__decorate([n.subclass("esri.geometry.Point")],m),m.prototype.toJSON.isDefaultToJSON=!0;return m}));
