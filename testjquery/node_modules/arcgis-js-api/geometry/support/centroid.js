/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../geometryCursorCollectUtils","./coordsUtils"],(function(t,n,e){"use strict";function r(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function o(t){return t?l(t.rings,t.hasZ??!1):null}function l(t,n){if(!t?.length)return null;const e=[],r=[],o=n?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let l=0,u=t.length;l<u;l++){const e=i(t[l],n,o);e&&r.push(e)}if(r.sort(((t,e)=>{let r=t[2]-e[2];return 0===r&&n&&(r=t[4]-e[4]),r})),r.length&&(e[0]=r[0][0],e[1]=r[0][1],n&&(e[2]=r[0][3]),(e[0]<o[0]||e[0]>o[1]||e[1]<o[2]||e[1]>o[3]||n&&(e[2]<o[4]||e[2]>o[5]))&&(e.length=0)),!e.length){const r=t[0]&&t[0].length?s(t[0],n):null;if(!r)return null;e[0]=r[0],e[1]=r[1],n&&r.length>2&&(e[2]=r[2])}return e}function i(t,n,e){let r=0,o=0,l=0,i=0,u=0;const s=t.length?t[0][0]:0,h=t.length?t[0][1]:0,I=t.length&&n?t[0][2]:0;for(let g=0;g<t.length;g++){const c=t[g],f=t[(g+1)%t.length],[N,x,a]=c,P=N-s,m=x-h,[T,y,d]=f,C=T-s,S=y-h,E=P*S-C*m;if(i+=E,r+=(P+C)*E,o+=(m+S)*E,n&&c.length>2&&f.length>2){const t=a-I,n=d-I,e=P*n-C*t;l+=(t+n)*e,u+=e}N<e[0]&&(e[0]=N),N>e[1]&&(e[1]=N),x<e[2]&&(e[2]=x),x>e[3]&&(e[3]=x),n&&(a<e[4]&&(e[4]=a),a>e[5]&&(e[5]=a))}if(i>0&&(i*=-1),u>0&&(u*=-1),!i)return null;i*=.5,u*=.5;const c=[r/(6*i)+s,o/(6*i)+h,i];return n&&(e[4]===e[5]||0===u?(c[3]=(e[4]+e[5])/2,c[4]=0):(c[3]=l/(6*u)+I,c[4]=u)),c}function u(t,n){let e=0,r=0,o=0;t.nextPoint();const l=t.pathSize?t.x:0,i=t.pathSize?t.y:0;for(let u=0;u<t.pathSize;u++){t.seekInPath(u);const s=[t.x,t.y];t.seekInPath((u+1)%t.pathSize);const h=[t.x,t.y],[I,c]=s,g=I-l,f=c-i,[N,x]=h,a=N-l,P=x-i,m=g*P-a*f;o+=m,e+=(g+a)*m,r+=(f+P)*m,I<n[0]&&(n[0]=I),I>n[1]&&(n[1]=I),c<n[2]&&(n[2]=c),c>n[3]&&(n[3]=c)}if(o>0&&(o*=-1),!o)return null;o*=.5;return[e/(6*o)+l,r/(6*o)+i,o]}function s(t,n){const r=n?[0,0,0]:[0,0],o=n?[0,0,0]:[0,0];let l=0,i=0,u=0,s=0;for(let h=0,I=t.length;h<I-1;h++){const I=t[h],c=t[h+1];if(I&&c){r[0]=I[0],r[1]=I[1],o[0]=c[0],o[1]=c[1],n&&I.length>2&&c.length>2&&(r[2]=I[2],o[2]=c[2]);const t=e.getLength(r,o);if(t){l+=t;const r=e.getMidpoint(I,c);i+=t*r[0],u+=t*r[1],n&&r.length>2&&(s+=t*r[2])}}}return l>0?n?[i/l,u/l,s/l]:[i/l,u/l]:t.length?t[0]:null}function h(t){const{hasZ:e,totalSize:r}=t;if(0===r)return null;const o=[],l=[],u=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const e=i(n.collectPath(t),t.hasZ,u);e&&l.push(e)}if(l.sort(((t,n)=>{let r=t[2]-n[2];return 0===r&&e&&(r=t[4]-n[4]),r})),l.length&&(o[0]=l[0][0],o[1]=l[0][1],e&&(o[2]=l[0][3]),(o[0]<u[0]||o[0]>u[1]||o[1]<u[2]||o[1]>u[3]||e&&(o[2]<u[4]||o[2]>u[5]))&&(o.length=0)),!o.length){t.reset(),t.nextPath();const n=t.pathSize?I(t):null;if(!n)return null;o[0]=n[0],o[1]=n[1],e&&n.length>2&&(o[2]=n[2])}return o}function I(t){const{hasZ:n}=t,r=n?[0,0,0]:[0,0],o=n?[0,0,0]:[0,0];let l=0,i=0,u=0,s=0;if(t.nextPoint()){let h=t.x,I=t.y,c=t.z;for(;t.nextPoint();){const g=t.x,f=t.y,N=t.z;r[0]=h,r[1]=I,o[0]=g,o[1]=f,n&&(r[2]=c,o[2]=N);const x=e.getLength(r,o);if(x){l+=x;const t=e.getMidpoint(r,o);i+=x*t[0],u+=x*t[1],n&&t.length>2&&(s+=x*t[2])}h=g,I=f,c=N}}return l>0?n?[i/l,u/l,s/l]:[i/l,u/l]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const c=1e-6;function g(t){let n=0;for(t.reset();t.nextPath();)n+=t.getCurrentRingArea();if(n<c){const n=h(t);return n?[n[0],n[1]]:null}const e=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const r=[t.x,t.y];for(t.reset();t.nextPath();)N(e,r,t);return e[0]*=1/n,e[1]*=1/n,e[0]+=r[0],e[1]+=r[1],e}const f=1/3;function N(t,n,e){if(!t||!e||e.pathSize<3)return null;e.nextPoint();const r=e.x,o=e.y;e.nextPoint();let l,i=e.x-r,u=e.y-o,s=0,h=0;for(;e.nextPoint();)s=e.x-r,h=e.y-o,l=.5*f*(s*u-h*i),t[0]+=l*(i+s),t[1]+=l*(u+h),i=s,u=h;const I=e.getCurrentRingArea(),c=[r,o];return c[0]-=n[0],c[1]-=n[1],c[0]*=I,c[1]*=I,t[0]+=c[0],t[1]+=c[1],t}t.extentCentroid=r,t.lineCentroid=s,t.lineCentroidCursor=I,t.polygonCentroid=o,t.ringCentroid=i,t.ringCentroidCursorXY=u,t.ringsCentroid=l,t.ringsCentroidCursor=h,t.weightedAreaCentroid=g,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
