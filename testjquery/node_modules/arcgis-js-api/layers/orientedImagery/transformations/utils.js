/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/mat3f64","../../../chunks/mat4f64","../../../chunks/vec3f64","../../../chunks/mat4"],(function(t,a,n,s,h){"use strict";function M(t,a,n){const[s,h,M,i]=a,[c,r,e,z]=n;return o(t,s,h,M,i,c,r,e,z)}function o(t,a,s,M,o,c,r,e,z){let u=!1;0===a.z&&0===s.z&&0===M.z&&0===o.z&&(a.z=s.z=M.z=o.z=1,t.z=1),a.z=a.z??1,s.z=s.z??1,M.z=M.z??1,o.z=o.z??1,0===c.z&&0===r.z&&0===e.z&&0===z.z&&(u=!0,c.z=r.z=e.z=z.z=1),c.z=c.z??1,r.z=r.z??1,e.z=e.z??1,z.z=z.z??1;const x=i(a,s,M,o),y=i(c,r,e,z),m=h.invertOrIdentity(n.create(),x),f=n.create();f[0]=y[0]*m[0]+y[1]*m[4]+y[2]*m[8]+y[3]*m[12],f[1]=y[0]*m[1]+y[1]*m[5]+y[2]*m[9]+y[3]*m[13],f[2]=y[0]*m[2]+y[1]*m[6]+y[2]*m[10]+y[3]*m[14],f[3]=y[0]*m[3]+y[1]*m[7]+y[2]*m[11]+y[3]*m[15],f[4]=y[4]*m[0]+y[5]*m[4]+y[6]*m[8]+y[7]*m[12],f[5]=y[4]*m[1]+y[5]*m[5]+y[6]*m[9]+y[7]*m[13],f[6]=y[4]*m[2]+y[5]*m[6]+y[6]*m[10]+y[7]*m[14],f[7]=y[4]*m[3]+y[5]*m[7]+y[6]*m[11]+y[7]*m[15],f[8]=y[8]*m[0]+y[9]*m[4]+y[10]*m[8]+y[11]*m[12],f[9]=y[8]*m[1]+y[9]*m[5]+y[10]*m[9]+y[11]*m[13],f[10]=y[8]*m[2]+y[9]*m[6]+y[10]*m[10]+y[11]*m[14],f[11]=y[8]*m[3]+y[9]*m[7]+y[10]*m[11]+y[11]*m[15],f[12]=y[12]*m[0]+y[13]*m[4]+y[14]*m[8]+y[15]*m[12],f[13]=y[12]*m[1]+y[13]*m[5]+y[14]*m[9]+y[15]*m[13],f[14]=y[12]*m[2]+y[13]*m[6]+y[14]*m[10]+y[15]*m[14],f[15]=y[12]*m[3]+y[13]*m[7]+y[14]*m[11]+y[15]*m[15];const l=f[0]*t.x+f[1]*t.y+f[2]*t.z+f[3],b=f[4]*t.x+f[5]*t.y+f[6]*t.z+f[7],d=f[8]*t.x+f[9]*t.y+f[10]*t.z+f[11];let q=f[12]*t.x+f[13]*t.y+f[14]*t.z+f[15];return 0===q&&(q=1),{x:l/q,y:b/q,z:u?0:d/q}}function i(t,a,n,s){const M=z([s.x,s.y,s.z,1],h.invertOrIdentity(new Array(16),[t.x,a.x,n.x,0,t.y,a.y,n.y,0,t.z,a.z,n.z,0,1,1,1,1])),o=M[0],i=M[1],c=M[2],r=new Array(16);return r[0]=o*t.x,r[1]=i*a.x,r[2]=c*n.x,r[3]=0,r[4]=o*t.y,r[5]=i*a.y,r[6]=c*n.y,r[7]=0,r[8]=o*t.z,r[9]=i*a.z,r[10]=c*n.z,r[11]=0,r[12]=o,r[13]=i,r[14]=c,r[15]=1,r}function c(t,a,n,h){const M=s.zeros();return M[0]=t[0]+a[0]*n,M[1]=t[1]+a[1]*n,M[2]=t[2]+a[2]*(n/h),M}function r(t,a,n){const h=s.zeros();return h[0]=t[0]*a,h[1]=t[1]*a,h[2]=t[2]*(a/n),h}function e(t,a){const[n,h,M]=t,o=s.zeros();return o[0]=n*a[0]+h*a[3]+M*a[6],o[1]=n*a[1]+h*a[4]+M*a[7],o[2]=n*a[2]+h*a[5]+M*a[8],o}function z(t,a){const[n,s,h,M]=t,o=new Array(4);return o[0]=n*a[0]+s*a[1]+h*a[2]+M*a[3],o[1]=n*a[4]+s*a[5]+h*a[6]+M*a[7],o[2]=n*a[8]+s*a[9]+h*a[10]+M*a[11],o[3]=n*a[12]+s*a[13]+h*a[14]+M*a[15],o}function u(t,n){const s=Math.PI/180,h=a.create();if("OPK"===t){const t=Number(n[0])*s,a=Number(n[1])*s,M=Number(n[2])*s;h[0]=Math.cos(a)*Math.cos(M),h[1]=Math.cos(t)*Math.sin(M)+Math.sin(t)*Math.sin(a)*Math.cos(M),h[2]=Math.sin(t)*Math.sin(M)-Math.cos(t)*Math.sin(a)*Math.cos(M),h[3]=-Math.cos(a)*Math.sin(M),h[4]=Math.cos(t)*Math.cos(M)-Math.sin(t)*Math.sin(a)*Math.sin(M),h[5]=Math.sin(t)*Math.cos(M)+Math.cos(t)*Math.sin(a)*Math.sin(M),h[6]=Math.sin(a),h[7]=-Math.sin(t)*Math.cos(a),h[8]=Math.cos(t)*Math.cos(a)}else{const t=Number(n[0])*s,a=Number(n[1])*s,M=Number(n[2])*s;h[0]=Math.cos(t)*Math.cos(M)-Math.sin(t)*Math.cos(a)*Math.sin(M),h[1]=Math.sin(t)*Math.cos(M)*-1-Math.cos(t)*Math.cos(a)*Math.sin(M),h[2]=Math.sin(M)*Math.sin(a)*-1,h[3]=Math.cos(t)*Math.sin(M)+Math.sin(t)*Math.cos(a)*Math.cos(M),h[4]=Math.sin(t)*Math.sin(M)*-1+Math.cos(t)*Math.cos(a)*Math.cos(M),h[5]=Math.cos(M)*Math.sin(a),h[6]=Math.sin(t)*Math.sin(a)*-1,h[7]=Math.cos(t)*Math.sin(a)*-1,h[8]=Math.cos(a)}return h}function x(t,a,n){const s=Math.sin(n*Math.PI/180),h=Math.cos(n*Math.PI/180),M=[[t,0],[t,a],[0,a]];M.forEach(((t,a)=>{M[a]=[h*t[0]-s*t[1],s*t[0]+h*t[1]]}));const o={xmin:Math.min(0,M[0][0],M[1][0],M[2][0]),xmax:Math.max(0,M[0][0],M[1][0],M[2][0]),ymin:Math.min(0,M[0][1],M[1][1],M[2][1]),ymax:Math.max(0,M[0][1],M[1][1],M[2][1])};return{hfov:Math.abs(o.xmax-o.xmin),vfov:Math.abs(o.ymax-o.ymin)}}function y(t,a,n,s,h,M){const o=n*(a.x-t.x)+s*(a.y-t.y)+h*(a.z-t.z);if(0===o)return null;const i=-(n*t.x+s*t.y+h*t.z+M)/o;return{x:t.x+i*(a.x-t.x),y:t.y+i*(a.y-t.y),z:t.z+i*(a.z-t.z)}}function m(t,a){const n=Math.PI/180,s=t.y*n,h=t.x*n,M=t.z||0,o=a[0]*n,i=a[1]*n,c=a[2]/Math.sqrt(1-a[3]*Math.sin(o)**2),r=h-i,e=a[2]/Math.sqrt(1-a[3]*Math.sin(s)**2),z=a[3]*(c*Math.sin(o)-e*Math.sin(s));return{x:(e+M)*Math.cos(s)*Math.sin(r),y:(e+M)*(Math.sin(s)*Math.cos(o)-Math.sin(o)*Math.cos(s)*Math.cos(r))+z*Math.cos(o),z:(e+M)*(Math.sin(s)*Math.sin(o)+Math.cos(o)*Math.cos(s)*Math.cos(r))-c+z*Math.sin(o)}}function f(t,a){const n=Math.PI/180,s=Number(t.x),h=Number(t.y),M=Number(t.z),o=a[0]*n,i=a[1]*n,c=a[2]/Math.sqrt(1-a[3]*Math.sin(o)**2),r=s/c,e=h/c,z=M/c,u=Math.cos(o)-Math.sin(o)*e+Math.cos(o)*z,x=Math.sin(o)+Math.cos(o)*e+Math.sin(o)*z,y=Math.sqrt(u**2+r**2),m=a[3]*c*Math.sin(o),f=o,l=Math.atan(x/y-(m-a[3]*(a[2]/Math.sqrt(1-a[3]*Math.sin(f)**2))*Math.sin(f))/(c*y)),b=Math.atan(x/y-(m-a[3]*(a[2]/Math.sqrt(1-a[3]*Math.sin(l)**2))*Math.sin(l))/(c*y)),d=Math.atan(x/y-(m-a[3]*(a[2]/Math.sqrt(1-a[3]*Math.sin(b)**2))*Math.sin(b))/(c*y)),q=Math.atan(x/y-(m-a[3]*(a[2]/Math.sqrt(1-a[3]*Math.sin(d)**2))*Math.sin(d))/(c*y)),v=Math.atan(s/(c*u))+i;return{x:v/n,y:q/n,z:s/(Math.cos(q)*Math.sin(v-i))-a[2]/Math.sqrt(1-a[3]*Math.sin(q)**2),spatialReference:{wkid:4326}}}t.calculateRotationMatrix=u,t.computeHFOVAndVFOV=x,t.geographicToLTP=m,t.getPlaneLineIntersectionPoint=y,t.linearEquationSolve=i,t.ltpToGeographic=f,t.projectiveTransform=o,t.projectiveTransform2=M,t.scaleAndAddWithFactor=c,t.scaleWithFactor=r,t.transformMat3=e,t.transformMat4=z,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
