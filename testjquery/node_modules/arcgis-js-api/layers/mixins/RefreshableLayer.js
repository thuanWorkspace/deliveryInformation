/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../chunks/tslib.es6","../../core/Logger","../../core/promiseUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/arrayUtils","../../core/has","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/layerContainerType","./refresh"],(function(e,r,t,s,a,o,n,h,i,c,p){"use strict";function l(e){return null!=e&&"object"==typeof e&&"refreshTimestamp"in e&&"refresh"in e}const d=.1,u=e=>{let n=class extends e{constructor(...e){super(...e),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=s.debounce((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||p.registerLayer(this)}),(()=>{}))}destroy(){p.unregisterLayer(this)}castRefreshInterval(e){return e>=d?e:e<=0?0:d}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(e=Date.now()){s.ignoreAbortErrors(this._debounceHasDataChanged()).then((r=>{r&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:r})}),(e=>{t.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){const e=this;return{set refreshInterval(r){e._set("refreshInterval",r)}}}};return r.__decorate([a.property({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:c.excludeTables}}}}})],n.prototype,"refreshInterval",void 0),r.__decorate([o.cast("refreshInterval")],n.prototype,"castRefreshInterval",null),r.__decorate([a.property({readOnly:!0})],n.prototype,"refreshTimestamp",void 0),r.__decorate([a.property({readOnly:!0})],n.prototype,"refreshParameters",null),n=r.__decorate([i.subclass("esri.layers.mixins.RefreshableLayer")],n),n};e.RefreshableLayer=u,e.isRefreshableLayer=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
