/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../chunks/tslib.es6","../request","../core/Error","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass","../geometry/Extent","../geometry/SpatialReference","../geometry/support/aaBoundingRect","./Layer","./mixins/BlendLayer","./mixins/RefreshableLayer","./mixins/ScaleRangeLayer","./support/imageBitmapUtils","./support/TileInfo","./support/TileKey"],(function(e,t,r,o,a,s,i,l,n,p,c,y,u,d,h,f,T,g){"use strict";var m;const b=new g.TileKey("0/0/0",0,0,0,void 0);let _=m=class extends(u.BlendLayer(h.ScaleRangeLayer(d.RefreshableLayer(y)))){constructor(){super(...arguments),this.tileInfo=T.create({spatialReference:p.WebMercator,size:256}),this.type="base-tile",this.fullExtent=new n(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,p.WebMercator),this.spatialReference=p.WebMercator}getTileBounds(e,t,r,o){const a=o||c.create();return b.level=e,b.row=t,b.col=r,b.extent=a,this.tileInfo.updateTileInfo(b),b.extent=void 0,a}fetchTile(e,r,o,a={}){const{signal:s}=a,i=this.getTileUrl(e,r,o),l={responseType:"image",signal:s,query:{...this.refreshParameters}};return t(i??"",l).then((e=>e.data))}async fetchImageBitmapTile(e,r,o,a={}){const{signal:s}=a;if(this.fetchTile!==m.prototype.fetchTile){const t=await this.fetchTile(e,r,o,a);return f.createTileBitmap(t,e,r,o,s)}const i=this.getTileUrl(e,r,o)??"",l={responseType:"blob",signal:s,query:{...this.refreshParameters}},{data:n}=await t(i,l);return f.createTileBitmap(n,e,r,o,s)}getTileUrl(){throw new r("basetilelayer:gettileurl-not-implemented","getTileUrl() is not implemented")}};e.__decorate([o.property({type:T})],_.prototype,"tileInfo",void 0),e.__decorate([o.property({type:["show","hide"]})],_.prototype,"listMode",void 0),e.__decorate([o.property({readOnly:!0,value:"base-tile"})],_.prototype,"type",void 0),e.__decorate([o.property({nonNullable:!0})],_.prototype,"fullExtent",void 0),e.__decorate([o.property()],_.prototype,"spatialReference",void 0),_=m=e.__decorate([l.subclass("esri.layers.BaseTileLayer")],_);return _}));
