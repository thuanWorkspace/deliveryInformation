/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","./utils","../../portal/support/jsonContext","../../portal/support/portalItemUtils","../../webdoc/support/saveUtils"],(function(e,r,t,a,s){"use strict";const o="Group Layer",n="group-layer-save",c="group-layer-save-as",u=a.TypeKeyword.GROUP_LAYER_MAP;function i(e){return{isValid:"group"===e.type,errorMessage:"Layer.type should be 'group'"}}function l(e){return{isValid:a.hasTypeKeyword(e,u),errorMessage:`Layer.portalItem.typeKeywords should have '${u}'`}}function y(e){const r=e.layerJSON;return Promise.resolve(r&&Object.keys(r).length?r:null)}async function p(e,r){r.title||(r.title=e.title),a.addTypeKeyword(r,u)}async function v(e,a){const c={layer:e,itemType:o,validateLayer:i,validateItem:l,createJSONContext:r=>t.createForGroupLayerItemWrite(r,e),createItemData:y,errorNamePrefix:n,saveResources:async(r,t)=>(e.sourceIsPortalItem||await r.removeAllResources().catch((()=>{})),s.saveResources(e.resourceReferences,t))};return r.save(c,a)}async function d(e,a,n){const u={layer:e,itemType:o,validateLayer:i,createJSONContext:r=>t.createForGroupLayerItemWrite(r,e),createItemData:y,errorNamePrefix:c,newItem:a,setItemProperties:p,saveResources:(r,t)=>s.saveResources(e.resourceReferences,t)};return r.saveAs(u,n)}e.save=v,e.saveAs=d,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
