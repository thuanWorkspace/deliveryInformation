/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../chunks/tslib.es6","../../core/Accessor","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/has","../../core/accessorSupport/decorators/subclass"],(function(e,r,t,s,a,o,l,p){"use strict";const i={visible:"visibleSublayers"};e.ExportWMSImageParameters=class extends t{constructor(e){super(e),this.scale=0}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.removeHandles("layer"),e&&this.addHandles([e.sublayers.on("change",(()=>this.notifyChange("visibleSublayers"))),e.on("wms-sublayer-update",(e=>this.notifyChange(i[e.propertyName])))],"layer"))}get layers(){return this.visibleSublayers.filter((({name:e})=>e)).map((({name:e})=>e)).join()}get version(){this.commitProperty("layers");const e=this.layer;return e&&e.commitProperty("imageTransparency"),(this._get("version")||0)+1}get visibleSublayers(){const{layer:e,scale:r}=this,t=e?.sublayers,s=[],a=e=>{const{minScale:t,maxScale:o,sublayers:l,visible:p}=e;p&&(0===r||(0===t||r<=t)&&(0===o||r>=o))&&(l?l.forEach(a):s.push(e))};return t?.forEach(a),s}toJSON(){const{layer:e,layers:r}=this,{imageFormat:t,imageTransparency:s,version:a}=e;return{format:t,request:"GetMap",service:"WMS",styles:"",transparent:s?"TRUE":"FALSE",version:a,layers:r}}},r.__decorate([s.property()],e.ExportWMSImageParameters.prototype,"layer",null),r.__decorate([s.property({readOnly:!0})],e.ExportWMSImageParameters.prototype,"layers",null),r.__decorate([s.property({type:Number})],e.ExportWMSImageParameters.prototype,"scale",void 0),r.__decorate([s.property({readOnly:!0})],e.ExportWMSImageParameters.prototype,"version",null),r.__decorate([s.property({readOnly:!0})],e.ExportWMSImageParameters.prototype,"visibleSublayers",null),e.ExportWMSImageParameters=r.__decorate([p.subclass("esri.layers.support.ExportWMSImageParameters")],e.ExportWMSImageParameters),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
