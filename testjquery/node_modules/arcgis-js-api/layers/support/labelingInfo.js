/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../core/Error","../../core/lang","../../core/Logger","./LabelClass"],(function(e,r,t,n,o){"use strict";const l=n.getLogger("esri.layers.support.labelingInfo"),i=/\[([^\[\]]+)\]/gi;function a(e,r,t){return e?e.map((e=>{const n=new o;if(n.read(e,t),n.labelExpression){const e=r.fields||r.layerDefinition?.fields||this.fields;n.labelExpression=n.labelExpression.replaceAll(i,((r,t)=>`[${s(t,e)}]`))}return n})):null}function s(e,r){if(!r)return e;const t=e.toLowerCase();for(let n=0;n<r.length;n++){const e=r[n].name;if(e.toLowerCase()===t)return e}return e}const c={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};function f(e,r){const n=t.clone(e);return n.some((e=>u(e,r)))?[]:n}function u(e,t){const n=e.labelPlacement,o=c[t];if(!e.symbol)return l.warn("No ILabelClass symbol specified."),!0;if(!o)return l.error(new r("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${t}' is not supported`)),!0;if(!o.includes(n)){const r=o[0];n&&l.warn(`Found invalid label placement type ${n} for ${t}. Defaulting to ${r}`),e.labelPlacement=r}return!1}e.reader=a,e.validateLabelingInfo=f,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
