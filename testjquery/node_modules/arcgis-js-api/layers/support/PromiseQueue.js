/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../core/promiseUtils","../../core/signal"],(function(t,s,e){"use strict";class r{constructor(){this._tasks=new Array,this._running=e.signal(!1)}get length(){return this._tasks.length}get running(){return this._running.value}destroy(){this.cancelAll()}runTask(t){for(;!t.done&&this._process(t);)t.madeProgress()}push(t,s,e){return this._running.value=!0,new Promise(((r,i)=>this._tasks.push(new n(r,i,t,s,e))))}unshift(t,s,e){return this._running.value=!0,new Promise(((r,i)=>this._tasks.unshift(new n(r,i,t,s,e))))}_process(t){if(0===this._tasks.length)return!1;const e=this._tasks.shift();try{const r=s.isAborted(e.signal);if(r&&!e.abortCallback)e.reject(s.createAbortError());else{const n=r?e.abortCallback?.(s.createAbortError()):e.callback(t);s.isPromiseLike(n)?n.then(e.resolve,e.reject):e.resolve(n)}}catch(r){e.reject(r)}return this._running.value=this._tasks.length>0,!0}cancelAll(){const t=s.createAbortError();for(const s of this._tasks)if(s.abortCallback){const e=s.abortCallback(t);s.resolve(e)}else s.reject(t);this._tasks.length=0,this._running.value=!1}}class n{constructor(t,s,e,r=void 0,n=void 0){this.resolve=t,this.reject=s,this.callback=e,this.signal=r,this.abortCallback=n}}t.PromiseQueue=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
