/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../../chunks/tslib.es6","../../core/Collection","../../core/JSONSupport","../../core/Warning","../../core/Logger","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/has","../../core/Error","../../core/accessorSupport/decorators/subclass","../../geometry/Polygon","../../geometry/projection"],(function(e,r,t,s,o,n,c,a,i,l,p,u){"use strict";var f;let m=f=class extends(t.JSONSupportMixin(r.ofType(p))){constructor(e){super(e)}clone(){return new f(this.items.map((e=>e.clone())))}write(e,r){return this.toJSON(r)}toJSON(e){const r=e?.layer?.spatialReference;return r?this.toArray().map((t=>{if(!r.equals(t.spatialReference)){if(!u.canProjectWithoutEngine(t.spatialReference,r))return e?.messages&&e.messages.push(new s("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),null;const o=new p;u.projectPolygon(t,o,r),t=o}const o=t.toJSON(e);return delete o.spatialReference,o})).filter((e=>null!=e)):(e?.messages&&e.messages.push(new s("scenefilter:unsupported","Writing Scene filters without context layer is not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),this.toArray().map((r=>r.toJSON(e))))}static fromJSON(e,r){const t=new f;return e.forEach((e=>t.add(p.fromJSON(e,r)))),t}};m=f=e.__decorate([l.subclass("esri.layers.support.PolygonCollection")],m);return m}));
