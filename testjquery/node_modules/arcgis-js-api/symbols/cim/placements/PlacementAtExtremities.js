/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../CIMCursor","../CurveHelper","../enums"],(function(e,t,i,s){"use strict";class n{static local(){return null===n.instance&&(n.instance=new n),n.instance}execute(e,t,i,s,n){return new r(e,t,i)}}n.instance=null;class r extends t.PathTransformationCursor{constructor(e,t,s){super(e,!1,!0),this._curveHelper=new i.CurveHelper,this._angleToLine=void 0===t.angleToLine||t.angleToLine,this._offset=void 0!==t.offset?t.offset*s:0,this._type=t.extremityPlacement,this._position=void 0!==t.offsetAlongLine?t.offsetAlongLine*s:0,this._beginProcessed=!1}processPath(e){let t;switch(this._type){case s.ExtremityPlacement.Both:default:this._beginProcessed?(t=this._atExtremities(e,this._position,!1),this._beginProcessed=!1,this.iteratePath=!1):(t=this._atExtremities(e,this._position,!0),this._beginProcessed=!0,this.iteratePath=!0);break;case s.ExtremityPlacement.JustBegin:t=this._atExtremities(e,this._position,!0);break;case s.ExtremityPlacement.JustEnd:t=this._atExtremities(e,this._position,!1);case s.ExtremityPlacement.None:}return t}_atExtremities(e,t,i){if(i||e.seekPathEnd(),i?e.nextPoint():e.prevPoint()){let s=0,[n,r]=[0,0],[o,a]=[e.x,e.y];for(;i?e.nextPoint():e.prevPoint();){n=o,r=a,o=e.x,a=e.y;const i=this._curveHelper.getLength(n,r,o,a);if(s+i>t){const e=(t-s)/i,[l,c]=this._curveHelper.getAngleCS(n,r,o,a,e),h=this._curveHelper.getCoord2D(n,r,o,a,e);return this.internalPlacement.setTranslate(h[0]-this._offset*c,h[1]+this._offset*l),this._angleToLine&&this.internalPlacement.setRotateCS(-l,-c),this.internalPlacement}s+=i}}return null}}e.PlacementAtExtremities=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
