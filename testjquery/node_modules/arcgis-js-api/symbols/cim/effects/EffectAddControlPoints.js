/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports"],(function(e){"use strict";class t{static local(){return null===t.instance&&(t.instance=new t),t.instance}execute(e,t,n,i,o){return new s(e,t,n)}}t.instance=null;class s{constructor(e,t,s){this._inputGeometries=e,this._angleTolerance=void 0!==t.angleTolerance?t.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let e=this._inputGeometries.next();for(;e;){if("esriGeometryPolygon"===e.geometryType)this._isClosed=!0;else if("esriGeometryPolyline"===e.geometryType)this._isClosed=!1;else{if("esriGeometryEnvelope"!==e.geometryType){e=this._inputGeometries.next();continue}if(this._maxCosAngle)return e;this._isClosed=!0}for(;e.nextPath();)this._processPath(e);return e.reset(),e}return null}_processPath(e){if(e.nextPoint()){const t=e.x,s=e.y;let n=t,i=s,o=e.pathSize,l=0,r=0,a=0,c=0,h=0,u=0;this._isClosed&&++o;for(let _=1;e.nextPoint()||_<o;++_){let f,y;this._isClosed&&_===o-1?(f=t,y=s):(f=e.x,y=e.y);const g=f-n,m=y-i,x=Math.sqrt(g*g+m*m);if(_>1&&x>0&&a>0){(l*g+r*m)/x/a<=this._maxCosAngle&&e.setControlPointAt(_-1)}1===_&&(c=g,h=m,u=x),x>0&&(n=f,i=y,l=g,r=m,a=x)}if(this._isClosed&&a>0&&u>0){(l*c+r*h)/u/a<=this._maxCosAngle&&e.setControlPointAt(0)}}}}e.EffectAddControlPoints=t,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
