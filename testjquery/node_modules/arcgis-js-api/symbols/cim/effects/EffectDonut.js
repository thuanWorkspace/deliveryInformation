/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../geometry","../../../geometry/GeometryCursor","../CIMEffects","../enums","../../../geometry/SpatialReference"],(function(t,e,i,n,o,s){"use strict";class r{static local(){return null===r.instance&&(r.instance=new r),r.instance}execute(t,e,i,n,o,s){return new h(t,e,i,n,o,s)}}r.instance=null;class h{constructor(t,e,i,n,s,r){switch(this._inputGeometries=t,this._tileKey=n,this._geometryEngine=s,this._maxInflateSize=r*i,this._width=(void 0!==e.width?e.width:2)*i,e.method){case o.GeometricEffectDonutMethod.Mitered:case o.GeometricEffectDonutMethod.Bevelled:case o.GeometricEffectDonutMethod.Rounded:case o.GeometricEffectDonutMethod.TrueBuffer:case o.GeometricEffectDonutMethod.Square:}this._option=e.option}next(){let t;for(;t=this._inputGeometries.next();){if("esriGeometryEnvelope"===t.geometryType&&this._width>0){const e=t.asJSON();return Math.min(e.xmax-e.xmin,e.ymax-e.ymin)-2*this._width<0?t:i.GeometryCursor.fromJSONCIM({paths:[[[e.xmin+this._width,e.ymin+this._width],[e.xmax-this._width,e.ymin+this._width],[e.xmax-this._width,e.ymax-this._width],[e.xmin+this._width,e.ymax-this._width],[e.xmin+this._width,e.ymin+this._width]],[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]})}if("esriGeometryPolygon"===t.geometryType){if(0===this._width)return t.clone();const e=this._geometryEngine;if(null==e)return null;const i=this._tileKey?n.clipCursorToTileExtent(t,this._maxInflateSize):t.clone();if(!i)continue;const o=e.buffer(s.WebMercator,i.asJSON(),-this._width,1);if(o)for(const t of o.rings)t&&i.pushPath(t.reverse());return i}}return null}}t.EffectDonut=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}));
