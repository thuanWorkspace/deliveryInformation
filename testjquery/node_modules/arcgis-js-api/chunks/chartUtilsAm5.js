/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["require","exports","../intl","./Theme","./Tooltip","./DefaultTheme","../intl/locale"],(function(e,t,i,r,s,a,n){"use strict";class o{constructor(){Object.defineProperty(this,"_observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this._observer=new ResizeObserver((e=>{r.each(e,(e=>{r.each(this._targets,(t=>{t.target===e.target&&t.callback()}))}))}))}addTarget(e,t){this._observer.observe(e,{box:"border-box"}),this._targets.push({target:e,callback:t})}removeTarget(e){this._observer.unobserve(e),r.keepIf(this._targets,(t=>t.target!==e))}}class l{constructor(){Object.defineProperty(this,"_timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_targets",{enumerable:!0,configurable:!0,writable:!0,value:[]})}addTarget(e,t){if(null===this._timer){let e=null;const t=()=>{const i=Date.now();(null===e||i>e+l.delay)&&(e=i,r.each(this._targets,(e=>{let t=e.target.getBoundingClientRect();t.width===e.size.width&&t.height===e.size.height||(e.size=t,e.callback())}))),0===this._targets.length?this._timer=null:this._timer=requestAnimationFrame(t)};this._timer=requestAnimationFrame(t)}let i={width:0,height:0,left:0,right:0,top:0,bottom:0,x:0,y:0};this._targets.push({target:e,callback:t,size:i})}removeTarget(e){r.keepIf(this._targets,(t=>t.target!==e)),0===this._targets.length&&null!==this._timer&&(cancelAnimationFrame(this._timer),this._timer=null)}}Object.defineProperty(l,"delay",{enumerable:!0,configurable:!0,writable:!0,value:200});let h=null;function u(){return null===h&&(h="undefined"!=typeof ResizeObserver?new o:new l),h}class c{constructor(e,t){Object.defineProperty(this,"_sensor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_listener",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_disposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this._sensor=u(),this._element=e,this._listener=r.onZoom(t),this._sensor.addTarget(e,t)}isDisposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._sensor.removeTarget(this._element),this._listener.dispose())}get sensor(){return this._sensor}}class d extends r.Entity{}Object.defineProperty(d,"className",{enumerable:!0,configurable:!0,writable:!0,value:"InterfaceColors"}),Object.defineProperty(d,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:r.Entity.classNames.concat([d.className])});class b extends r.Entity{_setDefaults(){this._setDefault("negativeBase",0),this._setDefault("numberFormat","#,###.#####"),this._setDefault("smallNumberThreshold",1);const e="_big_number_suffix_",t="_small_number_suffix_",i="_byte_suffix_";this._setDefault("bigNumberPrefixes",[{number:1e3,suffix:this._t(e+"3")},{number:1e6,suffix:this._t(e+"6")},{number:1e9,suffix:this._t(e+"9")},{number:1e12,suffix:this._t(e+"12")},{number:1e15,suffix:this._t(e+"15")},{number:1e18,suffix:this._t(e+"18")},{number:1e21,suffix:this._t(e+"21")},{number:1e24,suffix:this._t(e+"24")}]),this._setDefault("smallNumberPrefixes",[{number:1e-24,suffix:this._t(t+"24")},{number:1e-21,suffix:this._t(t+"21")},{number:1e-18,suffix:this._t(t+"18")},{number:1e-15,suffix:this._t(t+"15")},{number:1e-12,suffix:this._t(t+"12")},{number:1e-9,suffix:this._t(t+"9")},{number:1e-6,suffix:this._t(t+"6")},{number:.001,suffix:this._t(t+"3")}]),this._setDefault("bytePrefixes",[{number:1,suffix:this._t(i+"B")},{number:1024,suffix:this._t(i+"KB")},{number:1048576,suffix:this._t(i+"MB")},{number:1073741824,suffix:this._t(i+"GB")},{number:1099511627776,suffix:this._t(i+"TB")},{number:0x4000000000000,suffix:this._t(i+"PB")}]),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t,i){let s;(null==t||r.isString(t)&&"number"===t.toLowerCase())&&(t=this.get("numberFormat",""));let a=Number(e);if(r.isObject(t))try{return this.get("intlLocales")?new Intl.NumberFormat(this.get("intlLocales"),t).format(a):new Intl.NumberFormat(void 0,t).format(a)}catch(n){return"Invalid"}else{t=r.cleanFormat(t);let e,n=this.parseFormat(t,this._root.language);e=a>this.get("negativeBase")?n.positive:a<this.get("negativeBase")?n.negative:n.zero,null==i||e.mod||(e=r.copy(e),e.decimals.active=0==a?0:i),s=e.template.split(r.PLACEHOLDER).join(this.applyFormat(a,e))}return!0===this.get("forceLTR")&&(s="‎"+s),s}parseFormat(e,t){const i=t.translateEmpty("_thousandSeparator"),s=t.translateEmpty("_decimalSeparator");let a={positive:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:s},template:"",source:"",parsed:!1},negative:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:s},template:"",source:"",parsed:!1},zero:{thousands:{active:-1,passive:-1,interval:-1,separator:i},decimals:{active:-1,passive:-1,separator:s},template:"",source:"",parsed:!1}},n=(e=e.replace("||",r.PLACEHOLDER2)).split("|");return a.positive.source=n[0],void 0===n[2]?a.zero=a.positive:a.zero.source=n[2],void 0===n[1]?a.negative=a.positive:a.negative.source=n[1],r.each$1(a,((e,t)=>{if(t.parsed)return;let i=t.source;"number"===i.toLowerCase()&&(i=this.get("numberFormat","#,###.#####"));let s=r.TextFormatter.chunk(i,!0);for(let a=0;a<s.length;a++){let e=s[a];if(e.text=e.text.replace(r.PLACEHOLDER2,"|"),"value"===e.type){let i=e.text.match(/[#0.,]+[ ]?[abespABESP%!]?[abespABESP‰!]?/);if(i)if(null===i||""===i[0])t.template+=e.text;else{let s=i[0].match(/[abespABESP%‰!]{2}|[abespABESP%‰]{1}$/);s&&(t.mod=s[0].toLowerCase(),t.modSpacing=!!i[0].match(/[ ]{1}[abespABESP%‰!]{1}$/));let a=i[0].split(".");if(""===a[0]);else{t.thousands.active=(a[0].match(/0/g)||[]).length,t.thousands.passive=(a[0].match(/\#/g)||[]).length+t.thousands.active;let e=a[0].split(",");1===e.length||(t.thousands.interval=(e.pop()||"").length,0===t.thousands.interval&&(t.thousands.interval=-1))}void 0===a[1]||(t.decimals.active=(a[1].match(/0/g)||[]).length,t.decimals.passive=(a[1].match(/\#/g)||[]).length+t.decimals.active),t.template+=e.text.split(i[0]).join(r.PLACEHOLDER)}}else t.template+=e.text}t.parsed=!0})),a}applyFormat(e,t){let i=e<0;e=Math.abs(e);let s="",a="",n=t.mod?t.mod.split(""):[];if(-1!==n.indexOf("b")){let i=this.applyPrefix(e,this.get("bytePrefixes"),-1!==n.indexOf("!"));e=i[0],s=i[1],a=i[2],t.modSpacing&&(a=" "+a)}else if(-1!==n.indexOf("a")){let i=this.applyPrefix(e,e<this.get("smallNumberThreshold")?this.get("smallNumberPrefixes"):this.get("bigNumberPrefixes"),-1!==n.indexOf("!"));e=i[0],s=i[1],a=i[2],t.modSpacing&&(a=" "+a)}else if(-1!==n.indexOf("p")){let t=Math.min(e.toString().length+2,21);e=parseFloat(e.toPrecision(t)),s=this._root.language.translate("_percentPrefix"),a=this._root.language.translate("_percentSuffix"),""==s&&""==a&&(a="%")}else if(-1!==n.indexOf("%")){let t=Math.min(e.toString().length+2,21);e*=100,e=parseFloat(e.toPrecision(t)),a="%"}else if(-1!==n.indexOf("‰")){let t=Math.min(e.toString().length+3,21);e*=1e3,e=parseFloat(e.toPrecision(t)),a="‰"}if(-1!==n.indexOf("e")){let i;i=t.decimals.passive>=0?e.toExponential(t.decimals.passive).split("e"):e.toExponential().split("e"),e=Number(i[0]),a="e"+i[1],t.modSpacing&&(a=" "+a)}else if(0===t.decimals.passive)e=Math.round(e);else if(t.decimals.passive>0){let i=Math.pow(10,t.decimals.passive);e=Math.round(e*i)/i}let o="",l=r.numberToString(e).split("."),h=l[0];if(h.length<t.thousands.active&&(h=Array(t.thousands.active-h.length+1).join("0")+h),t.thousands.interval>0){let e=[],i=h.split("").reverse().join("");for(let r=0,s=h.length;r<=s;r+=t.thousands.interval){let s=i.substr(r,t.thousands.interval).split("").reverse().join("");""!==s&&e.unshift(s)}h=e.join(t.thousands.separator)}o+=h,1===l.length&&l.push("");let u=l[1];return u.length<t.decimals.active&&(u+=Array(t.decimals.active-u.length+1).join("0")),""!==u&&(o+=t.decimals.separator+u),""===o&&(o="0"),0!==e&&i&&-1===n.indexOf("s")&&(o="-"+o),s&&(o=s+o),a&&(o+=a),o}applyPrefix(e,t,i=!1){let r=e,s="",a="",n=!1,o=1;for(let l=0,h=t.length;l<h;l++)t[l].number<=e&&(0===t[l].number?r=0:(r=e/t[l].number,o=t[l].number),s=t[l].prefix,a=t[l].suffix,n=!0);return!n&&i&&t.length&&0!=e&&(r=e/t[0].number,s=t[0].prefix,a=t[0].suffix,n=!0),n&&(r=parseFloat(r.toPrecision(Math.min(o.toString().length+Math.floor(r).toString().replace(/[^0-9]*/g,"").length,21)))),[r,s,a]}escape(e){return e.replace("||",r.PLACEHOLDER2)}unescape(e){return e.replace(r.PLACEHOLDER2,"|")}}function f(e,t){let i=0,r=0,s=1,a=0,n=0,o=0,l=0,h=0;return e.formatToParts(t).forEach((e=>{switch(e.type){case"year":i=+e.value;break;case"month":r=+e.value-1;break;case"day":s=+e.value;break;case"hour":a=+e.value;break;case"minute":n=+e.value;break;case"second":o=+e.value;break;case"fractionalSecond":l=+e.value;break;case"weekday":switch(e.value){case"Sun":h=0;break;case"Mon":h=1;break;case"Tue":h=2;break;case"Wed":h=3;break;case"Thu":h=4;break;case"Fri":h=5;break;case"Sat":h=6}}})),24===a&&(a=0),{year:i,month:r,day:s,hour:a,minute:n,second:o,millisecond:l,weekday:h}}function g(e,t){const{year:i,month:r,day:s,hour:a,minute:n,second:o,millisecond:l}=f(e,t);return Date.UTC(i,r,s,a,n,o,l)}class m{constructor(e,t){if(Object.defineProperty(this,"_utc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_dtf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!t)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");this.name=e,this._utc=new Intl.DateTimeFormat("UTC",{hour12:!1,timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3}),this._dtf=new Intl.DateTimeFormat("UTC",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",weekday:"short",fractionalSecondDigits:3})}static new(e){return new this(e,!0)}convertLocal(e){const t=this.offsetUTC(e),i=e.getTimezoneOffset(),r=new Date(e);r.setUTCMinutes(r.getUTCMinutes()-(t-i));const s=r.getTimezoneOffset();return i!=s&&r.setUTCMinutes(r.getUTCMinutes()+s-i),r}offsetUTC(e){return(g(this._utc,e)-g(this._dtf,e))/6e4}parseDate(e){return f(this._dtf,e)}}class p extends r.Entity{_setDefaults(){this._setDefault("capitalize",!0),this._setDefault("dateFormat","yyyy-MM-dd"),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t){let i;void 0!==t&&""!==t||(t=this.get("dateFormat","yyyy-MM-dd"));let s=e;if(r.isObject(t))try{const e=this.get("intlLocales");return e?new Intl.DateTimeFormat(e,t).format(s):new Intl.DateTimeFormat(void 0,t).format(s)}catch(o){return"Invalid"}let a=this.parseFormat(t);const n=this._root.timezone;return n&&!this._root.utc&&(s=n.convertLocal(s)),r.isNumber(s.getTime())?(i=this.applyFormat(s,a),this.get("capitalize")&&(i=i.replace(/^.{1}/,i.substr(0,1).toUpperCase())),i):"Invalid date"}applyFormat(e,t){let i,s,a,n,o,l,h,u,c=t.template,d=e.getTime();this._root.utc?(i=e.getUTCFullYear(),s=e.getUTCMonth(),a=e.getUTCDay(),n=e.getUTCDate(),o=e.getUTCHours(),l=e.getUTCMinutes(),h=e.getUTCSeconds(),u=e.getUTCMilliseconds()):(i=e.getFullYear(),s=e.getMonth(),a=e.getDay(),n=e.getDate(),o=e.getHours(),l=e.getMinutes(),h=e.getSeconds(),u=e.getMilliseconds());for(let b=0,f=t.parts.length;b<f;b++){let f="";switch(t.parts[b]){case"G":f=this._t(i<0?"_era_bc":"_era_ad");break;case"yyyy":f=Math.abs(i).toString(),i<0&&(f+=this._t("_era_bc"));break;case"yyy":case"yy":case"y":f=Math.abs(i).toString().substr(-t.parts[b].length),i<0&&(f+=this._t("_era_bc"));break;case"YYYY":case"YYY":case"YY":case"Y":let c=r.getWeekYear(e,this._root.utc);f="YYYY"==t.parts[b]?Math.abs(c).toString():Math.abs(c).toString().substr(-t.parts[b].length),c<0&&(f+=this._t("_era_bc"));break;case"u":case"F":case"g":break;case"q":f=""+Math.ceil((e.getMonth()+1)/3);break;case"MMMMM":f=this._t(this._getMonth(s)).substr(0,1);break;case"MMMM":f=this._t(this._getMonth(s));break;case"MMM":f=this._t(this._getShortMonth(s));break;case"MM":f=r.padString(s+1,2,"0");break;case"M":f=(s+1).toString();break;case"ww":f=r.padString(r.getWeek(e,this._root.utc),2,"0");break;case"w":f=r.getWeek(e,this._root.utc).toString();break;case"W":f=r.getMonthWeek(e,this._root.utc).toString();break;case"dd":f=r.padString(n,2,"0");break;case"d":f=n.toString();break;case"DD":case"DDD":f=r.padString(r.getYearDay(e,this._root.utc).toString(),t.parts[b].length,"0");break;case"D":f=r.getYearDay(e,this._root.utc).toString();break;case"t":f=this._root.language.translateFunc("_dateOrd").call(this,n);break;case"E":f=(a||7).toString();break;case"EE":f=r.padString((a||7).toString(),2,"0");break;case"EEE":case"eee":f=this._t(this._getShortWeekday(a));break;case"EEEE":case"eeee":f=this._t(this._getWeekday(a));break;case"EEEEE":case"eeeee":f=this._t(this._getShortWeekday(a)).substr(0,1);break;case"e":case"ee":f=(a-(this._root.locale.firstDayOfWeek||1)+1).toString(),"ee"==t.parts[b]&&(f=r.padString(f,2,"0"));break;case"a":f=o>=12?this._t("PM"):this._t("AM");break;case"aa":f=o>=12?this._t("P.M."):this._t("A.M.");break;case"aaa":f=o>=12?this._t("P"):this._t("A");break;case"h":f=r.get12Hours(o).toString();break;case"hh":f=r.padString(r.get12Hours(o),2,"0");break;case"H":f=o.toString();break;case"HH":f=r.padString(o,2,"0");break;case"K":f=r.get12Hours(o,0).toString();break;case"KK":f=r.padString(r.get12Hours(o,0),2,"0");break;case"k":f=(o+1).toString();break;case"kk":f=r.padString(o+1,2,"0");break;case"m":f=l.toString();break;case"mm":f=r.padString(l,2,"0");break;case"s":f=h.toString();break;case"ss":f=r.padString(h,2,"0");break;case"S":case"SS":case"SSS":f=Math.round(u/1e3*Math.pow(10,t.parts[b].length)).toString();break;case"x":f=d.toString();break;case"n":case"nn":case"nnn":f=r.padString(u,t.parts[b].length,"0");break;case"z":f=r.getTimeZone(e,!1,!1,this._root.utc,this._root.timezone?this._root.timezone.name:void 0);break;case"zz":f=r.getTimeZone(e,!0,!1,this._root.utc,this._root.timezone?this._root.timezone.name:void 0);break;case"zzz":f=r.getTimeZone(e,!1,!0,this._root.utc,this._root.timezone?this._root.timezone.name:void 0);break;case"zzzz":f=r.getTimeZone(e,!0,!0,this._root.utc,this._root.timezone?this._root.timezone.name:void 0);break;case"Z":case"ZZ":let g=this._root.utc?"UTC":this._root.timezone;g instanceof m&&(g=g.name);const p=g?r.getTimezoneOffset(g):e.getTimezoneOffset();let _=Math.abs(p)/60,y=Math.floor(_),v=60*_-60*y;this._root.utc&&(y=0,v=0),"Z"==t.parts[b]?(f="GMT",f+=p>0?"-":"+",f+=r.padString(y,2)+":"+r.padString(v,2)):(f=p>0?"-":"+",f+=r.padString(y,2)+r.padString(v,2));break;case"i":f=e.toISOString();break;case"I":f=e.toUTCString()}c=c.replace(r.PLACEHOLDER,f)}return c}parseFormat(e){let t={template:"",parts:[]},i=r.TextFormatter.chunk(e,!0);for(let s=0;s<i.length;s++){let e=i[s];if("value"===e.type){if(e.text.match(/^date$/i)){let t=this.get("dateFormat","yyyy-MM-dd");r.isString(t)||(t="yyyy-MM-dd"),e.text=t}let i=e.text.match(/G|yyyy|yyy|yy|y|YYYY|YYY|YY|Y|u|q|MMMMM|MMMM|MMM|MM|M|ww|w|W|dd|d|DDD|DD|D|F|g|EEEEE|EEEE|EEE|EE|E|eeeee|eeee|eee|ee|e|aaa|aa|a|hh|h|HH|H|KK|K|kk|k|mm|m|ss|s|SSS|SS|S|A|zzzz|zzz|zz|z|ZZ|Z|t|x|nnn|nn|n|i|I/g);if(i)for(let s=0;s<i.length;s++)t.parts.push(i[s]),e.text=e.text.replace(i[s],r.PLACEHOLDER)}t.template+=e.text}return t}_months(){return["January","February","March","April","May","June","July","August","September","October","November","December"]}_getMonth(e){return this._months()[e]}_shortMonths(){return["Jan","Feb","Mar","Apr","May(short)","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}_getShortMonth(e){return this._shortMonths()[e]}_weekdays(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}_getWeekday(e){return this._weekdays()[e]}_shortWeekdays(){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}_getShortWeekday(e){return this._shortWeekdays()[e]}parse(e,t){if(e instanceof Date)return e;if(r.isNumber(e))return new Date(e);let i;r.isString(e)||(e=e.toString());let s="";t=(t=r.cleanFormat(t)).substr(0,e.length);let a=this.parseFormat(t),n={year:-1,year3:-1,year2:-1,year1:-1,month:-1,monthShort:-1,monthLong:-1,weekdayShort:-1,weekdayLong:-1,day:-1,yearDay:-1,week:-1,hourBase0:-1,hour12Base0:-1,hourBase1:-1,hour12Base1:-1,minute:-1,second:-1,millisecond:-1,millisecondDigits:-1,am:-1,zone:-1,timestamp:-1,iso:-1},o={year:1970,month:0,day:1,hour:0,minute:0,second:0,millisecond:0,timestamp:null,offset:0,utc:this._root.utc},l=0,h=0;for(let r=0;r<a.parts.length;r++){switch(h=r+l+1,a.parts[r]){case"yyyy":case"YYYY":s+="([0-9]{4})",n.year=h;break;case"yyy":case"YYY":s+="([0-9]{3})",n.year3=h;break;case"yy":case"YY":s+="([0-9]{2})",n.year2=h;break;case"y":case"Y":s+="([0-9]{1})",n.year1=h;break;case"MMMM":s+="("+this.getStringList(this._months()).join("|")+")",n.monthLong=h;break;case"MMM":s+="("+this.getStringList(this._shortMonths()).join("|")+")",n.monthShort=h;break;case"MM":case"M":s+="([0-9]{2}|[0-9]{1})",n.month=h;break;case"ww":case"w":s+="([0-9]{2}|[0-9]{1})",n.week=h;break;case"dd":case"d":s+="([0-9]{2}|[0-9]{1})",n.day=h;break;case"DDD":case"DD":case"D":s+="([0-9]{3}|[0-9]{2}|[0-9]{1})",n.yearDay=h;break;case"dddd":s+="("+this.getStringList(this._weekdays()).join("|")+")",n.weekdayLong=h;break;case"ddd":s+="("+this.getStringList(this._shortWeekdays()).join("|")+")",n.weekdayShort=h;break;case"aaa":case"aa":case"a":s+="("+this.getStringList(["AM","PM","A.M.","P.M.","A","P"]).join("|")+")",n.am=h;break;case"hh":case"h":s+="([0-9]{2}|[0-9]{1})",n.hour12Base1=h;break;case"HH":case"H":s+="([0-9]{2}|[0-9]{1})",n.hourBase0=h;break;case"KK":case"K":s+="([0-9]{2}|[0-9]{1})",n.hour12Base0=h;break;case"kk":case"k":s+="([0-9]{2}|[0-9]{1})",n.hourBase1=h;break;case"mm":case"m":s+="([0-9]{2}|[0-9]{1})",n.minute=h;break;case"ss":case"s":s+="([0-9]{2}|[0-9]{1})",n.second=h;break;case"SSS":case"SS":case"S":s+="([0-9]{3}|[0-9]{2}|[0-9]{1})",n.millisecond=h,n.millisecondDigits=a.parts[r].length;break;case"nnn":case"nn":case"n":s+="([0-9]{3}|[0-9]{2}|[0-9]{1})",n.millisecond=h;break;case"x":s+="([0-9]{1,})",n.timestamp=h;break;case"Z":s+="GMT([-+]+[0-9]{2}:[0-9]{2})",n.zone=h;break;case"ZZ":s+="([\\-+]+[0-9]{2}[0-9]{2})",n.zone=h;break;case"i":s+="([0-9]{4})-?([0-9]{2})-?([0-9]{2})T?([0-9]{2}):?([0-9]{2}):?([0-9]{2})\\.?([0-9]{0,3})([zZ]|[+\\-][0-9]{2}:?[0-9]{2}|$)",n.iso=h,l+=7;break;case"G":case"YYYY":case"YYY":case"YY":case"Y":case"MMMMM":case"W":case"EEEEE":case"EEEE":case"EEE":case"EE":case"E":case"eeeee":case"eeee":case"eee":case"ee":case"e":case"zzzz":case"zzz":case"zz":case"z":case"t":l--}s+="[^0-9]*"}let u=new RegExp(s),c=e.match(u);if(c){if(n.year>-1&&(o.year=parseInt(c[n.year])),n.year3>-1){let e=parseInt(c[n.year3]);e+=1e3,o.year=e}if(n.year2>-1){let e=parseInt(c[n.year2]);e+=e>50?1e3:2e3,o.year=e}if(n.year1>-1){let e=parseInt(c[n.year1]);e=10*Math.floor((new Date).getFullYear()/10)+e,o.year=e}if(n.monthLong>-1&&(o.month=this.resolveMonth(c[n.monthLong])),n.monthShort>-1&&(o.month=this.resolveShortMonth(c[n.monthShort])),n.month>-1&&(o.month=parseInt(c[n.month])-1),n.week>-1&&-1===n.day&&(o.month=0,o.day=r.getDayFromWeek(parseInt(c[n.week]),o.year,1,this._root.utc)),n.day>-1&&(o.day=parseInt(c[n.day])),n.yearDay>-1&&(o.month=0,o.day=parseInt(c[n.yearDay])),n.hourBase0>-1&&(o.hour=parseInt(c[n.hourBase0])),n.hourBase1>-1&&(o.hour=parseInt(c[n.hourBase1])-1),n.hour12Base0>-1){let e=parseInt(c[n.hour12Base0]);11==e&&(e=0),n.am>-1&&!this.isAm(c[n.am])&&(e+=12),o.hour=e}if(n.hour12Base1>-1){let e=parseInt(c[n.hour12Base1]);12==e&&(e=0),n.am>-1&&!this.isAm(c[n.am])&&(e+=12),o.hour=e}if(n.minute>-1&&(o.minute=parseInt(c[n.minute])),n.second>-1&&(o.second=parseInt(c[n.second])),n.millisecond>-1){let e=parseInt(c[n.millisecond]);2==n.millisecondDigits?e*=10:1==n.millisecondDigits&&(e*=100),o.millisecond=e}if(n.timestamp>-1){o.timestamp=parseInt(c[n.timestamp]);const e=new Date(o.timestamp);o.year=e.getUTCFullYear(),o.month=e.getUTCMonth(),o.day=e.getUTCDate(),o.hour=e.getUTCHours(),o.minute=e.getUTCMinutes(),o.second=e.getUTCSeconds(),o.millisecond=e.getUTCMilliseconds()}n.zone>-1&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),c[n.zone])),n.iso>-1&&(o.year=r.toNumber(c[n.iso+0]),o.month=r.toNumber(c[n.iso+1])-1,o.day=r.toNumber(c[n.iso+2]),o.hour=r.toNumber(c[n.iso+3]),o.minute=r.toNumber(c[n.iso+4]),o.second=r.toNumber(c[n.iso+5]),o.millisecond=r.toNumber(c[n.iso+6]),"Z"==c[n.iso+7]||"z"==c[n.iso+7]?o.utc=!0:""!=c[n.iso+7]&&(o.offset=this.resolveTimezoneOffset(new Date(o.year,o.month,o.day),c[n.iso+7]))),i=o.utc?new Date(Date.UTC(o.year,o.month,o.day,o.hour,o.minute,o.second,o.millisecond)):new Date(o.year,o.month,o.day,o.hour,o.minute+o.offset,o.second,o.millisecond)}else i=new Date(e);return i}resolveTimezoneOffset(e,t){if(t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/)){let i=t.match(/([+\-]?)([0-9]{2}):?([0-9]{2})/),r=i[1],s=i[2],a=i[3],n=60*parseInt(s)+parseInt(a);return"+"==r&&(n*=-1),n-(e||new Date).getTimezoneOffset()}return 0}resolveMonth(e){let t=this._months().indexOf(e);return t>-1||!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._months()).indexOf(e),t>-1)?t:0}resolveShortMonth(e){let t=this._shortMonths().indexOf(e);return t>-1?t:(t=this._months().indexOf(e),t>-1||this._root.language&&!this._root.language.isDefault()&&(t=this._root.language.translateAll(this._shortMonths()).indexOf(e),t>-1)?t:0)}isAm(e){return this.getStringList(["AM","A.M.","A"]).indexOf(e.toUpperCase())>-1}getStringList(e){let t=[];for(let i=0;i<e.length;i++)this._root.language?t.push(r.escapeForRgex(this._t(e[i]))):t.push(r.escapeForRgex(e[i]));return t}}class _ extends r.Entity{constructor(){super(...arguments),Object.defineProperty(this,"_unitAliases",{enumerable:!0,configurable:!0,writable:!0,value:{Y:"y",D:"d",H:"h",K:"h",k:"h",n:"S"}})}_setDefaults(){const e="_duration_millisecond",t="_duration_second",i="_duration_minute",r="_duration_hour",s="_duration_day",a="_duration_week",n="_duration_month",o="_duration_year",l="_second",h="_minute",u="_hour",c="_day",d="_week",b="_week",f="_year";this._setDefault("negativeBase",0),this._setDefault("baseUnit","second"),this._setDefault("durationFormats",{millisecond:{millisecond:this._t(e),second:this._t(e+l),minute:this._t(e+h),hour:this._t(e+u),day:this._t(e+c),week:this._t(e+d),month:this._t(e+b),year:this._t(e+f)},second:{second:this._t(t),minute:this._t(t+h),hour:this._t(t+u),day:this._t(t+c),week:this._t(t+d),month:this._t(t+b),year:this._t(t+f)},minute:{minute:this._t(i),hour:this._t(i+u),day:this._t(i+c),week:this._t(i+d),month:this._t(i+b),year:this._t(i+f)},hour:{hour:this._t(r),day:this._t(r+c),week:this._t(r+d),month:this._t(r+b),year:this._t(r+f)},day:{day:this._t(s),week:this._t(s+d),month:this._t(s+b),year:this._t(s+f)},week:{week:this._t(a),month:this._t(a+b),year:this._t(a+f)},month:{month:this._t(n),year:this._t(n+f)},year:{year:this._t(o)}}),super._setDefaults()}_beforeChanged(){super._beforeChanged()}format(e,t,i){let s=i||this.get("baseUnit");void 0!==t&&""!==t||(t=null!=this.get("durationFormat")?this.get("durationFormat"):this.getFormat(r.toNumber(e),void 0,s)),t=r.cleanFormat(t);let a,n=this.parseFormat(t,s),o=Number(e);a=o>this.get("negativeBase")?n.positive:o<this.get("negativeBase")?n.negative:n.zero;let l=this.applyFormat(o,a);return""!==a.color&&(l="["+a.color+"]"+l+"[/]"),l}parseFormat(e,t){let i=t||this.get("baseUnit"),s={positive:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1},negative:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1},zero:{color:"",template:"",parts:[],source:"",baseUnit:i,parsed:!1,absolute:!1}},a=(e=e.replace("||",r.PLACEHOLDER2)).split("|");return s.positive.source=a[0],void 0===a[2]?s.zero=s.positive:s.zero.source=a[2],void 0===a[1]?s.negative=s.positive:s.negative.source=a[1],r.each$1(s,((e,t)=>{if(t.parsed)return;let i=t.source,s=[];s=t.source.match(/^\[([^\]]*)\]/),s&&s.length&&""!==s[0]&&(i=t.source.substr(s[0].length),t.color=s[1]);let a=r.TextFormatter.chunk(i,!0);for(let n=0;n<a.length;n++){let e=a[n];if(e.text=e.text.replace(r.PLACEHOLDER2,"|"),"value"===e.type){e.text.match(/[yYMdDwhHKkmsSn]+a/)&&(t.absolute=!0,e.text=e.text.replace(/([yYMdDwhHKkmsSn]+)a/,"$1"));let i=e.text.match(/y+|Y+|M+|d+|D+|w+|h+|H+|K+|k+|m+|s+|S+|n+/g);if(i)for(let s=0;s<i.length;s++)null==i[s]&&(i[s]=this._unitAliases[i[s]]),t.parts.push(i[s]),e.text=e.text.replace(i[s],r.PLACEHOLDER)}t.template+=e.text}t.parsed=!0})),s}applyFormat(e,t){let i=!t.absolute&&e<this.get("negativeBase");e=Math.abs(e);let s=this.toTimeStamp(e,t.baseUnit),a=t.template;for(let n=0,o=t.parts.length;n<o;n++){let e=t.parts[n],i=this._toTimeUnit(e.substr(0,1)),o=e.length,l=Math.floor(s/this._getUnitValue(i));a=a.replace(r.PLACEHOLDER,r.padString(l,o,"0")),s-=l*this._getUnitValue(i)}return i&&(a="-"+a),a}toTimeStamp(e,t){return e*this._getUnitValue(t)}_toTimeUnit(e){switch(e){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year"}}getFormat(e,t,i){if(null!=this.get("durationFormat"))return this.get("durationFormat");if(i||(i=this.get("baseUnit")),null!=t&&e!=t){e=Math.abs(e),t=Math.abs(t);let r=this.getValueUnit(Math.max(e,t),i);return this.get("durationFormats")[i][r]}{let t=this.getValueUnit(e,i);return this.get("durationFormats")[i][t]}}getValueUnit(e,t){let i;t||(t=this.get("baseUnit"));let s=this.getMilliseconds(e,t);return r.eachContinue(this._getUnitValues(),((e,r)=>{if(e==t||i){if(s/r<=1)return i||(i=e),!1;i=e}return!0})),i}getMilliseconds(e,t){return t||(t=this.get("baseUnit")),e*this._getUnitValue(t)}_getUnitValue(e){return this._getUnitValues()[e]}_getUnitValues(){return{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:2592e6,year:31536e6}}}const y={firstDayOfWeek:1,_decimalSeparator:".",_thousandSeparator:",",_percentPrefix:null,_percentSuffix:"%",_big_number_suffix_3:"k",_big_number_suffix_6:"M",_big_number_suffix_9:"G",_big_number_suffix_12:"T",_big_number_suffix_15:"P",_big_number_suffix_18:"E",_big_number_suffix_21:"Z",_big_number_suffix_24:"Y",_small_number_suffix_3:"m",_small_number_suffix_6:"μ",_small_number_suffix_9:"n",_small_number_suffix_12:"p",_small_number_suffix_15:"f",_small_number_suffix_18:"a",_small_number_suffix_21:"z",_small_number_suffix_24:"y",_byte_suffix_B:"B",_byte_suffix_KB:"KB",_byte_suffix_MB:"MB",_byte_suffix_GB:"GB",_byte_suffix_TB:"TB",_byte_suffix_PB:"PB",_date:"yyyy-MM-dd",_date_millisecond:"mm:ss SSS",_date_millisecond_full:"HH:mm:ss SSS",_date_second:"HH:mm:ss",_date_second_full:"HH:mm:ss",_date_minute:"HH:mm",_date_minute_full:"HH:mm - MMM dd, yyyy",_date_hour:"HH:mm",_date_hour_full:"HH:mm - MMM dd, yyyy",_date_day:"MMM dd",_date_day_full:"MMM dd, yyyy",_date_week:"ww",_date_week_full:"MMM dd, yyyy",_date_month:"MMM",_date_month_full:"MMM, yyyy",_date_year:"yyyy",_duration_millisecond:"SSS",_duration_millisecond_second:"ss.SSS",_duration_millisecond_minute:"mm:ss SSS",_duration_millisecond_hour:"hh:mm:ss SSS",_duration_millisecond_day:"d'd' mm:ss SSS",_duration_millisecond_week:"d'd' mm:ss SSS",_duration_millisecond_month:"M'm' dd'd' mm:ss SSS",_duration_millisecond_year:"y'y' MM'm' dd'd' mm:ss SSS",_duration_second:"ss",_duration_second_minute:"mm:ss",_duration_second_hour:"hh:mm:ss",_duration_second_day:"d'd' hh:mm:ss",_duration_second_week:"d'd' hh:mm:ss",_duration_second_month:"M'm' dd'd' hh:mm:ss",_duration_second_year:"y'y' MM'm' dd'd' hh:mm:ss",_duration_minute:"mm",_duration_minute_hour:"hh:mm",_duration_minute_day:"d'd' hh:mm",_duration_minute_week:"d'd' hh:mm",_duration_minute_month:"M'm' dd'd' hh:mm",_duration_minute_year:"y'y' MM'm' dd'd' hh:mm",_duration_hour:"hh'h'",_duration_hour_day:"d'd' hh'h'",_duration_hour_week:"d'd' hh'h'",_duration_hour_month:"M'm' dd'd' hh'h'",_duration_hour_year:"y'y' MM'm' dd'd' hh'h'",_duration_day:"d'd'",_duration_day_week:"d'd'",_duration_day_month:"M'm' dd'd'",_duration_day_year:"y'y' MM'm' dd'd'",_duration_week:"w'w'",_duration_week_month:"w'w'",_duration_week_year:"w'w'",_duration_month:"M'm'",_duration_month_year:"y'y' MM'm'",_duration_year:"y'y'",_era_ad:"AD",_era_bc:"BC",A:"",P:"",AM:"",PM:"","A.M.":"","P.M.":"",January:"",February:"",March:"",April:"",May:"",June:"",July:"",August:"",September:"",October:"",November:"",December:"",Jan:"",Feb:"",Mar:"",Apr:"","May(short)":"May",Jun:"",Jul:"",Aug:"",Sep:"",Oct:"",Nov:"",Dec:"",Sunday:"",Monday:"",Tuesday:"",Wednesday:"",Thursday:"",Friday:"",Saturday:"",Sun:"",Mon:"",Tue:"",Wed:"",Thu:"",Fri:"",Sat:"",_dateOrd:function(e){let t="th";if(e<11||e>13)switch(e%10){case 1:t="st";break;case 2:t="nd";break;case 3:t="rd"}return t},"Zoom Out":"",Play:"",Stop:"",Legend:"","Press ENTER to toggle":"",Loading:"",Home:"",Chart:"","Serial chart":"","X/Y chart":"","Pie chart":"","Gauge chart":"","Radar chart":"","Sankey diagram":"","Flow diagram":"","Chord diagram":"","TreeMap chart":"","Force directed tree":"","Sliced chart":"",Series:"","Candlestick Series":"","OHLC Series":"","Column Series":"","Line Series":"","Pie Slice Series":"","Funnel Series":"","Pyramid Series":"","X/Y Series":"",Map:"","Press ENTER to zoom in":"","Press ENTER to zoom out":"","Use arrow keys to zoom in and out":"","Use plus and minus keys on your keyboard to zoom in and out":"",Export:"",Image:"",Data:"",Print:"","Press ENTER or use arrow keys to navigate":"","Press ENTER to open":"","Press ENTER to print.":"","Press ENTER to export as %1.":"","(Press ESC to close this message)":"","Image Export Complete":"","Export operation took longer than expected. Something might have gone wrong.":"","Saved from":"",PNG:"",JPG:"",GIF:"",SVG:"",PDF:"",JSON:"",CSV:"",XLSX:"",HTML:"","Use TAB to select grip buttons or left and right arrows to change selection":"","Use left and right arrows to move selection":"","Use left and right arrows to move left selection":"","Use left and right arrows to move right selection":"","Use TAB select grip buttons or up and down arrows to change selection":"","Use up and down arrows to move selection":"","Use up and down arrows to move lower selection":"","Use up and down arrows to move upper selection":"","From %1 to %2":"","From %1":"","To %1":"","No parser available for file: %1":"","Error parsing file: %1":"","Unable to load file: %1":"","Invalid date":"",Close:"",Minimize:""};class v extends r.Entity{_setDefaults(){this.setPrivate("defaultLocale",y),super._setDefaults()}translate(e,t,...i){t||(t=this._root.locale||this.getPrivate("defaultLocale"));let r=e,s=t[e];if(null===s)r="";else if(null!=s)s&&(r=s);else if(t!==this.getPrivate("defaultLocale"))return this.translate(e,this.getPrivate("defaultLocale"),...i);if(i.length)for(let a=i.length,n=0;n<a;++n)r=r.split("%"+(n+1)).join(i[n]);return r}translateAny(e,t,...i){return this.translate(e,t,...i)}setTranslationAny(e,t,i){(i||this._root.locale)[e]=t}setTranslationsAny(e,t){r.each$1(e,((e,i)=>{this.setTranslationAny(e,i,t)}))}translateEmpty(e,t,...i){let r=this.translate(e,t,...i);return r==e?"":r}translateFunc(e,t){return this._root.locale[e]?this._root.locale[e]:t!==this.getPrivate("defaultLocale")?this.translateFunc(e,this.getPrivate("defaultLocale")):()=>""}translateAll(e,t){return this.isDefault()?e:r.map(e,(e=>this.translate(e,t)))}isDefault(){return this.getPrivate("defaultLocale")===this._root.locale}}class w{constructor(e=1,t=0,i=0,r=1,s=0,a=0){Object.defineProperty(this,"a",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"b",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"c",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"d",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.a=e,this.b=t,this.c=i,this.d=r,this.tx=s,this.ty=a}setTransform(e,t,i,r,s,a=1){this.a=Math.cos(s)*a,this.b=Math.sin(s)*a,this.c=-Math.sin(s)*a,this.d=Math.cos(s)*a,this.tx=e-(i*this.a+r*this.c),this.ty=t-(i*this.b+r*this.d)}apply(e){return{x:this.a*e.x+this.c*e.y+this.tx,y:this.b*e.x+this.d*e.y+this.ty}}applyInverse(e){const t=1/(this.a*this.d+this.c*-this.b);return{x:this.d*t*e.x+-this.c*t*e.y+(this.ty*this.c-this.tx*this.d)*t,y:this.a*t*e.y+-this.b*t*e.x+(-this.ty*this.a+this.tx*this.b)*t}}append(e){const t=this.a,i=this.b,r=this.c,s=this.d;this.a=e.a*t+e.b*r,this.b=e.a*i+e.b*s,this.c=e.c*t+e.d*r,this.d=e.c*i+e.d*s,this.tx=e.tx*t+e.ty*r+this.tx,this.ty=e.tx*i+e.ty*s+this.ty}prepend(e){const t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){const t=this.a,i=this.c;this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty}copyFrom(e){this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty}}var x=function(){function e(e,t){var i=[],r=!0,s=!1,a=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done)&&(i.push(n.value),!t||i.length!==t);r=!0);}catch(l){s=!0,a=l}finally{try{!r&&o.return&&o.return()}finally{if(s)throw a}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),P=2*Math.PI,O=function(e,t,i,r,s,a,n){var o=e.x,l=e.y;return{x:r*(o*=t)-s*(l*=i)+a,y:s*o+r*l+n}},k=function(e,t){var i=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:4/3*Math.tan(t/4),r=Math.cos(e),s=Math.sin(e),a=Math.cos(e+t),n=Math.sin(e+t);return[{x:r-s*i,y:s+r*i},{x:a+n*i,y:n-a*i},{x:a,y:n}]},S=function(e,t,i,r){var s=e*i+t*r;return s>1&&(s=1),s<-1&&(s=-1),(e*r-t*i<0?-1:1)*Math.acos(s)},E=function(e,t,i,r,s,a,n,o,l,h,u,c){var d=Math.pow(s,2),b=Math.pow(a,2),f=Math.pow(u,2),g=Math.pow(c,2),m=d*b-d*g-b*f;m<0&&(m=0),m/=d*g+b*f;var p=(m=Math.sqrt(m)*(n===o?-1:1))*s/a*c,_=m*-a/s*u,y=h*p-l*_+(e+i)/2,v=l*p+h*_+(t+r)/2,w=(u-p)/s,x=(c-_)/a,O=(-u-p)/s,k=(-c-_)/a,E=S(1,0,w,x),M=S(w,x,O,k);return 0===o&&M>0&&(M-=P),1===o&&M<0&&(M+=P),[y,v,E,M]},M=function(e){var t=e.px,i=e.py,r=e.cx,s=e.cy,a=e.rx,n=e.ry,o=e.xAxisRotation,l=void 0===o?0:o,h=e.largeArcFlag,u=void 0===h?0:h,c=e.sweepFlag,d=void 0===c?0:c,b=[];if(0===a||0===n)return[];var f=Math.sin(l*P/360),g=Math.cos(l*P/360),m=g*(t-r)/2+f*(i-s)/2,p=-f*(t-r)/2+g*(i-s)/2;if(0===m&&0===p)return[];a=Math.abs(a),n=Math.abs(n);var _=Math.pow(m,2)/Math.pow(a,2)+Math.pow(p,2)/Math.pow(n,2);_>1&&(a*=Math.sqrt(_),n*=Math.sqrt(_));var y=E(t,i,r,s,a,n,u,d,f,g,m,p),v=x(y,4),w=v[0],S=v[1],M=v[2],T=v[3],C=Math.abs(T)/(P/4);Math.abs(1-C)<1e-7&&(C=1);var j=Math.max(Math.ceil(C),1);T/=j;for(var B=0;B<j;B++)b.push(k(M,T)),M+=T;return b.map((function(e){var t=O(e[0],a,n,g,f,w,S),i=t.x,r=t.y,s=O(e[1],a,n,g,f,w,S),o=s.x,l=s.y,h=O(e[2],a,n,g,f,w,S);return{x1:i,y1:r,x2:o,y2:l,x:h.x,y:h.y}}))};function T(e,t,i){if(t!==i)throw new Error("Required "+i+" arguments for "+e+" but got "+t)}function C(e,t,i){if(t<i)throw new Error("Required at least "+i+" arguments for "+e+" but got "+t)}function j(e,t,i){if(C(e,t,i),t%i!=0)throw new Error("Arguments for "+e+" must be in pairs of "+i)}function B(e){for(let t=0;t<e.length;t+=7){let i=t+3,r=e[i];if(r.length>1){const t=/^([01])([01])(.*)$/.exec(r);null!==t&&(e.splice(i,0,t[1]),++i,e.splice(i,0,t[2]),++i,t[3].length>0?e[i]=t[3]:e.splice(i,1))}if(++i,r=e[i],r.length>1){const t=/^([01])(.+)$/.exec(r);null!==t&&(e.splice(i,0,t[1]),++i,e[i]=t[2])}}}function D(e){if(0===e||1===e)return e;throw new Error("Flag must be 0 or 1")}function L(e){const t=[0,0,0];for(let i=0;i<24;i++)t[i%3]<<=1,t[i%3]|=1&e,e>>=1;return(0|t[2])+(t[1]<<8)+(t[0]<<16)}function A(e,t){for(;(!e.interactive||t(e))&&e._parent;)e=e._parent}function z(e,t,i){return r.addEventListener(e,r.getRendererEvent(t),(e=>{const t=r.getEventTarget(e);let s=e.touches;s?(0==s.length&&(s=e.changedTouches),i(r.copy$1(s),t)):i([e],t)}))}function F(e){const t=document.createElement("canvas");t.width=1,t.height=1;const i=t.getContext("2d",{willReadFrequently:!0});i.drawImage(e,0,0,1,1);try{return i.getImageData(0,0,1,1),!1}catch(r){return console.warn('Image "'+e.src+'" is loaded from different host and is not covered by CORS policy. For more information about the implications read here: https://www.amcharts.com/docs/v5/concepts/cors'),!0}}function H(e){e.width=0,e.height=0,e.style.width="0px",e.style.height="0px"}class R{constructor(){Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0})}get x(){return this._x}get y(){return this._y}set x(e){this._x=e}set y(e){this._y=e}}class I extends r.DisposerClass{constructor(e){super(),Object.defineProperty(this,"_layer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mask",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"exportable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"interactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"inactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"wheelable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"cancelTouch",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isMeasured",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"buttonMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"alpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"compoundAlpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"angle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"scale",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"crisp",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"pivot",{enumerable:!0,configurable:!0,writable:!0,value:new R}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cursorOverStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_replacedCursorStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_localMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new w}),Object.defineProperty(this,"_matrix",{enumerable:!0,configurable:!0,writable:!0,value:new w}),Object.defineProperty(this,"_uMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new w}),Object.defineProperty(this,"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._renderer=e}_dispose(){this._renderer._removeObject(this),this.getLayer().dirty=!0}getCanvas(){return this.getLayer().view}getLayer(){let e=this;for(;;){if(e._layer)return e._layer;if(!e._parent)return this._renderer.defaultLayer;e=e._parent}}setLayer(e,t){if(null==e)this._layer=void 0;else{const i=!0;this._layer=this._renderer.getLayer(e,i),this._layer.visible=i,this._layer.margin=t,t&&r.setInteractive(this._layer.view,!1),this._renderer._ghostLayer.setMargin(this._renderer.layers),this._parent&&this._parent.registerChildLayer(this._layer),this._layer.dirty=!0,this._renderer.resizeLayer(this._layer),this._renderer.resizeGhost()}}markDirtyLayer(){this.getLayer().dirty=!0}clear(){this.invalidateBounds()}invalidateBounds(){this._localBounds=void 0}_addBounds(e){}_getColorId(){return void 0===this._colorId&&(this._colorId=this._renderer.paintId(this)),this._colorId}_isInteractive(){return 0==this.inactive&&(this.interactive||this._renderer._forceInteractive>0)}_isInteractiveMask(){return this._isInteractive()}contains(e){for(;;){if(e===this)return!0;if(!e._parent)return!1;e=e._parent}}toGlobal(e){return this._matrix.apply(e)}toLocal(e){return this._matrix.applyInverse(e)}getLocalMatrix(){return this._uMatrix.setTransform(0,0,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._uMatrix}getLocalBounds(){if(!this._localBounds){const e=1e7;this._localBounds={left:e,top:e,right:-e,bottom:-e},this._addBounds(this._localBounds)}return this._localBounds}getAdjustedBounds(e){this._setMatrix();const t=this.getLocalMatrix(),i=t.apply({x:e.left,y:e.top}),r=t.apply({x:e.right,y:e.top}),s=t.apply({x:e.right,y:e.bottom}),a=t.apply({x:e.left,y:e.bottom});return{left:Math.min(i.x,r.x,s.x,a.x),top:Math.min(i.y,r.y,s.y,a.y),right:Math.max(i.x,r.x,s.x,a.x),bottom:Math.max(i.y,r.y,s.y,a.y)}}on(e,t,i){return this.interactive?this._renderer._addEvent(this,e,t,i):new r.Disposer((()=>{}))}_setMatrix(){this._localMatrix.setTransform(this.x,this.y,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._matrix.copyFrom(this._localMatrix),this._parent&&this._matrix.prepend(this._parent._matrix)}_transform(e,t){const i=this._matrix;let r=i.tx*t,s=i.ty*t;this.crisp&&(r=Math.floor(r)+.5,s=Math.floor(s)+.5),e.setTransform(i.a*t,i.b*t,i.c*t,i.d*t,r,s)}_transformMargin(e,t,i){const r=this._matrix;e.setTransform(r.a*t,r.b*t,r.c*t,r.d*t,(r.tx+i.left)*t,(r.ty+i.top)*t)}_transformLayer(e,t,i){i.margin?this._transformMargin(e,i.scale||t,i.margin):this._transform(e,i.scale||t)}render(e){if(this.visible&&(!1!==this.exportable||!this._renderer._omitTainted)){this._setMatrix();const t=this._renderer.resolution,i=this._renderer.layers,s=this._renderer._ghostLayer,a=s.context,n=this.mask;n&&n._setMatrix(),r.each(i,(e=>{if(e){const i=e.context;i.save(),n&&(n._transformLayer(i,t,e),n._runPath(i),i.clip()),i.globalAlpha=this.compoundAlpha*this.alpha,this._transformLayer(i,t,e),this.filter&&(i.filter=this.filter)}})),a.save(),n&&this._isInteractiveMask()&&(n._transformMargin(a,t,s.margin),n._runPath(a),a.clip()),this._transformMargin(a,t,s.margin),this._render(e),a.restore(),r.each(i,(e=>{e&&e.context.restore()}))}}_render(e){if(!1===this.exportable){(this._layer||e).tainted=!0}}hovering(){return this._renderer._hovering.has(this)}dragging(){return this._renderer._dragging.some((e=>e.value===this))}shouldCancelTouch(){const e=this._renderer;return!(e.tapToActivate&&!e._touchActive)&&(!!this.cancelTouch||!!this._parent&&this._parent.shouldCancelTouch())}}class Y extends I{constructor(){super(...arguments),Object.defineProperty(this,"interactiveChildren",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_childLayers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_children",{enumerable:!0,configurable:!0,writable:!0,value:[]})}_isInteractiveMask(){return this.interactiveChildren||super._isInteractiveMask()}addChild(e){e._parent=this,this._children.push(e),e._layer&&this.registerChildLayer(e._layer)}addChildAt(e,t){e._parent=this,this._children.splice(t,0,e),e._layer&&this.registerChildLayer(e._layer)}removeChild(e){e._parent=void 0,r.removeFirst(this._children,e)}_render(e){super._render(e);const t=this._renderer;this.interactive&&this.interactiveChildren&&++t._forceInteractive;const i=this._layer||e;r.each(this._children,(e=>{e.compoundAlpha=this.compoundAlpha*this.alpha,e.render(i)})),this.interactive&&this.interactiveChildren&&--t._forceInteractive}registerChildLayer(e){this._childLayers||(this._childLayers=[]),r.pushOne(this._childLayers,e),this._parent&&this._parent.registerChildLayer(e)}markDirtyLayer(e=!1){super.markDirtyLayer(),e&&this._childLayers&&r.each(this._childLayers,(e=>e.dirty=!0))}_dispose(){super._dispose(),this._childLayers&&r.each(this._childLayers,(e=>{e.dirty=!0}))}}function W(e,t){e.left=Math.min(e.left,t.x),e.top=Math.min(e.top,t.y),e.right=Math.max(e.right,t.x),e.bottom=Math.max(e.bottom,t.y)}class U{colorize(e,t){}path(e){}addBounds(e){}}class N extends U{colorize(e,t){e.beginPath()}}class V extends U{constructor(e){super(),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.fillStyle=void 0!==t?t:this.color}}class G extends U{constructor(e){super(),Object.defineProperty(this,"clearShadow",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.fill(),this.clearShadow&&(e.shadowColor="",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0)}}class X extends U{colorize(e,t){e.stroke()}}class q extends U{constructor(e,t,i){super(),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"lineJoin",{enumerable:!0,configurable:!0,writable:!0,value:i})}colorize(e,t){e.strokeStyle=void 0!==t?t:this.color,e.lineWidth=this.width,this.lineJoin&&(e.lineJoin=this.lineJoin)}}class Z extends U{constructor(e){super(),Object.defineProperty(this,"dash",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.setLineDash(this.dash)}}class K extends U{constructor(e){super(),Object.defineProperty(this,"dashOffset",{enumerable:!0,configurable:!0,writable:!0,value:e})}colorize(e,t){e.lineDashOffset=this.dashOffset}}class J extends U{constructor(e,t,i,r){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:r})}path(e){e.rect(this.x,this.y,this.width,this.height)}addBounds(e){const t=this.x,i=this.y,r=t+this.width,s=i+this.height;W(e,{x:t,y:i}),W(e,{x:r,y:i}),W(e,{x:t,y:s}),W(e,{x:r,y:s})}}class $ extends U{constructor(e,t,i){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:i})}path(e){e.moveTo(this.x+this.radius,this.y),e.arc(this.x,this.y,this.radius,0,2*Math.PI)}addBounds(e){W(e,{x:this.x-this.radius,y:this.y-this.radius}),W(e,{x:this.x+this.radius,y:this.y+this.radius})}}class Q extends U{constructor(e,t,i,r){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radiusX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"radiusY",{enumerable:!0,configurable:!0,writable:!0,value:r})}path(e){e.ellipse(0,0,this.radiusX,this.radiusY,0,0,2*Math.PI)}addBounds(e){W(e,{x:this.x-this.radiusX,y:this.y-this.radiusY}),W(e,{x:this.x+this.radiusX,y:this.y+this.radiusY})}}class ee extends U{constructor(e,t,i,r,s,a){super(),Object.defineProperty(this,"cx",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cy",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"endAngle",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"anticlockwise",{enumerable:!0,configurable:!0,writable:!0,value:a})}path(e){this.radius>0&&e.arc(this.cx,this.cy,this.radius,this.startAngle,this.endAngle,this.anticlockwise)}addBounds(e){let t=r.getArcBounds(this.cx,this.cy,this.startAngle*r.DEGREES,this.endAngle*r.DEGREES,this.radius);W(e,{x:t.left,y:t.top}),W(e,{x:t.right,y:t.bottom})}}class te extends U{constructor(e,t,i,r,s){super(),Object.defineProperty(this,"x1",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y1",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"x2",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"y2",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:s})}path(e){this.radius>0&&e.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)}addBounds(e){}}class ie extends U{constructor(e,t){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t})}path(e){e.lineTo(this.x,this.y)}addBounds(e){W(e,{x:this.x,y:this.y})}}class re extends U{constructor(e,t){super(),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:t})}path(e){e.moveTo(this.x,this.y)}addBounds(e){W(e,{x:this.x,y:this.y})}}class se extends U{path(e){e.closePath()}}class ae extends U{constructor(e,t,i,r,s,a){super(),Object.defineProperty(this,"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cpY",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"cpX2",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"cpY2",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"toX",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"toY",{enumerable:!0,configurable:!0,writable:!0,value:a})}path(e){e.bezierCurveTo(this.cpX,this.cpY,this.cpX2,this.cpY2,this.toX,this.toY)}addBounds(e){W(e,{x:this.cpX,y:this.cpY}),W(e,{x:this.cpX2,y:this.cpY2}),W(e,{x:this.toX,y:this.toY})}}class ne extends U{constructor(e,t,i,r){super(),Object.defineProperty(this,"cpX",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"cpY",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"toX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"toY",{enumerable:!0,configurable:!0,writable:!0,value:r})}path(e){e.quadraticCurveTo(this.cpX,this.cpY,this.toX,this.toY)}addBounds(e){W(e,{x:this.cpX,y:this.cpY}),W(e,{x:this.toX,y:this.toY})}}class oe extends U{constructor(e,t,i,r,s){super(),Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"blur",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"offsetX",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"offsetY",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"opacity",{enumerable:!0,configurable:!0,writable:!0,value:s})}colorize(e,t){this.opacity&&(e.fillStyle=this.color),e.shadowColor=this.color,e.shadowBlur=this.blur,e.shadowOffsetX=this.offsetX,e.shadowOffsetY=this.offsetY}}class le extends U{constructor(e,t,i,r,s){super(),Object.defineProperty(this,"image",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,writable:!0,value:s})}path(e){e.drawImage(this.image,this.x,this.y,this.width,this.height)}addBounds(e){W(e,{x:this.x,y:this.y}),W(e,{x:this.width,y:this.height})}}class he extends I{constructor(){super(...arguments),Object.defineProperty(this,"_operations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"blendMode",{enumerable:!0,configurable:!0,writable:!0,value:r.BlendMode.NORMAL}),Object.defineProperty(this,"_hasShadows",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_fillAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}clear(){super.clear(),this._operations.length=0}_pushOp(e){this._operations.push(e)}beginFill(e,t=1){this._fillAlpha=t,e?e instanceof r.Color?this._pushOp(new V(e.toCSS(t))):(this.isMeasured=!0,this._pushOp(new V(e))):this._pushOp(new V("rgba(0, 0, 0, "+t+")"))}endFill(){this._pushOp(new G(this._hasShadows))}endStroke(){this._pushOp(new X)}beginPath(){this._pushOp(new N)}lineStyle(e=0,t,i=1,s){this._strokeAlpha=i,t?t instanceof r.Color?this._pushOp(new q(e,t.toCSS(i),s)):this._pushOp(new q(e,t,s)):this._pushOp(new q(e,"rgba(0, 0, 0, "+i+")",s))}setLineDash(e){this._pushOp(new Z(e||[]))}setLineDashOffset(e=0){this._pushOp(new K(e))}drawRect(e,t,i,r){this._pushOp(new J(e,t,i,r))}drawCircle(e,t,i){this._pushOp(new $(e,t,i))}drawEllipse(e,t,i,r){this._pushOp(new Q(e,t,i,r))}arc(e,t,i,r,s,a=!1){this._pushOp(new ee(e,t,i,r,s,a))}arcTo(e,t,i,r,s){this._pushOp(new te(e,t,i,r,s))}lineTo(e,t){this._pushOp(new ie(e,t))}moveTo(e,t){this._pushOp(new re(e,t))}bezierCurveTo(e,t,i,r,s,a){this._pushOp(new ae(e,t,i,r,s,a))}quadraticCurveTo(e,t,i,r){this._pushOp(new ne(e,t,i,r))}closePath(){this._pushOp(new se)}shadow(e,t=0,i=0,r=0,s){this._hasShadows=!0,this._pushOp(new oe(s?e.toCSS(s):e.toCSS(this._fillAlpha||this._strokeAlpha),t,i,r))}image(e,t,i,r,s){this._pushOp(new le(e,t,i,r,s))}svgPath(e){let t=0,i=0,s=null,a=null,n=null,o=null;const l=/([MmZzLlHhVvCcSsQqTtAa])([^MmZzLlHhVvCcSsQqTtAa]*)/g,h=/[\u0009\u0020\u000A\u000C\u000D]*([\+\-]?[0-9]*\.?[0-9]+(?:[eE][\+\-]?[0-9]+)?)[\u0009\u0020\u000A\u000C\u000D]*,?/g;let u;for(;null!==(u=l.exec(e));){const e=u[1],l=u[2],c=[];for(;null!==(u=h.exec(l));)c.push(u[1]);switch("S"!==e&&"s"!==e&&"C"!==e&&"c"!==e&&(s=null,a=null),"Q"!==e&&"q"!==e&&"T"!==e&&"t"!==e&&(n=null,o=null),e){case"M":j(e,c.length,2),t=+c[0],i=+c[1],this.moveTo(t,i);for(let e=2;e<c.length;e+=2)t=+c[e],i=+c[e+1],this.lineTo(t,i);break;case"m":j(e,c.length,2),t+=+c[0],i+=+c[1],this.moveTo(t,i);for(let e=2;e<c.length;e+=2)t+=+c[e],i+=+c[e+1],this.lineTo(t,i);break;case"L":j(e,c.length,2);for(let e=0;e<c.length;e+=2)t=+c[e],i=+c[e+1],this.lineTo(t,i);break;case"l":j(e,c.length,2);for(let e=0;e<c.length;e+=2)t+=+c[e],i+=+c[e+1],this.lineTo(t,i);break;case"H":C(e,c.length,1);for(let e=0;e<c.length;++e)t=+c[e],this.lineTo(t,i);break;case"h":C(e,c.length,1);for(let e=0;e<c.length;++e)t+=+c[e],this.lineTo(t,i);break;case"V":C(e,c.length,1);for(let e=0;e<c.length;++e)i=+c[e],this.lineTo(t,i);break;case"v":C(e,c.length,1);for(let e=0;e<c.length;++e)i+=+c[e],this.lineTo(t,i);break;case"C":j(e,c.length,6);for(let e=0;e<c.length;e+=6){const r=+c[e],n=+c[e+1];s=+c[e+2],a=+c[e+3],t=+c[e+4],i=+c[e+5],this.bezierCurveTo(r,n,s,a,t,i)}break;case"c":j(e,c.length,6);for(let e=0;e<c.length;e+=6){const r=+c[e]+t,n=+c[e+1]+i;s=+c[e+2]+t,a=+c[e+3]+i,t+=+c[e+4],i+=+c[e+5],this.bezierCurveTo(r,n,s,a,t,i)}break;case"S":j(e,c.length,4),null!==s&&null!==a||(s=t,a=i);for(let e=0;e<c.length;e+=4){const r=2*t-s,n=2*i-a;s=+c[e],a=+c[e+1],t=+c[e+2],i=+c[e+3],this.bezierCurveTo(r,n,s,a,t,i)}break;case"s":j(e,c.length,4),null!==s&&null!==a||(s=t,a=i);for(let e=0;e<c.length;e+=4){const r=2*t-s,n=2*i-a;s=+c[e]+t,a=+c[e+1]+i,t+=+c[e+2],i+=+c[e+3],this.bezierCurveTo(r,n,s,a,t,i)}break;case"Q":j(e,c.length,4);for(let e=0;e<c.length;e+=4)n=+c[e],o=+c[e+1],t=+c[e+2],i=+c[e+3],this.quadraticCurveTo(n,o,t,i);break;case"q":j(e,c.length,4);for(let e=0;e<c.length;e+=4)n=+c[e]+t,o=+c[e+1]+i,t+=+c[e+2],i+=+c[e+3],this.quadraticCurveTo(n,o,t,i);break;case"T":j(e,c.length,2),null!==n&&null!==o||(n=t,o=i);for(let e=0;e<c.length;e+=2)n=2*t-n,o=2*i-o,t=+c[e],i=+c[e+1],this.quadraticCurveTo(n,o,t,i);break;case"t":j(e,c.length,2),null!==n&&null!==o||(n=t,o=i);for(let e=0;e<c.length;e+=2)n=2*t-n,o=2*i-o,t+=+c[e],i+=+c[e+1],this.quadraticCurveTo(n,o,t,i);break;case"A":case"a":const l="a"===e;B(c),j(e,c.length,7);for(let e=0;e<c.length;e+=7){let s=+c[e+5],a=+c[e+6];l&&(s+=t,a+=i);const n=M({px:t,py:i,rx:+c[e],ry:+c[e+1],xAxisRotation:+c[e+2],largeArcFlag:D(+c[e+3]),sweepFlag:D(+c[e+4]),cx:s,cy:a});r.each(n,(e=>{this.bezierCurveTo(e.x1,e.y1,e.x2,e.y2,e.x,e.y),t=e.x,i=e.y}))}break;case"Z":case"z":T(e,c.length,0),this.closePath()}}}_runPath(e){e.beginPath(),r.each(this._operations,(t=>{t.path(e)}))}_render(e){super._render(e);const t=this._layer||e,i=t.dirty,s=this._isInteractive();if(i||s){const e=t.context,a=this._renderer._ghostLayer.context;let n;i&&(e.globalCompositeOperation=this.blendMode,e.beginPath()),s&&(a.beginPath(),n=this._getColorId()),r.each(this._operations,(t=>{i&&(t.path(e),t.colorize(e,void 0)),s&&(t.path(a),t.colorize(a,n))}))}}renderDetached(e){if(this.visible){this._setMatrix(),e.save();const t=this.mask;t&&(t._setMatrix(),t._transform(e,1),t._runPath(e),e.clip()),e.globalAlpha=this.compoundAlpha*this.alpha,this._transform(e,1),this.filter&&(e.filter=this.filter),e.globalCompositeOperation=this.blendMode,e.beginPath(),r.each(this._operations,(t=>{t.path(e),t.colorize(e,void 0)})),e.restore()}}_addBounds(e){this.visible&&this.isMeasured&&r.each(this._operations,(t=>{t.addBounds(e)}))}}class ue extends I{constructor(e,t,i){super(e),Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"style",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resolution",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"textVisible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_textInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:1}),this.text=t,this.style=i}invalidateBounds(){super.invalidateBounds(),this._textInfo=void 0}_shared(e){this.style.textAlign&&(e.textAlign=this.style.textAlign),this.style.direction&&(e.direction=this.style.direction),this.style.textBaseline&&(e.textBaseline=this.style.textBaseline)}_prerender(e,t=!1,i=!1){super._render(e);const s=e.context,a=this._renderer._ghostLayer.context,n=this.style;let o=this._getFontStyle(void 0,i);s.font=o,this._isInteractive()&&!t&&(a.font=o),n.fill&&(n.fill instanceof r.Color?s.fillStyle=n.fill.toCSS(null!=n.fillOpacity?n.fillOpacity:1):s.fillStyle=n.fill),n.shadowColor&&(e.context.shadowColor=n.shadowColor.toCSS(n.shadowOpacity||1)),n.shadowBlur&&(e.context.shadowBlur=n.shadowBlur),n.shadowOffsetX&&(e.context.shadowOffsetX=n.shadowOffsetX),n.shadowOffsetY&&(e.context.shadowOffsetY=n.shadowOffsetY),this._shared(s),this._isInteractive()&&!t&&(a.fillStyle=this._getColorId(),this._shared(a))}_getFontStyle(e,t=!1){const i=this.style;let s=[];return e&&e.fontVariant?s.push(e.fontVariant):i.fontVariant&&s.push(i.fontVariant),t||(e&&e.fontWeight?s.push(e.fontWeight):i.fontWeight&&s.push(i.fontWeight)),e&&e.fontStyle?s.push(e.fontStyle):i.fontStyle&&s.push(i.fontStyle),e&&e.fontSize?(r.isNumber(e.fontSize)&&(e.fontSize=e.fontSize+"px"),s.push(e.fontSize)):i.fontSize&&(r.isNumber(i.fontSize)&&(i.fontSize=i.fontSize+"px"),s.push(i.fontSize)),e&&e.fontFamily?s.push(e.fontFamily):i.fontFamily?s.push(i.fontFamily):s.length&&s.push("Arial"),s.join(" ")}_render(e){const t=this._layer||e;if(this._textInfo||this._measure(t),this.textVisible){const e=this._isInteractive(),i=t.context,s=t.dirty,a=this._renderer._ghostLayer.context;i.save(),a.save(),this._prerender(t),r.each(this._textInfo,((t,n)=>{r.each(t.textChunks,((n,o)=>{if(n.style&&(i.save(),a.save(),i.font=n.style,this._isInteractive()&&(a.font=n.style)),n.fill&&(i.save(),i.fillStyle=n.fill.toCSS()),s&&i.fillText(n.text,n.offsetX,t.offsetY+n.offsetY),"underline"==n.textDecoration||"line-through"==n.textDecoration){let e,s=1,a=1,o=n.height,l=n.offsetX;switch(this.style.textAlign){case"right":case"end":l-=n.width;break;case"center":l-=n.width/2}if(n.style){switch(r.TextFormatter.getTextStyle(n.style).fontWeight){case"bolder":case"bold":case"700":case"800":case"900":s=2}}o&&(a=o/20),e="line-through"==n.textDecoration?s+t.offsetY+n.offsetY-n.height/2:s+1.5*a+t.offsetY+n.offsetY,i.save(),i.beginPath(),n.fill?i.strokeStyle=n.fill.toCSS():this.style.fill&&this.style.fill instanceof r.Color&&(i.strokeStyle=this.style.fill.toCSS()),i.lineWidth=s*a,i.moveTo(l,e),i.lineTo(l+n.width,e),i.stroke(),i.restore()}e&&this.interactive&&a.fillText(n.text,n.offsetX,t.offsetY+n.offsetY),n.fill&&i.restore(),n.style&&(i.restore(),a.restore())}))})),i.restore(),a.restore()}}_addBounds(e){if(this.visible&&this.isMeasured){const t=this._measure(this.getLayer());W(e,{x:t.left,y:t.top}),W(e,{x:t.right,y:t.bottom})}}_ignoreFontWeight(){return/apple/i.test(navigator.vendor)}_measure(e){const t=e.context,i=this._renderer._ghostLayer.context,s="rtl"==this.style.direction;this._textInfo=[];const a=this.style.oversizedBehavior,n=this.style.maxWidth,o=r.isNumber(n)&&"truncate"==a,l=r.isNumber(n)&&("wrap"==a||"wrap-no-break"==a);t.save(),i.save(),this._prerender(e,!0,this._ignoreFontWeight());const h="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",u=this.text.toString().replace(/\r/g,"").split(/\n/);let c,d=!0,b=0,f=0,g=0;r.each(u,((e,s)=>{let a;for(a=""==e?[{type:"value",text:""}]:r.TextFormatter.chunk(e,!1,this.style.ignoreFormatting);a.length>0;){let e={offsetY:g,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]};const s=this._measureText(h,t),u=s.actualBoundingBoxAscent+s.actualBoundingBoxDescent;let m;e.height=u,e.ascent=s.actualBoundingBoxAscent;let p,_,y,v=this.style.textDecoration,w=!1,x=!0,P=[];r.eachContinue$1(a,((s,u)=>{if("format"==s.type)if("[/]"==s.text)d||(t.restore(),i.restore(),d=!0),p=void 0,c=void 0,_=void 0,v=this.style.textDecoration,y=void 0,m=s.text;else{d||(t.restore(),i.restore());let a=r.TextFormatter.getTextStyle(s.text);const n=this._getFontStyle(a);t.save(),i.save(),t.font=n,c=n,m=s.text,a.textDecoration&&(v=a.textDecoration),a.fill&&(p=a.fill),a.width&&(_=r.toNumber(a.width)),a.verticalAlign&&(y=a.verticalAlign),d=!1;const o=this._measureText(h,t),l=o.actualBoundingBoxAscent+o.actualBoundingBoxDescent;l>e.height&&(e.height=l),o.actualBoundingBoxAscent>e.ascent&&(e.ascent=o.actualBoundingBoxAscent)}else if("value"==s.type&&!w){const i=this._measureText(s.text,t);let h=i.actualBoundingBoxLeft+i.actualBoundingBoxRight;if(o){let i=x||this.style.breakWords||!1;const r=this.style.ellipsis||"",a=this._measureText(r,t),o=a.actualBoundingBoxLeft+a.actualBoundingBoxRight;if(e.width+h>n){const a=n-e.width-o;s.text=this._truncateText(t,s.text,a,i),s.text+=r,w=!0}}else if(l&&e.width+h>n){const i=n-e.width,o=this._truncateText(t,s.text,i,!1,x&&"wrap-no-break"!=this.style.oversizedBehavior);if(""==o)return this.textVisible=!0,!1;P=a.slice(u+1),r.trim(o)!=r.trim(s.text)&&(P.unshift({type:"value",text:s.text.substr(o.length)}),m&&P.unshift({type:"format",text:m})),s.text=r.trim(o),a=[],w=!0}let d=1,b=1;if(c&&_&&_>h){const e=h/_;switch(this.style.textAlign){case"right":case"end":d=e;break;case"center":d=e,b=e;break;default:b=e}h=_}const f=i.actualBoundingBoxAscent+i.actualBoundingBoxDescent;f>e.height&&(e.height=f),i.actualBoundingBoxAscent>e.ascent&&(e.ascent=i.actualBoundingBoxAscent),e.width+=h,e.left+=i.actualBoundingBoxLeft/d,e.right+=i.actualBoundingBoxRight/b,e.textChunks.push({style:c,fill:p,text:s.text,width:h,height:f,left:i.actualBoundingBoxLeft,right:i.actualBoundingBoxRight,ascent:i.actualBoundingBoxAscent,offsetX:0,offsetY:0,textDecoration:v,verticalAlign:y}),x=!1}return!0})),this.style.lineHeight instanceof r.Percent?(e.height*=this.style.lineHeight.value,e.ascent*=this.style.lineHeight.value):(e.height*=this.style.lineHeight||1.2,e.ascent*=this.style.lineHeight||1.2),b<e.left&&(b=e.left),f<e.right&&(f=e.right),this._textInfo.push(e),g+=e.height,a=P||[]}})),d||(t.restore(),i.restore()),r.each(this._textInfo,((e,t)=>{let i=0;r.each(e.textChunks,(t=>{if(t.offsetX=i+t.left-e.left,t.offsetY+=e.height-e.height*(this.style.baselineRatio||.19),i+=t.width,t.verticalAlign)switch(t.verticalAlign){case"super":t.offsetY-=e.height/2-t.height/2;break;case"sub":t.offsetY+=t.height/2}}))}));const m={left:s?-f:-b,top:0,right:s?b:f,bottom:g};if("none"!==a){const e=this._fitRatio(m);if(e<1)if("fit"==a)r.isNumber(this.style.minScale)&&e<this.style.minScale?(this.textVisible=!1,m.left=0,m.top=0,m.right=0,m.bottom=0):(this._originalScale&&1!=this._originalScale||(this._originalScale=this.scale),this.scale=e,this.textVisible=!0);else if("hide"==a)this.textVisible=!1,m.left=0,m.top=0,m.right=0,m.bottom=0;else{switch(this.style.textAlign){case"right":case"end":m.left=-n,m.right=0;break;case"center":m.left=-n/2,m.right=n/2;break;default:m.left=0,m.right=n}this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}else this.scale=this._originalScale||1,this._originalScale=void 0,this.textVisible=!0}return t.restore(),i.restore(),m}_fitRatio(e){const t=this.style.maxWidth,i=this.style.maxHeight;if(!r.isNumber(t)&&!r.isNumber(i))return 1;const s=e.right-e.left,a=e.bottom-e.top;return Math.min(t/s||1,i/a||1)}_truncateText(e,t,i,r=!1,s=!0){let a;do{if(r)t=t.slice(0,-1);else{let e=t.replace(/[^,;:!?\\\/\s​]+[,;:!?\\\/\s​]*$/g,"");if(""!=e&&e!==t||!s){if(""==e)return t;t=e}else r=!0}const i=this._measureText(t,e);a=i.actualBoundingBoxLeft+i.actualBoundingBoxRight}while(a>i&&""!=t);return t}_measureText(e,t){let i=t.measureText(e),r={};if(null==i.actualBoundingBoxAscent){const t=document.createElement("div");t.innerText=e,t.style.visibility="hidden",t.style.position="absolute",t.style.top="-1000000px;",t.style.fontFamily=this.style.fontFamily||"",t.style.fontSize=this.style.fontSize+"",document.body.appendChild(t);const s=t.getBoundingClientRect();document.body.removeChild(t);const a=s.height,n=i.width;r={actualBoundingBoxAscent:a,actualBoundingBoxDescent:0,actualBoundingBoxLeft:0,actualBoundingBoxRight:n,fontBoundingBoxAscent:a,fontBoundingBoxDescent:0,width:n}}else r={actualBoundingBoxAscent:i.actualBoundingBoxAscent,actualBoundingBoxDescent:i.actualBoundingBoxDescent,actualBoundingBoxLeft:i.actualBoundingBoxLeft,actualBoundingBoxRight:i.actualBoundingBoxRight,fontBoundingBoxAscent:i.actualBoundingBoxAscent,fontBoundingBoxDescent:i.actualBoundingBoxDescent,width:i.width};const s=i.width;switch(this.style.textAlign){case"right":case"end":r.actualBoundingBoxLeft=s,r.actualBoundingBoxRight=0;break;case"center":r.actualBoundingBoxLeft=s/2,r.actualBoundingBoxRight=s/2;break;default:r.actualBoundingBoxLeft=0,r.actualBoundingBoxRight=s}return r}}class ce{constructor(){Object.defineProperty(this,"fill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fillOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textAlign",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontFamily",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontWeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontVariant",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textDecoration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lineHeight",{enumerable:!0,configurable:!0,writable:!0,value:r.percent(120)}),Object.defineProperty(this,"baselineRatio",{enumerable:!0,configurable:!0,writable:!0,value:.19}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textBaseline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oversizedBehavior",{enumerable:!0,configurable:!0,writable:!0,value:"none"}),Object.defineProperty(this,"breakWords",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ellipsis",{enumerable:!0,configurable:!0,writable:!0,value:"…"}),Object.defineProperty(this,"maxWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"minScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreFormatting",{enumerable:!0,configurable:!0,writable:!0,value:!1})}}class de extends ue{constructor(){super(...arguments),Object.defineProperty(this,"textType",{enumerable:!0,configurable:!0,writable:!0,value:"circular"}),Object.defineProperty(this,"radius",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inside",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"orientation",{enumerable:!0,configurable:!0,writable:!0,value:"auto"}),Object.defineProperty(this,"kerning",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_textReversed",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_render(e){if("circular"===this.textType)this._renderCircular(e);else super._render(e)}_renderCircular(e){if(this.textVisible){const t=this._layer||e;this._prerender(t);const i=this._isInteractive(),s=t.context,a=t.dirty,n=this._renderer._ghostLayer.context;s.save(),i&&n.save(),this._textInfo||this._measure(t);let o=this.radius||0,l=this.startAngle||0,h=0,u=this.orientation,c="auto"==u?"auto":"inward"==u;const d=this.inside,b=this.style.textAlign||"left",f=this.kerning||0;let g="left"==b?1:-1;const m=!this._textReversed;if("auto"==c){let e=0,t=0;r.each(this._textInfo,((t,i)=>{const r=l+t.width/(o-t.height)/2*-g;r>e&&(e=r)})),t="left"==b?(e+h/2)*r.DEGREES:"right"==b?(e-h/2)*r.DEGREES:l*r.DEGREES,t=r.normalizeAngle(t),c=t>=270||t<=90}1==c&&m&&(this._textInfo.reverse(),this._textReversed=!0),r.each(this._textInfo,((e,t)=>{const u=e.height;d||(o+=u),(-1==g&&c||1==g&&!c)&&m&&e.textChunks.reverse();let p=l;h=0,"center"==b&&(p+=e.width/(o-u)/2*-g,h=p-l),p+=Math.PI*(c?0:1),s.save(),i&&n.save(),s.rotate(p),i&&n.rotate(p);let _=0;r.each(e.textChunks,((e,t)=>{const r=e.text,l=e.width;_=l/2/(o-u)*g,s.rotate(_),i&&n.rotate(_),e.style&&(s.save(),n.save(),s.font=e.style,i&&(n.font=e.style)),e.fill&&(s.save(),s.fillStyle=e.fill.toCSS()),s.textBaseline="middle",s.textAlign="center",i&&(n.textBaseline="middle",n.textAlign="center"),a&&s.fillText(r,0,(c?1:-1)*(0-o+u/2)),i&&n.fillText(r,0,(c?1:-1)*(0-o+u/2)),e.fill&&s.restore(),e.style&&(s.restore(),n.restore()),_=(l/2+f)/(o-u)*g,s.rotate(_),i&&n.rotate(_)})),s.restore(),i&&n.restore(),d&&(o-=u)})),s.restore(),i&&n.restore()}}_measure(e){return"circular"===this.textType?this._measureCircular(e):super._measure(e)}_measureCircular(e){const t=e.context,i=this._renderer._ghostLayer.context,s="rtl"==this.style.direction,a=this.style.oversizedBehavior,n=this.style.maxWidth,o=r.isNumber(n)&&"truncate"==a,l=this.style.ellipsis||"";let h;this.textVisible=!0,this._textInfo=[],this._textReversed=!1,t.save(),i.save(),this._prerender(e,!0);const u=this.text.toString().replace(/\r/g,"").split(/\n/);let c=!0,d=0,b=0;return r.each(u,((e,a)=>{let u,f,g,m=r.TextFormatter.chunk(e,!1,this.style.ignoreFormatting),p={offsetY:b,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]};r.each(m,((e,a)=>{if("format"==e.type){if("[/]"==e.text)c||(t.restore(),i.restore(),c=!0),f=void 0,u=void 0,g=void 0;else{let s=r.TextFormatter.getTextStyle(e.text);const a=this._getFontStyle(s);t.save(),i.save(),t.font=a,u=a,s.fill&&(f=s.fill),s.width&&(g=r.toNumber(s.width)),c=!1}o&&(h=this._measureText(l,t))}else if("value"==e.type){const i=e.text.match(/./gu)||[];s&&i.reverse();for(let e=0;e<i.length;e++){const r=i[e],a=this._measureText(r,t);let c=a.width;u&&g&&g>c&&(c=g);const b=a.actualBoundingBoxAscent+a.actualBoundingBoxDescent;if(b>p.height&&(p.height=b),a.actualBoundingBoxAscent>p.ascent&&(p.ascent=a.actualBoundingBoxAscent),p.width+=c,p.left+=a.actualBoundingBoxLeft,p.right+=a.actualBoundingBoxRight,p.textChunks.push({style:u,fill:f,text:r,width:c,height:b+a.actualBoundingBoxDescent,left:a.actualBoundingBoxLeft,right:a.actualBoundingBoxRight,ascent:a.actualBoundingBoxAscent,offsetX:0,offsetY:b,textDecoration:void 0}),d+=c,o){h||(h=this._measureText(l,t));const e=h.actualBoundingBoxLeft+h.actualBoundingBoxRight;if(d+=e,d+e>n){1==p.textChunks.length?this.textVisible=!1:(p.width+=e,p.left+=h.actualBoundingBoxLeft,p.right+=h.actualBoundingBoxRight,p.textChunks.push({style:u,fill:f,text:l,width:e,height:b+h.actualBoundingBoxDescent,left:h.actualBoundingBoxLeft,right:h.actualBoundingBoxRight,ascent:h.actualBoundingBoxAscent,offsetX:0,offsetY:b,textDecoration:void 0}));break}}if(s)break}}})),this.style.lineHeight instanceof r.Percent?p.height*=this.style.lineHeight.value:p.height*=this.style.lineHeight||1.2,this._textInfo.push(p),b+=p.height})),c||(t.restore(),i.restore()),"hide"==a&&d>n&&(this.textVisible=!1),r.each(this._textInfo,(e=>{r.each(e.textChunks,(t=>{t.offsetY+=Math.round((e.height-t.height+(e.ascent-t.ascent))/2)}))})),t.restore(),i.restore(),{left:0,top:0,right:0,bottom:0}}}class be extends I{constructor(e,t){super(e),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"image",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tainted",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_imageMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.image=t}_dispose(){super._dispose(),this._imageMask&&H(this._imageMask)}getLocalBounds(){if(!this._localBounds){let e=0,t=0;this.width&&(e=this.width),this.height&&(t=this.height),this._localBounds={left:0,top:0,right:e,bottom:t},this._addBounds(this._localBounds)}return this._localBounds}_render(e){if(super._render(e),this.image){const t=this._layer||e;if(void 0===this.tainted&&(this.tainted=F(this.image),t.tainted=!0),this.tainted&&this._renderer._omitTainted)return;if(t.dirty){this.shadowColor&&(t.context.shadowColor=this.shadowColor.toCSS(this.shadowOpacity||1)),this.shadowBlur&&(t.context.shadowBlur=this.shadowBlur),this.shadowOffsetX&&(t.context.shadowOffsetX=this.shadowOffsetX),this.shadowOffsetY&&(t.context.shadowOffsetY=this.shadowOffsetY);const e=this.width||this.image.naturalWidth,i=this.height||this.image.naturalHeight;t.context.drawImage(this.image,0,0,e,i)}if(this.interactive&&this._isInteractive()){const e=this._getMask(this.image);this._renderer._ghostLayer.context.drawImage(e,0,0)}}}clear(){super.clear(),this.image=void 0,this._imageMask=void 0}_getMask(e){if(void 0===this._imageMask){const t=this.width||e.naturalWidth,i=this.height||e.naturalHeight,r=document.createElement("canvas");r.width=t,r.height=i;const s=r.getContext("2d");s.imageSmoothingEnabled=!1,s.fillStyle=this._getColorId(),s.fillRect(0,0,t,i),F(e)||(s.globalCompositeOperation="destination-in",s.drawImage(e,0,0,t,i)),this._imageMask=r}return this._imageMask}}class fe{constructor(e,t,i,s){Object.defineProperty(this,"event",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"originalPoint",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"point",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"bbox",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"simulated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"native",{enumerable:!0,configurable:!0,writable:!0,value:!0}),r.supports("touchevents")&&e instanceof Touch?this.id=e.identifier:this.id=null}}class ge extends r.ArrayDisposer{constructor(e){if(super(),Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(this,"_layerDom",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(this,"layers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_dirtyLayers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"defaultLayer",{enumerable:!0,configurable:!0,writable:!0,value:this.getLayer(0)}),Object.defineProperty(this,"_ghostLayer",{enumerable:!0,configurable:!0,writable:!0,value:new me}),Object.defineProperty(this,"_patternCanvas",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("canvas")}),Object.defineProperty(this,"_patternContext",{enumerable:!0,configurable:!0,writable:!0,value:this._patternCanvas.getContext("2d")}),Object.defineProperty(this,"_realWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_realHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_calculatedWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_calculatedHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"resolution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interactionsEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_events",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_colorMap",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_forceInteractive",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_omitTainted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_hovering",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"_dragging",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_mousedown",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_lastPointerMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tapToActivate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"tapToActivateTimeout",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"_touchActive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_touchActiveTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.resolution=e??window.devicePixelRatio,this.view.style.position="absolute",this.view.setAttribute("aria-hidden","true"),this.view.appendChild(this._layerDom),this._disposers.push(new r.Disposer((()=>{r.each$1(this._events,((e,t)=>{t.disposer.dispose()})),r.each(this.layers,(e=>{H(e.view),e.exportableView&&H(e.exportableView)})),H(this._ghostLayer.view),H(this._patternCanvas)}))),this._disposers.push(r.onZoom((()=>{null==e&&(this.resolution=window.devicePixelRatio)}))),r.supports("touchevents")){const e=e=>{0!==this._dragging.length&&r.eachContinue$1(this._dragging,(t=>!t.value.shouldCancelTouch()||(e.preventDefault(),!1))),this._touchActiveTimeout&&this._delayTouchDeactivate()};this._disposers.push(r.addEventListener(window,"touchstart",e,{passive:!1})),this._disposers.push(r.addEventListener(this.view,"touchstart",e,{passive:!1})),this._disposers.push(r.addEventListener(this.view,"touchmove",(()=>{this._touchActiveTimeout&&this._delayTouchDeactivate()}),{passive:!0})),this._disposers.push(r.addEventListener(window,"click",(e=>{this._touchActive=!1}),{passive:!0})),this._disposers.push(r.addEventListener(this.view,"click",(e=>{window.setTimeout((()=>{this._touchActive=!0,this._delayTouchDeactivate()}),100)}),{passive:!0}))}r.supports("wheelevents")&&this._disposers.push(r.addEventListener(this.view,"wheel",(e=>{let t=!1;this._hovering.forEach((e=>{if(e.wheelable)return t=!0,!1})),t&&e.preventDefault()}),{passive:!1}))}_delayTouchDeactivate(){this._touchActiveTimeout&&clearTimeout(this._touchActiveTimeout),this.tapToActivateTimeout>0&&(this._touchActiveTimeout=window.setTimeout((()=>{this._touchActive=!1}),this.tapToActivateTimeout))}get debugGhostView(){return!!this._ghostLayer.view.parentNode}set debugGhostView(e){e?this._ghostLayer.view.parentNode||this.view.appendChild(this._ghostLayer.view):this._ghostLayer.view.parentNode&&this._ghostLayer.view.parentNode.removeChild(this._ghostLayer.view)}createLinearGradient(e,t,i,r){return this.defaultLayer.context.createLinearGradient(e,t,i,r)}createRadialGradient(e,t,i,r,s,a){return this.defaultLayer.context.createRadialGradient(e,t,i,r,s,a)}createPattern(e,t,i,r,s){return this._patternCanvas.width=r,this._patternCanvas.height=s,this._patternContext.clearRect(0,0,r,s),t.renderDetached(this._patternContext),e.renderDetached(this._patternContext),this._patternContext.createPattern(this._patternCanvas,i)}makeContainer(){return new Y(this)}makeGraphics(){return new he(this)}makeText(e,t){return new ue(this,e,t)}makeTextStyle(){return new ce}makeRadialText(e,t){return new de(this,e,t)}makePicture(e){return new be(this,e)}resizeLayer(e){e.resize(this._calculatedWidth,this._calculatedHeight,this._calculatedWidth,this._calculatedHeight,this.resolution)}resizeGhost(){this._ghostLayer.resize(this._calculatedWidth,this._calculatedHeight,this._calculatedWidth,this._calculatedHeight,this.resolution)}resize(e,t,i,s){this._realWidth=e,this._realHeight=t,this._calculatedWidth=i,this._calculatedHeight=s,r.each(this.layers,(e=>{e&&(e.dirty=!0,this.resizeLayer(e))})),this.resizeGhost(),this.view.style.width=i+"px",this.view.style.height=s+"px"}createDetachedLayer(e=!1){const t=document.createElement("canvas"),i=t.getContext("2d",{willReadFrequently:e}),r=new pe(t,i);return t.style.position="absolute",t.style.top="0px",t.style.left="0px",r}getLayerByOrder(e){const t=this.layers,i=t.length;for(let r=0;r<i;r++){const i=t[r];if(i.order==e)return i}}getLayer(e,t=!0){let i=this.getLayerByOrder(e);if(i)return i;const s=this.createDetachedLayer(99==e);s.order=e,s.visible=t,s.visible&&this.resizeLayer(s);const a=this.layers;a.push(s),a.sort(((e,t)=>e.order>t.order?1:e.order<t.order?-1:0));const n=a.length;let o;for(let l=r.indexOf(a,s)+1;l<n;l++)if(a[l].visible){o=a[l];break}return s.visible&&(void 0===o?this._layerDom.appendChild(s.view):this._layerDom.insertBefore(s.view,o.view)),s}render(e){if(this._dirtyLayers.length=0,r.each(this.layers,(e=>{e&&e.dirty&&e.visible&&(this._dirtyLayers.push(e),e.clear())})),this._ghostLayer.clear(),e.render(this.defaultLayer),this._ghostLayer.context.restore(),r.each(this.layers,(e=>{if(e){const t=e.context;t.beginPath(),t.moveTo(0,0),t.stroke()}})),r.each(this._dirtyLayers,(e=>{e.context.restore(),e.dirty=!1})),this._hovering.size&&this._lastPointerMoveEvent){const{events:e,target:t,native:i}=this._lastPointerMoveEvent;r.each(e,(e=>{this._dispatchGlobalMousemove(e,t,i)}))}}paintId(e){const t=L(++this._colorId),i=r.Color.fromHex(t).toCSS();return this._colorMap[i]=e,i}_removeObject(e){void 0!==e._colorId&&delete this._colorMap[e._colorId]}_adjustBoundingBox(e){const t=this._ghostLayer.margin;return new DOMRect(-t.left,-t.top,e.width+t.left+t.right,e.height+t.top+t.bottom)}getEvent(e,t=!0){const i=this.view.getBoundingClientRect(),r=e.clientX||0,s=e.clientY||0,a=this._calculatedWidth/this._realWidth,n=this._calculatedHeight/this._realHeight,o={x:r-i.left,y:s-i.top},l={x:(r-(t?i.left:0))*a,y:(s-(t?i.top:0))*n};return new fe(e,o,l,this._adjustBoundingBox(i))}_getHitTarget(e,t,i){if(0===t.width||0===t.height||e.x<t.left||e.x>t.right||e.y<t.top||e.y>t.bottom)return;if(!i||!this._layerDom.contains(i))return;const s=this._ghostLayer.getImageData(e,t);if(0===s.data[0]&&0===s.data[1]&&0===s.data[2])return!1;const a=r.Color.fromRGB(s.data[0],s.data[1],s.data[2]).toCSS();return this._colorMap[a]}_withEvents(e,t){const i=this._events[e];if(void 0!==i){i.dispatching=!0;try{t(i)}finally{i.dispatching=!1,i.cleanup&&(i.cleanup=!1,r.keepIf(i.callbacks,(e=>!e.disposed)),0===i.callbacks.length&&(i.disposer.dispose(),delete this._events[e]))}}}_dispatchEventAll(e,t){this.interactionsEnabled&&this._withEvents(e,(e=>{r.each(e.callbacks,(e=>{e.disposed||e.callback.call(e.context,t)}))}))}_dispatchEvent(e,t,i){if(!this.interactionsEnabled)return!1;let s=!1;return this._withEvents(e,(e=>{r.each(e.callbacks,(e=>{e.disposed||e.object!==t||(e.callback.call(e.context,i),s=!0)}))})),s}_dispatchMousedown(e,t){const i=e.button;if(0!=i&&2!=i&&1!=i&&void 0!==i)return;const r=this.getEvent(e),s=this._getHitTarget(r.originalPoint,r.bbox,t);if(s){const e=r.id;let t=!1;A(s,(i=>{const s={id:e,value:i};if(this._mousedown.push(s),!t&&this._dispatchEvent("pointerdown",i,r)){t=!0;this._dragging.some((t=>t.value===i&&t.id===e))||this._dragging.push(s)}return!0}))}}_dispatchGlobalMousemove(e,t,i){const s=this.getEvent(e),a=this._getHitTarget(s.originalPoint,s.bbox,t);s.native=i,a?(this._hovering.forEach((e=>{e.contains(a)||(this._hovering.delete(e),e.cursorOverStyle&&r.setStyle(document.body,"cursor",e._replacedCursorStyle),this._dispatchEvent("pointerout",e,s))})),s.native&&A(a,(e=>(this._hovering.has(e)||(this._hovering.add(e),e.cursorOverStyle&&(e._replacedCursorStyle=r.getStyle(document.body,"cursor"),r.setStyle(document.body,"cursor",e.cursorOverStyle)),this._dispatchEvent("pointerover",e,s)),!0)))):(this._hovering.forEach((e=>{e.cursorOverStyle&&r.setStyle(document.body,"cursor",e._replacedCursorStyle),this._dispatchEvent("pointerout",e,s)})),this._hovering.clear()),this._dispatchEventAll("globalpointermove",s)}_dispatchGlobalMouseup(e,t){const i=this.getEvent(e);i.native=t,this._dispatchEventAll("globalpointerup",i)}_dispatchDragMove(e){if(0!==this._dragging.length){const t=this.getEvent(e),i=t.id;this._dragging.forEach((e=>{e.id===i&&this._dispatchEvent("pointermove",e.value,t)}))}}_dispatchDragEnd(e,t){const i=e.button;let r;if(0==i||void 0===i)r="click";else if(2==i)r="rightclick";else{if(1!=i)return;r="middleclick"}const s=this.getEvent(e),a=s.id;if(0!==this._mousedown.length){const e=this._getHitTarget(s.originalPoint,s.bbox,t);e&&this._mousedown.forEach((t=>{t.id===a&&t.value.contains(e)&&this._dispatchEvent(r,t.value,s)})),this._mousedown.length=0}0!==this._dragging.length&&(this._dragging.forEach((e=>{e.id===a&&this._dispatchEvent("pointerup",e.value,s)})),this._dragging.length=0)}_dispatchDoubleClick(e,t){const i=this.getEvent(e),r=this._getHitTarget(i.originalPoint,i.bbox,t);r&&A(r,(e=>!this._dispatchEvent("dblclick",e,i)))}_dispatchWheel(e,t){const i=this.getEvent(e),r=this._getHitTarget(i.originalPoint,i.bbox,t);r&&A(r,(e=>!this._dispatchEvent("wheel",e,i)))}_makeSharedEvent(e,t){if(void 0===this._listeners[e]){const i=t();this._listeners[e]=new r.CounterDisposer((()=>{delete this._listeners[e],i.dispose()}))}return this._listeners[e].increment()}_onPointerEvent(e,t){let i=!1,s=null;function a(){s=null,i=!1}return new r.MultiDisposer([new r.Disposer((()=>{null!==s&&clearTimeout(s),a()})),r.addEventListener(this.view,r.getRendererEvent(e),(e=>{i=!0,null!==s&&clearTimeout(s),s=window.setTimeout(a,0)})),z(window,e,((e,r)=>{null!==s&&(clearTimeout(s),s=null),t(e,r,i),i=!1}))])}_initEvent(e){switch(e){case"globalpointermove":case"pointerover":case"pointerout":return this._makeSharedEvent("pointermove",(()=>{const e=(e,t,i)=>{this._lastPointerMoveEvent={events:e,target:t,native:i},r.each(e,(e=>{this._dispatchGlobalMousemove(e,t,i)}))};return new r.MultiDisposer([this._onPointerEvent("pointerdown",e),this._onPointerEvent("pointermove",e)])}));case"globalpointerup":return this._makeSharedEvent("pointerup",(()=>{const e=this._onPointerEvent("pointerup",((e,t,i)=>{r.each(e,(e=>{this._dispatchGlobalMouseup(e,i)})),this._lastPointerMoveEvent={events:e,target:t,native:i}})),t=this._onPointerEvent("pointercancel",((e,t,i)=>{r.each(e,(e=>{this._dispatchGlobalMouseup(e,i)})),this._lastPointerMoveEvent={events:e,target:t,native:i}}));return new r.Disposer((()=>{e.dispose(),t.dispose()}))}));case"click":case"rightclick":case"middleclick":case"pointerdown":case"pointermove":case"pointerup":return this._makeSharedEvent("pointerdown",(()=>{const e=this._onPointerEvent("pointerdown",((e,t)=>{r.each(e,(e=>{this._dispatchMousedown(e,t)}))})),t=this._onPointerEvent("pointermove",(e=>{r.each(e,(e=>{this._dispatchDragMove(e)}))})),i=this._onPointerEvent("pointerup",((e,t)=>{r.each(e,(e=>{this._dispatchDragEnd(e,t)}))})),s=this._onPointerEvent("pointercancel",((e,t)=>{r.each(e,(e=>{this._dispatchDragEnd(e,t)}))}));return new r.Disposer((()=>{e.dispose(),t.dispose(),i.dispose(),s.dispose()}))}));case"dblclick":return this._makeSharedEvent("dblclick",(()=>this._onPointerEvent("dblclick",((e,t)=>{r.each(e,(e=>{this._dispatchDoubleClick(e,t)}))}))));case"wheel":return this._makeSharedEvent("wheel",(()=>r.addEventListener(window,r.getRendererEvent("wheel"),(e=>{this._dispatchWheel(e,r.getEventTarget(e))}),{passive:!1})))}}_addEvent(e,t,i,s){let a=this._events[t];void 0===a&&(a=this._events[t]={disposer:this._initEvent(t),callbacks:[],dispatching:!1,cleanup:!1});const n={object:e,context:s,callback:i,disposed:!1};return a.callbacks.push(n),new r.Disposer((()=>{n.disposed=!0,a.dispatching?a.cleanup=!0:(r.removeFirst(a.callbacks,n),0===a.callbacks.length&&(a.disposer.dispose(),delete this._events[t]))}))}getCanvas(e,t){this.render(e),t||(t={});let i=this.resolution,s=Math.floor(this._calculatedWidth*this.resolution),a=Math.floor(this._calculatedHeight*this.resolution);if(t.minWidth&&t.minWidth>s){let e=t.minWidth/s;e>i&&(i=e*this.resolution)}if(t.minHeight&&t.minHeight>a){let e=t.minHeight/a;e>i&&(i=e*this.resolution)}if(t.maxWidth&&t.maxWidth<s){let e=t.maxWidth/s;e<i&&(i=e*this.resolution)}if(t.maxHeight&&t.maxHeight>a){let e=t.maxHeight/a;e<i&&(i=e*this.resolution)}t.maintainPixelRatio&&(i/=this.resolution);const n=[];let o=!1;const l=document.createElement("canvas");i!=this.resolution&&(o=!0,s=s*i/this.resolution,a=a*i/this.resolution),l.width=s,l.height=a,l.style.position="fixed",l.style.top="-10000px",this.view.appendChild(l),n.push(l);const h=l.getContext("2d");let u=0,c=0,d=!1;return r.each(this.layers,(e=>{if(e&&e.visible&&(e.tainted||o)){d=!0,e.exportableView=e.view,e.exportableContext=e.context,e.view=document.createElement("canvas"),e.view.style.position="fixed",e.view.style.top="-10000px",this.view.appendChild(e.view),n.push(e.view);let t=0,r=0;e.margin&&(t+=e.margin.left||0+e.margin.right||0,r+=e.margin.top||0+e.margin.bottom||0),e.view.width=s+t,e.view.height=a+r,e.context=e.view.getContext("2d"),e.dirty=!0,e.scale=i}})),d&&(this._omitTainted=!0,this.render(e),this._omitTainted=!1),r.each(this.layers,(e=>{if(e&&e.visible){let t=0,i=0;e.margin&&(t=-(e.margin.left||0)*this.resolution,i=-(e.margin.top||0)*this.resolution),h.drawImage(e.view,t,i),e.exportableView&&(e.view=e.exportableView,e.exportableView=void 0),e.exportableContext&&(e.context=e.exportableContext,e.exportableContext=void 0),u<e.view.clientWidth&&(u=e.view.clientWidth),c<e.view.clientHeight&&(c=e.view.clientHeight),e.scale=void 0}})),l.style.width=u+"px",l.style.height=c+"px",r.each(n,(e=>{e.style.position="",e.style.top="",this.view.removeChild(e)})),l}}class me{constructor(){Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.view=document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.context.imageSmoothingEnabled=!1,this.view.style.position="absolute",this.view.style.top="0px",this.view.style.left="0px"}resize(e,t,i,r,s){e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,r+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px",this._width=Math.floor(e*s),this._height=Math.floor(t*s),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=r+"px"}getImageData(e,t){return this.context.getImageData(Math.round((e.x-t.left)/t.width*this._width),Math.round((e.y-t.top)/t.height*this._height),1,1)}setMargin(e){this.margin.left=0,this.margin.right=0,this.margin.top=0,this.margin.bottom=0,r.each(e,(e=>{e.margin&&(this.margin.left=Math.max(this.margin.left,e.margin.left),this.margin.right=Math.max(this.margin.right,e.margin.right),this.margin.top=Math.max(this.margin.top,e.margin.top),this.margin.bottom=Math.max(this.margin.bottom,e.margin.bottom))}))}clear(){this.context.save(),this.context.fillStyle="#000",this.context.fillRect(0,0,this._width,this._height)}}class pe{constructor(e,t){Object.defineProperty(this,"view",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tainted",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"margin",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"order",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dirty",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"exportableView",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exportableContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.view=e,this.context=t}resize(e,t,i,r,s){null!=this.width&&(e=this.width,i=this.width),null!=this.height&&(t=this.height,r=this.height),this.margin?(e+=this.margin.left+this.margin.right,t+=this.margin.top+this.margin.bottom,i+=this.margin.left+this.margin.right,r+=this.margin.top+this.margin.bottom,this.view.style.left=-this.margin.left+"px",this.view.style.top=-this.margin.top+"px"):(this.view.style.left="0px",this.view.style.top="0px"),this._width=Math.floor(e*s),this._height=Math.floor(t*s),this.view.width=this._width,this.view.style.width=i+"px",this.view.height=this._height,this.view.style.height=r+"px"}clear(){this.context.save(),this.context.clearRect(0,0,this._width,this._height)}}function _e(e,t){null==e?requestAnimationFrame(t):setTimeout((()=>{requestAnimationFrame(t)}),1e3/e)}class ye{constructor(e,t={},i){if(Object.defineProperty(this,"dom",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_inner",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_isDirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dirty",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyParents",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyBounds",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_dirtyPositions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_ticker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_tickers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_updateTick",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new r.EventDispatcher}),Object.defineProperty(this,"animationTime",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_animations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rootContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tooltipContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipContainerSettings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltip",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"language",{enumerable:!0,configurable:!0,writable:!0,value:v.new(this,{})}),Object.defineProperty(this,"locale",{enumerable:!0,configurable:!0,writable:!0,value:y}),Object.defineProperty(this,"utc",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timezone",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numberFormatter",{enumerable:!0,configurable:!0,writable:!0,value:b.new(this,{})}),Object.defineProperty(this,"dateFormatter",{enumerable:!0,configurable:!0,writable:!0,value:p.new(this,{})}),Object.defineProperty(this,"durationFormatter",{enumerable:!0,configurable:!0,writable:!0,value:_.new(this,{})}),Object.defineProperty(this,"tabindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tabindexes",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_a11yD",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_focusElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_focusedSprite",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isShift",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_keyboardDragPoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_readerAlertElement",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_logo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltipDiv",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nonce",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"interfaceColors",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verticalLayout",{enumerable:!0,configurable:!0,writable:!0,value:r.VerticalLayout.new(this,{})}),Object.defineProperty(this,"horizontalLayout",{enumerable:!0,configurable:!0,writable:!0,value:r.HorizontalLayout.new(this,{})}),Object.defineProperty(this,"gridLayout",{enumerable:!0,configurable:!0,writable:!0,value:r.GridLayout.new(this,{})}),Object.defineProperty(this,"_paused",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"autoResize",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_fontHash",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"_isDisposed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_disposers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_resizeSensorDisposer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tooltips",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_htmlElementContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_htmlEnabledContainers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),!i)throw new Error("You cannot use `new Class()`, instead use `Class.new()`");let s,a;if(this._settings=t,0==t.accessible&&(this._a11yD=!0),null==t.useSafeResolution&&(t.useSafeResolution=!0),t.useSafeResolution&&(s=r.getSafeResolution()),this._renderer=new ge(s),a=e instanceof HTMLElement?e:document.getElementById(e),r.each(r.registry.rootElements,(e=>{if(e.dom===a)throw new Error("You cannot have multiple Roots on the same DOM node")})),this.interfaceColors=d.new(this,{}),null===a)throw new Error("Could not find HTML element with id `"+e+"`");this.dom=a;let n=document.createElement("div");n.style.position="relative",n.style.width="100%",n.style.height="100%",a.appendChild(n);const o=t.tooltipContainerBounds;o&&(this._tooltipContainerSettings=o),this._inner=n,this._updateComputedStyles(),r.registry.rootElements.push(this)}static new(e,t){const i=new ye(e,t,!0);return i._init(),i}moveDOM(e){let t;if(t=e instanceof HTMLElement?e:document.getElementById(e),t){for(;this.dom.childNodes.length>0;)t.appendChild(this.dom.childNodes[0]);this.dom=t,this._initResizeSensor(),this.resize()}}_handleLogo(){if(this._logo){const e=this.dom.offsetWidth,t=this.dom.offsetHeight;e<=150||t<=60?this._logo.hide():this._logo.show()}}_showBranding(){if(!this._logo){const e=this.tooltipContainer.children.push(r.Container.new(this,{interactive:!0,interactiveChildren:!1,position:"absolute",setStateOnChildren:!0,paddingTop:9,paddingRight:9,paddingBottom:9,paddingLeft:9,scale:.6,y:r.percent(100),centerY:r.p100,tooltipText:"Created using amCharts 5",tooltipX:r.p100,cursorOverStyle:"pointer",background:r.Rectangle.new(this,{fill:r.color(4671320),fillOpacity:0,tooltipY:5})})),t=s.Tooltip.new(this,{pointerOrientation:"horizontal",paddingTop:4,paddingRight:7,paddingBottom:4,paddingLeft:7});t.label.setAll({fontSize:12}),t.get("background").setAll({fill:this.interfaceColors.get("background"),stroke:this.interfaceColors.get("grid"),strokeOpacity:.3}),e.set("tooltip",t),e.events.on("click",(()=>{window.open("https://www.amcharts.com/","_blank")})),e.states.create("hover",{});e.children.push(r.Graphics.new(this,{stroke:r.color(13421772),strokeWidth:3,svgPath:"M5 25 L13 25h13.6c3.4 0 6 0 10.3-4.3s5.2-12 8.6-12c3.4 0 4.3 8.6 7.7 8.6M83.4 25H79.8c-3.4 0-6 0-10.3-4.3s-5.2-12-8.6-12-4.3 8.6-7.7 8.6"})).states.create("hover",{stroke:r.color(3976191)});e.children.push(r.Graphics.new(this,{stroke:r.color(8947848),strokeWidth:3,svgPath:"M83.4 25h-31C37 25 39.5 4.4 28.4 4.4S18.9 24.2 4.3 25H0"})).states.create("hover",{stroke:r.color(4671320)}),this._logo=e,this._handleLogo()}}_getRealSize(){return this.dom.getBoundingClientRect()}_getCalculatedSize(e){return this._settings.calculateSize?this._settings.calculateSize(e):{width:e.width,height:e.height}}_init(){const e=this._settings;!1!==e.accessible&&(e.focusable&&(this._inner.setAttribute("focusable","true"),this._inner.setAttribute("tabindex",this.tabindex+"")),e.ariaLabel&&this._inner.setAttribute("aria-label",e.ariaLabel));const t=this._renderer,i=this._getRealSize(),s=this._getCalculatedSize(i),n=Math.floor(s.width),o=Math.floor(s.height),l=Math.floor(i.width),h=Math.floor(i.height),u=r.Container.new(this,{visible:!0,width:n,height:o});this._rootContainer=u,this._rootContainer._defaultThemes.push(a.DefaultTheme.new(this));const c=u.children.push(r.Container.new(this,{visible:!0,width:r.p100,height:r.p100}));this.container=c,t.resize(l,h,n,o),this._inner.appendChild(t.view),this._initResizeSensor();const d=document.createElement("div");if(this._htmlElementContainer=d,d.className="am5-html-container",d.style.position="absolute",d.style.pointerEvents="none",this._tooltipContainerSettings||(d.style.overflow="hidden"),this._inner.appendChild(d),!0!==this._a11yD){const e=document.createElement("div");e.className="am5-reader-container",e.setAttribute("role","alert"),e.style.position="absolute",e.style.width="1px",e.style.height="1px",e.style.overflow="hidden",e.style.clip="rect(1px, 1px, 1px, 1px)",this._readerAlertElement=e,this._inner.appendChild(this._readerAlertElement);const i=document.createElement("div");i.className="am5-focus-container",i.style.position="absolute",i.style.pointerEvents="none",i.style.top="0px",i.style.left="0px",i.style.overflow="hidden",i.style.width=n+"px",i.style.height=o+"px",i.setAttribute("role","graphics-document"),r.setInteractive(i,!1),this._focusElementContainer=i,this._inner.appendChild(this._focusElementContainer);const s=document.createElement("div");this._tooltipElementContainer=s,s.className="am5-tooltip-container",this._inner.appendChild(s),r.supports("keyboardevents")&&(this._disposers.push(r.addEventListener(window,"keydown",(e=>{16==e.keyCode?this._isShift=!0:9==e.keyCode&&(this._isShift=e.shiftKey)}))),this._disposers.push(r.addEventListener(window,"keyup",(e=>{16==e.keyCode&&(this._isShift=!1)}))),this._disposers.push(r.addEventListener(i,"click",(()=>{const e=this._focusedSprite;if(e){const i=t.getEvent(new MouseEvent("click"));e.events.dispatch("click",{type:"click",originalEvent:i.event,point:i.point,simulated:!0,target:e})}}))),this._disposers.push(r.addEventListener(i,"keydown",(e=>{const i=this._focusedSprite;if(i){27==e.keyCode&&(r.blur(),this._focusedSprite=void 0);let s=0,a=0;switch(e.keyCode){case 13:e.preventDefault();const r=t.getEvent(new MouseEvent("click"));return void i.events.dispatch("click",{type:"click",originalEvent:r.event,point:r.point,simulated:!0,target:i});case 37:s=-6;break;case 39:s=6;break;case 38:a=-6;break;case 40:a=6;break;default:return}if(0!=s||0!=a){if(e.preventDefault(),!i.isDragging()){this._keyboardDragPoint={x:0,y:0};const e=t.getEvent(new MouseEvent("mousedown",{clientX:0,clientY:0}));i.events.isEnabled("pointerdown")&&i.events.dispatch("pointerdown",{type:"pointerdown",originalEvent:e.event,point:e.point,simulated:!0,target:i})}const r=this._keyboardDragPoint;r.x+=s,r.y+=a;const n=t.getEvent(new MouseEvent("mousemove",{clientX:r.x,clientY:r.y}),!1);i.events.isEnabled("globalpointermove")&&i.events.dispatch("globalpointermove",{type:"globalpointermove",originalEvent:n.event,point:n.point,simulated:!0,target:i})}}}))),this._disposers.push(r.addEventListener(i,"keyup",(e=>{if(this._focusedSprite){const i=this._focusedSprite,s=e.keyCode;switch(s){case 37:case 39:case 38:case 40:if(i.isDragging()){const e=this._keyboardDragPoint,r=t.getEvent(new MouseEvent("mouseup",{clientX:e.x,clientY:e.y}));return i.events.isEnabled("globalpointerup")&&i.events.dispatch("globalpointerup",{type:"globalpointerup",originalEvent:r.event,point:r.point,simulated:!0,target:i}),void(this._keyboardDragPoint=void 0)}if(i.get("focusableGroup")){const e=i.get("focusableGroup"),t=this._tabindexes.filter((t=>t.get("focusableGroup")==e&&!1!==t.getPrivate("focusable")));let a=t.indexOf(i);const n=t.length-1;a+=39==s||40==s?1:-1,a<0?a=n:a>n&&(a=0),r.focus(t[a].getPrivate("focusElement").dom)}}}}))))}this._startTicker(),this.setThemes([]),this._addTooltip(),this._hasLicense()||this._showBranding()}_initResizeSensor(){this._resizeSensorDisposer&&this._resizeSensorDisposer.dispose(),this._resizeSensorDisposer=new c(this.dom,(()=>{this.autoResize&&this.resize()})),this._disposers.push(this._resizeSensorDisposer)}resize(){const e=this._getRealSize(),t=this._getCalculatedSize(e),i=Math.floor(t.width),r=Math.floor(t.height);if(i>0&&r>0){const t=Math.floor(e.width),s=Math.floor(e.height),a=this._htmlElementContainer;if(a.style.width=i+"px",a.style.height=r+"px",!0!==this._a11yD){const e=this._focusElementContainer;e.style.width=i+"px",e.style.height=r+"px"}this._renderer.resize(t,s,i,r);const n=this._rootContainer;n.setPrivate("width",i),n.setPrivate("height",r),this._render(),this._handleLogo()}}_render(){this._renderer.render(this._rootContainer._display),this._focusElementDirty&&(this._updateCurrentFocus(),this._focusElementDirty=!1)}_runTickers(e){r.each(this._tickers,(t=>{t(e)}))}_runAnimations(e){r.keepIf(this._animations,(t=>t._runAnimation(e)))}_runDirties(){let e={};for(;this._isDirtyParents;)this._isDirtyParents=!1,r.keys(this._dirtyParents).forEach((t=>{const i=this._dirtyParents[t];delete this._dirtyParents[t],i.isDisposed()||(e[i.uid]=i,i._prepareChildren())}));r.keys(e).forEach((t=>{e[t]._updateChildren()}));const t=[];r.keys(this._dirty).forEach((e=>{const i=this._dirty[e];i.isDisposed()?delete this._dirty[i.uid]:(t.push(i),i._beforeChanged())})),t.forEach((e=>{e._changed(),delete this._dirty[e.uid],e._clearDirty()})),this._isDirty=!1;const i={},s=[];r.keys(this._dirtyBounds).forEach((e=>{const t=this._dirtyBounds[e];delete this._dirtyBounds[e],t.isDisposed()||(i[t.uid]=t.depth(),s.push(t))})),this._positionHTMLElements(),s.sort(((e,t)=>r.compare(i[t.uid],i[e.uid]))),s.forEach((e=>{e._updateBounds()}));const a=this._dirtyPositions;r.keys(a).forEach((e=>{const t=a[e];delete a[e],t.isDisposed()||t._updatePosition()})),t.forEach((e=>{e._afterChanged()}))}_renderFrame(e){return!this._updateTick||(this.events.isEnabled("framestarted")&&this.events.dispatch("framestarted",{type:"framestarted",target:this,timestamp:e}),this._checkComputedStyles(),this._runTickers(e),this._runAnimations(e),this._runDirties(),this._render(),this._positionHTMLElements(),this.events.isEnabled("frameended")&&this.events.dispatch("frameended",{type:"frameended",target:this,timestamp:e}),0===this._tickers.length&&0===this._animations.length&&!this._isDirty)}_runTicker(e,t){if(!this.isDisposed()){this.animationTime=e;this._renderFrame(e)?(this._ticker=null,this.animationTime=null):this._paused||(t?this._ticker:_e(this.fps,this._ticker))}}_runTickerNow(e=1e4){if(!this.isDisposed()){const t=performance.now()+e;for(;;){const e=performance.now();if(e>=t){this.animationTime=null;break}this.animationTime=e;if(this._renderFrame(e)){this.animationTime=null;break}}}}_startTicker(){null===this._ticker&&(this.animationTime=null,this._ticker=e=>{this._runTicker(e)},_e(this.fps,this._ticker))}get updateTick(){return this._updateTick}set updateTick(e){this._updateTick=e,e&&this._startTicker()}_addDirtyEntity(e){void 0===this._dirty[e.uid]&&(this._isDirty=!0,this._dirty[e.uid]=e,this._startTicker())}_addDirtyParent(e){void 0===this._dirtyParents[e.uid]&&(this._isDirty=!0,this._isDirtyParents=!0,this._dirtyParents[e.uid]=e,this._startTicker())}_addDirtyBounds(e){void 0===this._dirtyBounds[e.uid]&&(this._isDirty=!0,this._dirtyBounds[e.uid]=e,this._startTicker())}_addDirtyPosition(e){void 0===this._dirtyPositions[e.uid]&&(this._isDirty=!0,this._dirtyPositions[e.uid]=e,this._startTicker())}_addAnimation(e){-1===this._animations.indexOf(e)&&(this._animations.push(e),this._startTicker())}_markDirty(){this._isDirty=!0}_markDirtyRedraw(){this.events.once("frameended",(()=>{this._isDirty=!0,this._startTicker()}))}eachFrame(e){return this._tickers.push(e),this._startTicker(),new r.Disposer((()=>{r.removeFirst(this._tickers,e)}))}markDirtyGlobal(e){e||(e=this.container),e.walkChildren((e=>{e instanceof r.Container&&this.markDirtyGlobal(e),e.markDirty(),e.markDirtyBounds()}))}width(){return Math.floor(this._getCalculatedSize(this._getRealSize()).width)}height(){return Math.floor(this._getCalculatedSize(this._getRealSize()).height)}dispose(){this._isDisposed||(this._isDisposed=!0,this._rootContainer.dispose(),this._renderer.dispose(),this.horizontalLayout.dispose(),this.verticalLayout.dispose(),this.interfaceColors.dispose(),r.each(this._disposers,(e=>{e.dispose()})),this._inner&&r.removeElement(this._inner),r.remove(r.registry.rootElements,this))}isDisposed(){return this._isDisposed}readerAlert(e){!0!==this._a11yD&&(this._readerAlertElement.innerHTML=r.stripTags(e))}setThemes(e){this._rootContainer.set("themes",e);const t=this.tooltipContainer;t&&t._applyThemes();const i=this.interfaceColors;i&&i._applyThemes()}_addTooltip(){if(!this.tooltipContainer){const e=this._tooltipContainerSettings,t=this._rootContainer.children.push(r.Container.new(this,{position:"absolute",isMeasured:!1,width:r.p100,height:r.p100,layer:e?35:30,layerMargin:e||void 0}));this.tooltipContainer=t;const i=s.Tooltip.new(this,{});this.container.set("tooltip",i),i.hide(0),this._tooltip=i}}_registerTabindexOrder(e){1!=this._a11yD&&(e.get("focusable")?r.pushOne(this._tabindexes,e):r.remove(this._tabindexes,e),this._invalidateTabindexes())}_unregisterTabindexOrder(e){1!=this._a11yD&&(r.remove(this._tabindexes,e),this._invalidateTabindexes())}_invalidateTabindexes(){if(1==this._a11yD)return;this._tabindexes.sort(((e,t)=>{const i=e.get("tabindexOrder",0),r=t.get("tabindexOrder",0);return i==r?0:i>r?1:-1}));const e=[];r.each(this._tabindexes,((t,i)=>{t.getPrivate("focusElement")?this._moveFocusElement(i,t):this._makeFocusElement(i,t);const r=t.get("focusableGroup");r&&!1!==t.getPrivate("focusable")&&(-1!==e.indexOf(r)?t.getPrivate("focusElement").dom.setAttribute("tabindex","-1"):e.push(r))}))}_updateCurrentFocus(){1!=this._a11yD&&this._focusedSprite&&(this._decorateFocusElement(this._focusedSprite),this._positionFocusElement(this._focusedSprite))}_decorateFocusElement(e,t){if(1==this._a11yD)return;if(t||(t=e.getPrivate("focusElement").dom),!t)return;const i=e.get("role");i?t.setAttribute("role",i):t.removeAttribute("role");const s=e.get("ariaLabel");if(s){const i=r.populateString(e,s);t.setAttribute("aria-label",i)}else t.removeAttribute("aria-label");const a=e.get("ariaLive");a?t.setAttribute("aria-live",a):t.removeAttribute("aria-live");const n=e.get("ariaChecked");null!=n?t.setAttribute("aria-checked",n?"true":"false"):t.removeAttribute("aria-checked"),e.get("ariaHidden")?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden");const o=e.get("ariaOrientation");o?t.setAttribute("aria-orientation",o):t.removeAttribute("aria-orientation");const l=e.get("ariaValueNow");l?t.setAttribute("aria-valuenow",l):t.removeAttribute("aria-valuenow");const h=e.get("ariaValueMin");h?t.setAttribute("aria-valuemin",h):t.removeAttribute("aria-valuemin");const u=e.get("ariaValueMax");u?t.setAttribute("aria-valuemax",u):t.removeAttribute("aria-valuemax");const c=e.get("ariaValueText");c?t.setAttribute("aria-valuetext",c):t.removeAttribute("aria-valuetext");const d=e.get("ariaControls");d?t.setAttribute("aria-controls",d):t.removeAttribute("aria-controls"),e.get("visible")&&0!==e.get("opacity")&&"tooltip"!=e.get("role")&&!e.isHidden()&&!1!==e.getPrivate("focusable")?("-1"!=t.getAttribute("tabindex")&&t.setAttribute("tabindex",""+this.tabindex),t.removeAttribute("aria-hidden")):(t.removeAttribute("tabindex"),t.setAttribute("aria-hidden","true"))}_makeFocusElement(e,t){if(t.getPrivate("focusElement")||1==this._a11yD)return;const i=document.createElement("div");"tooltip"!=t.get("role")&&(i.tabIndex=this.tabindex),i.style.position="absolute",r.setInteractive(i,!1);const s=[];t.setPrivate("focusElement",{dom:i,disposers:s}),this._decorateFocusElement(t),s.push(r.addEventListener(i,"focus",(t=>{this._handleFocus(t,e)}))),s.push(r.addEventListener(i,"blur",(t=>{this._handleBlur(t,e)}))),this._moveFocusElement(e,t)}_removeFocusElement(e){if(1==this._a11yD)return;r.remove(this._tabindexes,e);const t=e.getPrivate("focusElement");if(t){this._focusElementContainer.removeChild(t.dom),r.each(t.disposers,(e=>{e.dispose()}))}}_hideFocusElement(e){if(1==this._a11yD)return;e.getPrivate("focusElement").dom.style.display="none"}_moveFocusElement(e,t){if(1==this._a11yD)return;const i=this._focusElementContainer,r=t.getPrivate("focusElement").dom;if(r===this._focusElementContainer.children[e])return;const s=this._focusElementContainer.children[e+1];s?i.insertBefore(r,s):i.append(r)}_positionFocusElement(e){if(1==this._a11yD||null==e)return;const t=e.globalBounds();let i=t.right==t.left?e.width():t.right-t.left,r=t.top==t.bottom?e.height():t.bottom-t.top,s=t.left-2,a=t.top-2;i<0&&(s+=i,i=Math.abs(i)),r<0&&(a+=r,r=Math.abs(r));const n=e.getPrivate("focusElement").dom;n.style.top=a+"px",n.style.left=s+"px",n.style.width=i+4+"px",n.style.height=r+4+"px"}_handleFocus(e,t){if(1==this._a11yD)return;const i=this._tabindexes[t];i.isVisibleDeep()?(this._positionFocusElement(i),this._focusedSprite=i,i.events.isEnabled("focus")&&i.events.dispatch("focus",{type:"focus",originalEvent:e,target:i})):this._focusNext(e.target,this._isShift?-1:1)}_focusNext(e,t){if(1==this._a11yD)return;const i=Array.from(document.querySelectorAll(["a[href]","area[href]","button:not([disabled])","details","input:not([disabled])","iframe:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contentEditable=""]','[contentEditable="true"]','[contentEditable="TRUE"]','[tabindex]:not([tabindex^="-"])'].join(",")));let r=i.indexOf(e)+t;r<0?r=i.length-1:r>=i.length&&(r=0),i[r].focus()}_handleBlur(e,t){if(1==this._a11yD)return;const i=this._focusedSprite;i&&i.events.isEnabled("blur")&&i.events.dispatch("blur",{type:"blur",originalEvent:e,target:i}),this._focusedSprite=void 0}updateTooltip(e){if(1==this._a11yD)return;const t=r.stripTags(e._getText());let i=e.getPrivate("tooltipElement");"tooltip"==e.get("role")&&""!=t?(i||(i=this._makeTooltipElement(e)),i.innerHTML!=t&&(i.innerHTML=t)):i&&(i.remove(),e.removePrivate("tooltipElement"))}_makeTooltipElement(e){const t=this._tooltipElementContainer,i=document.createElement("div");return i.style.position="absolute",i.style.width="1px",i.style.height="1px",i.style.overflow="hidden",i.style.clip="rect(1px, 1px, 1px, 1px)",r.setInteractive(i,!1),this._decorateFocusElement(e,i),t.append(i),e.setPrivate("tooltipElement",i),i}_removeTooltipElement(e){if(1==this._a11yD)return;const t=e.getPrivate("tooltipElement");if(t){const e=t.parentElement;e&&e.removeChild(t)}}_invalidateAccessibility(e){if(1==this._a11yD)return;this._focusElementDirty=!0;const t=e.getPrivate("focusElement");e.get("focusable")?t&&(this._decorateFocusElement(e),this._positionFocusElement(e)):t&&this._removeFocusElement(e)}focused(e){return this._focusedSprite===e}documentPointToRoot(e){const t=this._getRealSize(),i=this._getCalculatedSize(t),r=i.width/t.width,s=i.height/t.height;return{x:(e.x-t.left)*r,y:(e.y-t.top)*s}}rootPointToDocument(e){const t=this._getRealSize(),i=this._getCalculatedSize(t),r=i.width/t.width,s=i.height/t.height;return{x:e.x/r+t.left,y:e.y/s+t.top}}addDisposer(e){return this._disposers.push(e),e}_updateComputedStyles(){const e=window.getComputedStyle(this.dom);let t="";r.each$1(e,((e,i)=>{r.isString(e)&&e.match(/^font/)&&(t+=i)}));const i=t!=this._fontHash;return i&&(this._fontHash=t),i}_checkComputedStyles(){this._updateComputedStyles()&&this._invalidateLabelBounds(this.container)}_invalidateLabelBounds(e){e instanceof r.Container?e.children.each((e=>{this._invalidateLabelBounds(e)})):e instanceof r.Text&&e.markDirtyBounds()}_hasLicense(){for(let e=0;e<r.registry.licenses.length;e++)if(r.registry.licenses[e].match(/^AM5C.{5,}/i))return!0;return!1}_licenseApplied(){this._logo&&this._logo.set("forceHidden",!0)}get debugGhostView(){return this._renderer.debugGhostView}set debugGhostView(e){this._renderer.debugGhostView=e}set tapToActivate(e){this._renderer.tapToActivate=e}get tapToActivate(){return this._renderer.tapToActivate}set tapToActivateTimeout(e){this._renderer.tapToActivateTimeout=e}get tapToActivateTimeout(){return this._renderer.tapToActivateTimeout}_makeHTMLElement(e){const t=this._htmlElementContainer,i=document.createElement("div");return e.setPrivate("htmlElement",i),i.style.position="absolute",i.style.overflow="auto",i.style.boxSizing="border-box",r.setInteractive(i,e.get("interactive",!1)),e.events.isEnabled("click")&&(r.setInteractive(i,!0),this._disposers.push(r.addEventListener(i,"click",(t=>{const i=this._renderer.getEvent(t);e.events.dispatch("click",{type:"click",originalEvent:i.event,point:i.point,simulated:!1,target:e})})))),this._positionHTMLElement(e),t.append(i),r.pushOne(this._htmlEnabledContainers,e),i}_positionHTMLElements(){r.each(this._htmlEnabledContainers,(e=>{this._positionHTMLElement(e)}))}_positionHTMLElement(e){const t=e.getPrivate("htmlElement");if(t){const i=["paddingTop","paddingRight","paddingBottom","paddingLeft","minWidth","minHeight","maxWidth","maxHeight"];r.each(i,(i=>{const r=e.get(i);t.style[i]=r?r+"px":""}));const s=e.compositeOpacity();setTimeout((()=>{t.style.opacity=s+""}),10);const a=e.isVisibleDeep();a&&(t.style.display="block");const n=e.globalBounds();t.style.top=n.top+"px",t.style.left=n.left+"px";const o=e.get("width"),l=e.get("height");let h=0,u=0;if(o&&(h=e.width()),l&&(u=e.height()),o&&l)e.removePrivate("minWidth"),e.removePrivate("minHeight");else{t.style.position="fixed",t.style.width="",t.style.height="";const i=t.getBoundingClientRect();t.style.position="absolute",h=i.width,u=i.height,e._adjustedLocalBounds={left:0,right:0,top:0,bottom:0},e.setPrivate("minWidth",h),e.setPrivate("minHeight",u)}h>0&&(t.style.minWidth=h+"px"),u>0&&(t.style.minHeight=u+"px"),a&&0!=s||(t.style.display="none")}}_setHTMLContent(e,t){let i=e.getPrivate("htmlElement");i||(i=this._makeHTMLElement(e)),i.innerHTML!=t&&(i.innerHTML=t)}_removeHTMLContent(e){let t=e.getPrivate("htmlElement");t&&this._htmlElementContainer.removeChild(t),r.remove(this._htmlEnabledContainers,e)}}r.addLicense("AM5C241025748");const ve="en-us",we=new Map([["ar",()=>new Promise(((t,i)=>e(["./ar"],t,i)))],["bg-bg",()=>new Promise(((t,i)=>e(["./bg_BG"],t,i)))],["bs-ba",()=>new Promise(((t,i)=>e(["./bs_BA"],t,i)))],["ca-es",()=>new Promise(((t,i)=>e(["./ca_ES"],t,i)))],["cs-cz",()=>new Promise(((t,i)=>e(["./cs_CZ"],t,i)))],["da-dk",()=>new Promise(((t,i)=>e(["./da_DK"],t,i)))],["de-de",()=>new Promise(((t,i)=>e(["./de_DE"],t,i)))],["de-ch",()=>new Promise(((t,i)=>e(["./de_CH"],t,i)))],["el-gr",()=>new Promise(((t,i)=>e(["./el_GR"],t,i)))],["en-us",()=>new Promise(((t,i)=>e(["./en_US"],t,i)))],["en-ca",()=>new Promise(((t,i)=>e(["./en_CA"],t,i)))],["es-es",()=>new Promise(((t,i)=>e(["./es_ES"],t,i)))],["et-ee",()=>new Promise(((t,i)=>e(["./et_EE"],t,i)))],["fi-fi",()=>new Promise(((t,i)=>e(["./fi_FI"],t,i)))],["fr-fr",()=>new Promise(((t,i)=>e(["./fr_FR"],t,i)))],["he-il",()=>new Promise(((t,i)=>e(["./he_IL"],t,i)))],["hr-hr",()=>new Promise(((t,i)=>e(["./hr_HR"],t,i)))],["hu-hu",()=>new Promise(((t,i)=>e(["./hu_HU"],t,i)))],["id-id",()=>new Promise(((t,i)=>e(["./id_ID"],t,i)))],["it-it",()=>new Promise(((t,i)=>e(["./it_IT"],t,i)))],["ja-jp",()=>new Promise(((t,i)=>e(["./ja_JP"],t,i)))],["ko-kr",()=>new Promise(((t,i)=>e(["./ko_KR"],t,i)))],["lt-lt",()=>new Promise(((t,i)=>e(["./lt_LT"],t,i)))],["lv-lv",()=>new Promise(((t,i)=>e(["./lv_LV"],t,i)))],["nb-no",()=>new Promise(((t,i)=>e(["./nb_NO"],t,i)))],["nl-nl",()=>new Promise(((t,i)=>e(["./nl_NL"],t,i)))],["pl-pl",()=>new Promise(((t,i)=>e(["./pl_PL"],t,i)))],["pt-br",()=>new Promise(((t,i)=>e(["./pt_BR"],t,i)))],["pt-pt",()=>new Promise(((t,i)=>e(["./pt_PT"],t,i)))],["ro-ro",()=>new Promise(((t,i)=>e(["./ro_RO"],t,i)))],["ru-ru",()=>new Promise(((t,i)=>e(["./ru_RU"],t,i)))],["sk-sk",()=>new Promise(((t,i)=>e(["./sk_SK"],t,i)))],["sl-sl",()=>new Promise(((t,i)=>e(["./sl_SL"],t,i)))],["sr-rs",()=>new Promise(((t,i)=>e(["./sr_RS"],t,i)))],["sv-se",()=>new Promise(((t,i)=>e(["./sv_SE"],t,i)))],["th-th",()=>new Promise(((t,i)=>e(["./th_TH"],t,i)))],["tr-tr",()=>new Promise(((t,i)=>e(["./tr_TR"],t,i)))],["uk-ua",()=>new Promise(((t,i)=>e(["./uk_UA"],t,i)))],["vi-vn",()=>new Promise(((t,i)=>e(["./vi_VN"],t,i)))],["zh-cn",()=>new Promise(((t,i)=>e(["./zh_Hans"],t,i)))],["zh-hk",()=>new Promise(((t,i)=>e(["./zh_Hant"],t,i)))],["zh-tw",()=>new Promise(((t,i)=>e(["./zh_Hant"],t,i)))]]);function xe(e){const t=e.split("-")[0].toLowerCase();let i=null;for(const r of we.keys())if(r.startsWith(t)){i=r;break}return i}function Pe(e){return e?we.has(e.toLowerCase())?e.toLowerCase():xe(e)||ve:ve}async function Oe(e,t=n.getLocale()){const i=ye.new(e);return i.locale=(await we.get(Pe(t))()).default,i}t.NumberFormatter=b,t.createRoot=Oe}));
