/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../chunks/tslib.es6","./Error","./maybe","./Promise","./promiseUtils","./Warning","./accessorSupport/decorators/property","./accessorSupport/decorators/subclass"],(function(o,t,r,e,s,l,a,n){"use strict";const d="not-loaded",i="loading",c="failed",h="loaded",u=e=>{let u=class extends e{constructor(...o){super(...o),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((o=>{const r=this.load.bind(this);this.load=e=>{const l=new Promise(((o,r)=>{const l=s.onAbortOrThrow(e,r);this.destroyed&&r(new t("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(o,r).finally((()=>{l&&l.remove()}))}));if(this.loadStatus===d){this._set("loadStatus",i);const o=this._loadController=new AbortController;r({signal:o.signal})}return o(),l}}))),this.when((()=>{this._set("loadStatus",h),this._loadController=null}),(o=>{this._set("loadStatus",c),this._set("loadError",o),this._loadController=null}))}destroy(){this._loadController&&(this._loadController=r.abortMaybe(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===h}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){return this.isFulfilled()||(this._set("loadError",new t("load:cancelled","Cancelled")),this._loadController?.abort(),this._promiseProps.abort()),this}};return o.__decorate([a.property({readOnly:!0})],u.prototype,"loaded",null),o.__decorate([a.property({readOnly:!0})],u.prototype,"loadError",void 0),o.__decorate([a.property({clonable:!1})],u.prototype,"loadStatus",void 0),o.__decorate([a.property({type:[l],readOnly:!0})],u.prototype,"loadWarnings",null),u=o.__decorate([n.subclass("esri.core.Loadable")],u),u};let _=class extends(u(e.EsriPromise)){};_=o.__decorate([n.subclass("esri.core.Loadable")],_),function(o){function t(o){return!(!o||!o.load)}o.LoadableMixin=u,o.isLoadable=t}(_||(_={}));return _}));
