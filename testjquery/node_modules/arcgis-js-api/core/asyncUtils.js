/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../chunks/tslib.es6","./Accessor","./maybe","./promiseUtils","./accessorSupport/decorators/property","./accessorSupport/decorators/subclass"],(function(r,t,e,o,s,n,l){"use strict";function a(r,t,e){return s.eachAlways(r.map(((r,o)=>t.apply(e,[r,o]))))}async function u(r,t,e){return(await s.eachAlways(r.map(((r,o)=>t.apply(e,[r,o]))))).map((r=>r.value))}function i(r){return{ok:!0,value:r}}function c(r){return{ok:!1,error:r}}function p(r){return null!=r&&!0===r.ok?r.value:null}function h(r){return null!=r&&!1===r.ok?r.error:null}async function _(r){if(null==r)return{ok:!1,error:new Error("no promise provided")};try{return i(await r)}catch(t){return c(t)}}async function y(r){try{return i(await r)}catch(t){return s.throwIfAbortError(t),c(t)}}function b(r){if(!0===r.ok)return r.value;throw r.error}function d(r,t){return new f(r,t)}let f=class extends e{get value(){return p(this._result)}get error(){return h(this._result)}get finished(){return null!=this._result}constructor(r,t){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=o.abortMaybe(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:e}=this._abortController;this.promise=r(e),this.promise.then((r=>{this._result=i(r),this._cleanup()}),(r=>{this._result=c(r),this._cleanup()})),this._abortHandle=s.onAbort(t,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=o.removeMaybe(this._abortHandle),this._abortController=null}};t.__decorate([n.property()],f.prototype,"value",null),t.__decorate([n.property()],f.prototype,"error",null),t.__decorate([n.property()],f.prototype,"finished",null),t.__decorate([n.property()],f.prototype,"promise",void 0),t.__decorate([n.property()],f.prototype,"_result",void 0),f=t.__decorate([l.subclass("esri.core.asyncUtils.ReactiveTask")],f),r.assertResult=b,r.createTask=d,r.forEach=a,r.makeResultError=c,r.makeResultOk=i,r.map=u,r.result=_,r.resultError=h,r.resultOrAbort=y,r.resultValue=p,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));
