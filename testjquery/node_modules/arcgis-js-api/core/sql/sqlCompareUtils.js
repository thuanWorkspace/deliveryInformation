/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../arcade/featureset/support/errorsupport","./sqlDateParsingUtils","./SqlTimestampOffset","./UnknownTimeZone","../../chunks/datetime"],(function(r,e,t,n,i,o){"use strict";const s=321408e5,a=26784e5,l=864e5,u=36e5,f=6e4;function c(r){return!!t.isDateTime(r)||!!t.isTimestampOffset(r)}function m(r){return!!t.isDateTime(r)||(!!t.isDateOnly(r)||(!!t.isTimestampOffset(r)||!!t.isTimeOnly(r)))}function S(r){if(t.isDateTime(r))return r.toMillis();if(t.isDateOnly(r))return r.toNumber();if(t.isTimestampOffset(r))return r.toMilliseconds();throw new e.SqlError(e.SqlErrorCodes.InvalidDataType)}function d(r,s,a,l){if(null==r||null==s)return null;if(t.isNumber(r)){if(t.isNumber(s))return w(r,s,a);if(t.isString(s))return O(r,s,a);if(m(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isDateOnly(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator)}else if(t.isString(r)){if(t.isNumber(s))return q(r,s,a);if(t.isString(s))return T(r,s,a);if(t.isDateTime(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isDateOnly(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isTimeOnly(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isTimestampOffset(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator)}else if(t.isDateTime(r)){if(c(s)){if(r instanceof o.DateTime&&i.isUnknownTimeZone(r.zone)){if(s instanceof o.DateTime&&!1===i.isUnknownTimeZone(s.zone))return y(r,s,a);if(s instanceof n.SqlTimeStampOffset)return y(r,s,a)}else if(s instanceof o.DateTime&&i.isUnknownTimeZone(s.zone)){if(r instanceof o.DateTime&&!1===i.isUnknownTimeZone(r.zone))return y(r,s,a);if(r instanceof n.SqlTimeStampOffset)return y(r,s,a)}return w(S(r),S(s),a)}if(t.isString(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isDateOnly(s))return p(r,s,a);if(t.isTimeOnly(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isNumber(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator)}else if(t.isDateOnly(r)){if(t.isTimestampOffset(s))return h(r,s,a);if(t.isDateTime(s))return D(r,s,a);if(t.isString(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isDateOnly(s))return w(r.toNumber(),s.toNumber(),a);if(t.isTimeOnly(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isNumber(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator)}else if(t.isTimeOnly(r)){if(t.isTimeOnly(s))return w(r.toNumber(),s.toNumber(),a);if(t.isString(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isNumber(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isDateOnly(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(c(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator)}else if(t.isTimestampOffset(r)){if(c(s))return s instanceof o.DateTime&&i.isUnknownTimeZone(s.zone)?y(r,s,a):w(S(r),S(s),a);if(t.isString(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isDateOnly(s))return E(r,s,a);if(t.isTimeOnly(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator);if(t.isNumber(s))throw new e.SqlError(e.SqlErrorCodes.InvalidOperator)}switch(a){case"<>":return r!==s;case"=":return r===s;case">":return r>s;case"<":return r<s;case">=":return r>=s;case"<=":return r<=s}}function w(r,e,t){switch(t){case"<>":return r!==e;case"=":return r===e;case">":return r>e;case"<":return r<e;case">=":return r>=e;case"<=":return r<=e}}function O(r,e,t){const n=parseFloat(e);if(!isNaN(n))return w(r,n,t);const i=r.toString();switch(t){case"<>":return i!==e;case"=":return i===e;case">":return i>e;case"<":return i<e;case">=":return i>=e;case"<=":return i<=e}}function q(r,e,t){const n=parseFloat(r);if(!isNaN(n))return w(n,e,t);const i=e.toString();switch(t){case"<>":return r!==i;case"=":return r===i;case">":return r>i;case"<":return r<i;case">=":return r>=i;case"<=":return r<=i}}function T(r,e,t){switch(t){case"<>":return r!==e;case"=":return r===e;case">":return r>e;case"<":return r<e;case">=":return r>=e;case"<=":return r<=e}}function p(r,e,t){const n=e.toDateTimeLuxon(r.zone);return w((r=r.startOf("day")).toMillis(),n.toMillis(),t)}function E(r,e,t){const n=e.toDateTimeLuxon(r.toDateTime().zone);return w((r=r.startOfDay()).toMilliseconds(),n.toMillis(),t)}function D(r,e,t){const n=r.toDateTimeLuxon(e.zone);return e=e.startOf("day"),w(n.toMillis(),e.toMillis(),t)}function h(r,e,t){const n=r.toDateTimeLuxon(e.toDateTime().zone);return e=e.startOfDay(),w(n.toMillis(),e.toMilliseconds(),t)}function y(r,e,t){r instanceof n.SqlTimeStampOffset&&(r=r.toDateTime()),e instanceof n.SqlTimeStampOffset&&(e=e.toDateTime());const i=C(r),o=C(e);switch(t){case"<>":return i!==o;case"=":return i===o;case">":return i>o;case"<":return i<o;case">=":return i>=o;case"<=":return i<=o}}function C(r){return r.year*s+r.month*a+r.day*l+r.hour*u+r.minute*f+1e3*r.second+r.millisecond}r.dateValueInMilliseconds=S,r.isDateOrTimeValue=m,r.isDateTimeComparableValue=c,r.sqlCompare=d,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));
