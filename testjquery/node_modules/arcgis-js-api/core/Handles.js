/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["./iteratorUtils"],(function(e){"use strict";class r{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach((r=>{e+=r.length})),e}add(r,t){if(e.isIterable(r)){const e=this._getOrCreateGroup(t);for(const t of r)this._isHandle(t)&&e.push(t)}else if(this._isHandle(r)){this._getOrCreateGroup(t).push(r)}return this}forEach(e,r){if("function"==typeof e)this._groups.forEach((r=>r.forEach(e)));else{const t=this._getGroup(e);t&&r&&t.forEach(r)}}has(e){return this._groups.has(this._ensureGroupKey(e))}remove(r){if("string"!=typeof r&&e.isIterable(r)){for(const e of r)this.remove(e);return this}return this.has(r)?(this._removeAllFromGroup(this._getGroup(r)),this._groups.delete(this._ensureGroupKey(r)),this):this}removeAll(){return this._groups.forEach((e=>this._removeAllFromGroup(e))),this._groups.clear(),this}_isHandle(e){return e&&(!!e.remove||e instanceof r)}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const r=[];return this._groups.set(this._ensureGroupKey(e),r),r}_getGroup(e){return this._groups.get(this._ensureGroupKey(e))}_ensureGroupKey(e){return e||"_default_"}_removeAllFromGroup(e){for(const t of e)t instanceof r?t.removeAll():t.remove()}}return r}));
