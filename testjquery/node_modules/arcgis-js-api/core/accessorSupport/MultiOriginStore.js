/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../lang","./PropertyOrigin"],(function(t,i){"use strict";class r{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(i.OriginIdNum),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const s=new r,n=this._originStores[i.OriginId.DEFAULTS];n&&n.forEach(((r,e)=>{s.set(e,t.clone(r),i.OriginId.DEFAULTS)}));for(let r=i.OriginId.SERVICE;r<i.OriginIdNum;r++){const i=this._originStores[r];i&&i.forEach(((i,n)=>{e&&e.has(n)||s.set(n,t.clone(i),r)}))}return s}get(t,i){const r=void 0===i?this._values:this._originStores[i];return r?r.get(t):void 0}keys(t){const i=null==t?this._values:this._originStores[t];return i?[...i.keys()]:[]}set(t,r,e=i.OriginId.USER){let s=this._originStores[e];if(s||(s=new Map,this._originStores[e]=s),s.set(t,r),!this._values.has(t)||this._propertyOriginMap.get(t)<=e){const i=this._values.get(t);return this._values.set(t,r),this._propertyOriginMap.set(t,e),i!==r}return!1}delete(t,r=i.OriginId.USER){const e=this._originStores[r];if(!e)return;const s=e.get(t);if(e.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===r){this._values.delete(t);for(let i=r-1;i>=0;i--){const r=this._originStores[i];if(r&&r.has(t)){this._values.set(t,r.get(t)),this._propertyOriginMap.set(t,i);break}}}return s}has(t,i){const r=void 0===i?this._values:this._originStores[i];return!!r&&r.has(t)}revert(t,i){for(;i>0&&!this.has(t,i);)--i;const r=this._originStores[i],e=r?.get(t),s=this._values.get(t);return this._values.set(t,e),this._propertyOriginMap.set(t,i),s!==e}originOf(t){return this._propertyOriginMap.get(t)||i.OriginId.DEFAULTS}forEach(t){this._values.forEach(t)}}return r}));
