/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["./deprecate","./Handles","./Logger","./maybe","./accessorSupport/beforeDestroy","./accessorSupport/get","./accessorSupport/metadata","./accessorSupport/Properties","./accessorSupport/set","./accessorSupport/testSupport","./accessorSupport/watch","./accessorSupport/decorators/property","./accessorSupport/decorators/subclass"],(function(e,t,r,s,o,c,i,n,a,_,l,h,u){"use strict";var p,d;function y(e){if(null==e)return{value:e};if(Array.isArray(e))return{type:[e[0]],value:null};switch(typeof e){case"object":return e.constructor?.__accessorMetadata__||e instanceof Date?{type:e.constructor,value:e}:e;case"boolean":return{type:Boolean,value:e};case"string":return{type:String,value:e};case"number":return{type:Number,value:e};case"function":return{type:e,value:null};default:return}}const g=Symbol("Accessor-Handles"),f=Symbol("Accessor-Initialized");class v{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:t,declaredClass:r,constructor:s}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const o=this;class c extends o{constructor(...e){super(...e),this.inherited=null,s&&s.apply(this,e)}}i.getPropertiesMetadata(c.prototype);for(const i in e){const t=e[i];c.prototype[i]="function"==typeof t?function(...e){const r=this.inherited;let s;this.inherited=function(...e){if(o.prototype[i])return o.prototype[i].apply(this,e)};try{s=t.apply(this,e)}catch(c){throw this.inherited=r,c}return this.inherited=r,s}:e[i]}for(const i in t){const e=y(t[i]);h.property(e)(c.prototype,i)}return u.subclass(r)(c)}constructor(...e){if(this[p]=null,this[d]=!1,this.constructor===v)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const t=new n(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:t}),e.length>0&&this.normalizeCtorArgs&&(t.ctorArgs=this.normalizeCtorArgs.apply(this,e)),_.getAccessorInterceptor()?.onInstanceConstruct(this)}postscript(e){const t=this.__accessor__,r=t.ctorArgs||e;t.initialize(),r&&(this.set(r),t.ctorArgs=null),t.constructed(),this.initialize(),this[f]=!0}initialize(){}[o.beforeDestroySymbol](){this[g]=s.destroyMaybe(this[g])}destroy(){this.destroyed||(l.removeTarget(this),this.__accessor__.destroy(),_.getAccessorInterceptor()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[f]}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}commitProperty(e){c.get(this,e)}get(t){return e.deprecatedFunction(r.getLogger(this),"`Accessor.get` is deprecated in favor of using optional chaining",{version:"4.28",see:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining"}),c.get(this,t)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,t){return a.set(this,e,t),this}watch(e,t,r){return l.watch(this,e,t,r)}addHandles(e,r){if(this.destroyed){const t=Array.isArray(e)?e:[e];for(const e of t)e.remove();return}let s=this[g];null==s&&(s=this[g]=new t),s.add(e,r)}removeHandles(e){const t=this[g];null!=t&&t.remove(e)}removeAllHandles(){const e=this[g];null!=e&&e.removeAll()}hasHandles(e){const t=this[g];return null!=t&&t.has(e)}_override(e,t){void 0===t?this.__accessor__.clearOverride(e):this.__accessor__.override(e,t)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,t){null==t?this.__accessor__.clearOverride(e):this.__accessor__.override(e,t)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,t){return this.__accessor__.internalSet(e,t),this}}return p=g,d=f,v}));
