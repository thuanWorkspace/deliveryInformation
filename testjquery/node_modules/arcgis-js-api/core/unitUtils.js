/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","./has","./jsonMap","../geometry/ellipsoidUtils","../geometry/support/Ellipsoid","../geometry/support/spatialReferenceUtils","../geometry/support/WKIDUnitConversion"],(function(e,t,s,r,i,n,a){"use strict";const u=39.37,c=i.earth.radius*Math.PI/200,l=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,o=a,m=/UNIT\[([^\]]+)]/i,f=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),U=s.strict()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),d=e=>e*e,h=e=>e*e*e,q={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:d(.001)},"square-centimeters":{inBaseUnits:d(.01)},"square-decimeters":{inBaseUnits:d(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:d(1e3)},"square-inches":{inBaseUnits:d(.0254)},"square-feet":{inBaseUnits:d(.3048)},"square-yards":{inBaseUnits:d(.9144)},"square-miles":{inBaseUnits:d(1609.344)},"square-us-feet":{inBaseUnits:d(1200/3937)},acres:{inBaseUnits:.0015625*d(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*h(.001)},"cubic-centimeters":{inBaseUnits:1e3*h(.01)},"cubic-decimeters":{inBaseUnits:1e3*h(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*h(1e3)},"cubic-inches":{inBaseUnits:1e3*h(.0254)},"cubic-feet":{inBaseUnits:1e3*h(.3048)},"cubic-yards":{inBaseUnits:1e3*h(.9144)},"cubic-miles":{inBaseUnits:1e3*h(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},p=(()=>{const e={};for(const t in q)for(const s in q[t].units)e[s]=t;return e})();function g(e,t,s){return e*q[s].units[t].inBaseUnits}function B(e,t,s){return e/q[s].units[t].inBaseUnits}const S=["metric","imperial","square-inches","square-feet","square-yards","square-miles","square-us-feet","square-meters","square-kilometers","acres","ares","hectares"],k=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],b=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function M(e){return"imperial"===e||"metric"===e}function y(e){const t=p[e];if(!t)throw new Error("unknown type");return t}function w(e){return q[e].baseUnit}function _(e){return w(y(e))}function P(e,t=null){return t=t||y(e),q[t].baseUnit===e}function R(e,t,s){if(t===s)return e;const r=y(t);if(r!==y(s))throw new Error("incompatible units");const i=P(t,r)?e:g(e,t,r);return P(s,r)?i:B(i,s,r)}function v(e){switch(e){case"metric":return"meters";case"imperial":return"feet";default:return e}}function D(e){return v(e)}function F(e){switch(e){case"metric":return"square-meters";case"imperial":return"square-feet";default:return e}}function I(e,t,s){switch(s){case"metric":return T(e,t);case"imperial":return E(e,t);default:return s}}function L(e,t,s){switch(s){case"metric":return C(e,t);case"imperial":return N(e,t);default:return s}}function O(e,t,s){switch(s){case"metric":return J(e,t);case"imperial":return A(e,t);default:return s}}function T(e,t){const s=R(e,t,"meters");return Math.abs(s)<3e3?"meters":"kilometers"}function C(e,t){const s=R(e,t,"meters");return Math.abs(s)<1e5?"meters":"kilometers"}function E(e,t){const s=R(e,t,"feet");return Math.abs(s)<1e3?"feet":"miles"}function N(e,t){const s=R(e,t,"feet");return Math.abs(s)<1e5?"feet":"miles"}function J(e,t){const s=R(e,t,"square-meters");return Math.abs(s)<3e6?"square-meters":"square-kilometers"}function A(e,t){const s=R(e,t,"square-feet");return Math.abs(s)<1e6?"square-feet":"square-miles"}function K(e,t,s){return R(e,t,"meters")/(s*Math.PI/180)}function V(e){return U.fromJSON(e.toLowerCase())||null}function x(e){return U.toJSON(e)||null}function W(e){if(null!=e&&!n.isEarth(e))return 1;const t=G(e);return t>1e5?1:t}function j(e){return G(e)>=r.getReferenceEllipsoid(e).metersPerDegree?"meters":Q(e)}function G(e,t=i.earth.metersPerDegree){return H(e,!0)??t}function H(e,t=!1){const s=e?.wkid??null,r=e?.wkt2??e?.wkt??null;let a=null;if(s){if(n.isWKIDFromMars(s))return i.mars.metersPerDegree;if(n.isWKIDFromMoon(s))return i.moon.metersPerDegree;a=o.values[o[s]],!a&&t&&f.has(s)&&(a=c)}else r&&(se(r)?a=$(l.exec(r),a):te(r)&&(a=$(m.exec(r),a)));return a}function Y(e){return n.isGeographic(e)?1:G(e)}function $(e,t){return e?.[1]?z(e[1]):t}function z(e){return parseFloat(e.split(",")[1])}function Q(e){const t=e?.wkid??null,s=e?.wkt2??e?.wkt??null;let r=null;if(t)r=o.units[o[t]];else if(s){const e=se(s)?l:te(s)?m:null;if(e){const t=e.exec(s);t?.[1]&&(r=ie(t[1]))}}return null!=r?V(r):null}function X(e){const t=Q(e);return null!=t&&k.includes(t)?t:null}function Z(e){const t=j(e);return null!=t&&k.includes(t)?t:null}function ee(e){const t=Q(e);return null==t?null:b.get(t)}function te(e){return/^GEOCCS/i.test(e)}function se(e){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(e)}const re=1e-7;function ie(e){const t=/[\\"']{1}([^\\"']+)/.exec(e);let s=t?.[1];if(!s||!o.units.includes(s)){const t=z(e);s=null;const r=o.values;for(let e=0;e<r.length;++e)if(Math.abs(t-r[e])<re){s=o.units[e];break}}return s}function ne(e){const t=Q(e);if(null==t)return null;switch(t){case"feet":case"us-feet":case"clarke-feet":case"clarke-yards":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"benoit-1895-b-chains":case"indian-yards":case"indian-1937-yards":case"gold-coast-feet":case"sears-1922-truncated-chains":return"imperial";case"50-kilometers":case"150-kilometers":case"meters":return"metric"}return null}const ae={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},ue={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},ce={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},le=s.strict()(ae),oe=s.strict()(ue),me=s.strict()(ce);e.adaptiveAreaUnit=O,e.adaptiveImperialAreaUnit=A,e.adaptiveImperialLengthUnit=E,e.adaptiveImperialVerticalLengthUnit=N,e.adaptiveLengthUnit=I,e.adaptiveMetricAreaUnit=J,e.adaptiveMetricLengthUnit=T,e.adaptiveMetricVerticalLengthUnit=C,e.adaptiveVerticalLengthUnit=L,e.angleUnitsJSONMap=me,e.areaUnitFromSpatialReference=ee,e.areaUnitsJSONMap=le,e.baseUnitForUnit=_,e.baseUnitForUnitType=w,e.convertUnit=R,e.defaultAreaUnit=F,e.defaultLengthUnit=v,e.defaultVerticalLengthUnit=D,e.getDefaultUnitSystem=ne,e.getMetersPerCartesianUnitForSR=Y,e.getMetersPerUnit=H,e.getMetersPerUnitForSR=G,e.getMetersPerVerticalUnitForSR=W,e.getUnitString=Q,e.getVerticalUnitStringForSR=j,e.inchesPerMeter=u,e.isBaseUnit=P,e.isMeasurementSystem=M,e.isProjectedWKT=se,e.lengthToDegrees=K,e.lengthUnitFromSpatialReference=X,e.lengthUnitsJSONMap=oe,e.measurementAreaUnits=S,e.measurementLengthUnits=k,e.unitFromRESTJSON=V,e.unitToRESTJSON=x,e.unitType=y,e.verticalLengthUnitFromSpatialReference=Z,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
