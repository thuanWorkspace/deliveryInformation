/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../chunks/tslib.es6","../core/lang","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/accessorSupport/decorators/subclass","../core/accessorSupport/decorators/writer","../layers/support/fieldUtils","./Renderer","./mixins/VisualVariablesMixin","./support/DictionaryLoader"],(function(e,r,s,t,i,o,a,l,n,c){"use strict";var p;let u=p=class extends(n.VisualVariablesMixin(l)){constructor(e){super(e),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new c.DictionaryLoader(this.url,this.config,this.fieldMap)}writeData(e,r){e&&(r.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,r,s,t){t?.origin||super.writeVisualVariables(e,r,s,t)}clone(){return new p({config:r.clone(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:r.clone(this.fieldMap),url:r.clone(this.url),visualVariables:r.clone(this.visualVariables)})}async getSymbolAsync(e,r){return this._loader.getSymbolAsync(e,r)}async collectRequiredFields(e,r){await this.collectVVRequiredFields(e,r),this.scaleExpression&&await a.collectArcadeFieldNames(e,r,this.scaleExpression);for(const s in this.fieldMap){const t=this.fieldMap[s];r.has(t)&&e.add(t)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,r)=>e+r.getAttributeHash()),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};e.__decorate([s.property({type:c.DictionaryLoader})],u.prototype,"_loader",null),e.__decorate([s.property({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],u.prototype,"config",void 0),e.__decorate([s.property({type:Object,json:{write:!0}})],u.prototype,"fieldMap",void 0),e.__decorate([s.property({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],u.prototype,"scaleExpression",void 0),e.__decorate([o.writer("scaleExpression")],u.prototype,"writeData",null),e.__decorate([s.property({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],u.prototype,"scaleExpressionTitle",void 0),e.__decorate([s.property({type:String,json:{write:!0}})],u.prototype,"url",void 0),e.__decorate([o.writer("visualVariables")],u.prototype,"writeVisualVariables",null),u=p=e.__decorate([i.subclass("esri.renderers.DictionaryRenderer")],u);return u}));
