/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["require","../chunks/tslib.es6","../core/deprecate","../core/Logger","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass","./Widget","./Locate/LocateViewModel","./support/componentsUtils","./support/globalCss","./support/legacyIcon","./support/decorators/accessibleHandler","./support/decorators/messageBundle","./support/decorators/vmEvent","./support/jsxFactory","./support/widgetUtils"],(function(e,o,t,r,s,a,i,n,l,c,d,p,g,u,h,b,v,y,w){"use strict";const _={base:"esri-locate",widgetIcon:u.legacyIcon.northNavigation},m="gps-off",E="esri.widgets.Locate",M=r.getLogger(E);let L=class extends c{constructor(e,o){super(e,o),this.iconClass=_.widgetIcon,this.icon=null,this.messages=null,this.messagesCommon=null,this.viewModel=new d}loadDependencies(){return p.loadCalciteComponents({icon:()=>new Promise(((o,t)=>e(["../chunks/calcite-icon"],o,t))),loader:()=>new Promise(((o,t)=>e(["../chunks/calcite-loader"],o,t)))})}get geolocationOptions(){return this.viewModel.geolocationOptions}set geolocationOptions(e){this.viewModel.geolocationOptions=e}get goToLocationEnabled(){return this.viewModel.goToLocationEnabled}set goToLocationEnabled(e){this.viewModel.goToLocationEnabled=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(e){this.viewModel.popupEnabled=e}get rotationEnabled(){return this.viewModel.rotationEnabled}set rotationEnabled(e){this.viewModel.rotationEnabled=e}get scale(){return this.viewModel.scale}set scale(e){this.viewModel.scale=e}get useHeadingEnabled(){return t.deprecatedProperty(M,"useHeadingEnabled",{replacement:"rotationEnabled",version:"4.27",warnOnce:!0}),this.viewModel.rotationEnabled}set useHeadingEnabled(e){t.deprecatedProperty(M,"useHeadingEnabled",{replacement:"rotationEnabled",version:"4.27",warnOnce:!0}),this.viewModel.rotationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}cancelLocate(){this.viewModel.cancelLocate()}locate(){return this.viewModel.locate()}render(){const{state:e}=this.viewModel,o="locating"===e?this.messagesCommon.cancel:this.messages.title;return y.tsx("div",{"aria-label":o,bind:this,class:this.classes(_.base,g.globalCss.widget,g.globalCss.widgetButton,{[g.globalCss.disabled]:"disabled"===e,[g.globalCss.hidden]:"feature-unsupported"===e}),hidden:"feature-unsupported"===e,onclick:this._locate,onkeydown:this._locate,role:"button",tabIndex:0,title:o},this._renderIcon(),y.tsx("span",{class:u.legacyIcon.fontFallbackText},this.messages.title))}_renderIcon(){const{icon:e,iconClass:o,viewModel:t}=this;return"locating"===t?.state?y.tsx("calcite-loader",{inline:!0,key:"loader",label:"",scale:"s",type:"indeterminate"}):e?this._renderCalciteIcon(e):o&&o!==_.widgetIcon?this._renderLegacyIcon(o):this._renderCalciteIcon(m)}_renderCalciteIcon(e){return y.tsx("calcite-icon",{icon:e,key:"icon",scale:"s"})}_renderLegacyIcon(e){return y.tsx("span",{"aria-hidden":"true",class:e,key:"legacy-icon"})}_locate(){const{viewModel:e}=this;"locating"===e.state?e.cancelLocate():e.locate()}};o.__decorate([s.property()],L.prototype,"geolocationOptions",null),o.__decorate([s.property()],L.prototype,"goToLocationEnabled",null),o.__decorate([s.property()],L.prototype,"goToOverride",null),o.__decorate([s.property()],L.prototype,"graphic",null),o.__decorate([s.property()],L.prototype,"iconClass",void 0),o.__decorate([s.property()],L.prototype,"icon",void 0),o.__decorate([s.property()],L.prototype,"label",null),o.__decorate([s.property(),b.messageBundle("esri/widgets/Locate/t9n/Locate")],L.prototype,"messages",void 0),o.__decorate([s.property(),b.messageBundle("esri/t9n/common")],L.prototype,"messagesCommon",void 0),o.__decorate([s.property()],L.prototype,"popupEnabled",null),o.__decorate([s.property()],L.prototype,"rotationEnabled",null),o.__decorate([s.property()],L.prototype,"scale",null),o.__decorate([s.property()],L.prototype,"useHeadingEnabled",null),o.__decorate([s.property()],L.prototype,"view",null),o.__decorate([s.property({type:d}),v.vmEvent(["locate","locate-error"])],L.prototype,"viewModel",void 0),o.__decorate([h.accessibleHandler()],L.prototype,"_locate",null),L=o.__decorate([l.subclass(E)],L);return L}));
