/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["require","../../chunks/tslib.es6","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/has","../../core/accessorSupport/decorators/subclass","../Widget","./css","../support/componentsUtils","../support/widgetUtils","../support/decorators/messageBundle","../support/jsxFactory"],(function(e,t,s,o,r,l,a,i,c,n,d,p,u){"use strict";let h=class extends i{constructor(e,t){super(e,t),this.messages=null,this.closed=!1,this.closable=!0,this._handleOpenRelatedFeature=e=>{this.emit("open-related-feature",{feature:e})}}loadDependencies(){return n.loadCalciteComponents({action:()=>new Promise(((t,s)=>e(["../../chunks/calcite-action"],t,s))),"flow-item":()=>new Promise(((t,s)=>e(["../../chunks/calcite-flow-item"],t,s)))})}render(){const{flowItems:e}=this,t=e?.toArray();return u.tsx(u.tsxFragment,null,t?.map((e=>this._renderRelatedRecordsFlowItem(e))))}_handleCloseClick(){this.emit("close")}_handleExitClick(){this.emit("exit")}_handleRelatedRecordsBackClick(){const e=this.flowItems?.pop();e&&("showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy()))}_renderRelatedRecordsFlowItem(e){const{messages:t,closable:s,closed:o}=this,r="graphic"in e&&!e.isTable;return u.tsx("calcite-flow-item",{bind:this,closable:s,closed:o,description:this._getRelatedRecordsFlowItemDescription(e),heading:e.title??"",key:`flow-item-${e.viewModel.uid}`,onCalciteFlowItemBack:this._handleRelatedRecordsBackClick,onCalciteFlowItemClose:this._handleCloseClick},u.tsx("calcite-action",{appearance:"transparent",bind:this,class:c.css.actionExit,icon:"move-up",key:"exit-related-records-action",label:t.exitRelatedRecords,onclick:this._handleExitClick,scale:"m",slot:"header-actions-start",text:t.exitRelatedRecords,title:t.exitRelatedRecords}),r?u.tsx("calcite-action",{appearance:"transparent",bind:this,icon:"zoom-to-object",key:"open-related-feature-action",label:t.selectFeature,onclick:()=>this._handleOpenRelatedFeature(e),scale:"m",slot:"header-actions-end",text:t.selectFeature,title:t.selectFeature}):null,u.tsx("div",{class:c.css.container},e.render()))}_getRelatedRecordsFlowItemDescription(e){return"featureCountDescription"in e?e.featureCountDescription:e.viewModel.description??""}};t.__decorate([s.property()],h.prototype,"flowItems",void 0),t.__decorate([s.property(),p.messageBundle("esri/widgets/Features/t9n/Features")],h.prototype,"messages",void 0),t.__decorate([s.property()],h.prototype,"closed",void 0),t.__decorate([s.property()],h.prototype,"closable",void 0),h=t.__decorate([a.subclass("esri.widgets.Features.FeaturesRelatedRecords")],h);return h}));
