/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["require","../chunks/tslib.es6","../core/arrayUtils","../core/events","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/has","../core/accessorSupport/decorators/subclass","../intl/date","../time/timeZoneUtils","../webdoc/support/SlideThumbnail","./Widget","./Bookmarks/BookmarksUserState","./Bookmarks/BookmarksViewModel","./Bookmarks/css","./FeatureTable/Grid/support/ButtonMenu","./FeatureTable/Grid/support/ButtonMenuItem","./support/componentsUtils","./support/globalCss","./support/Heading","./support/legacyIcon","./support/widgetUtils","./support/decorators/messageBundle","./support/decorators/vmEvent","./support/jsxFactory","../chunks/sortable.esm"],(function(t,e,s,o,i,a,r,n,d,l,u,c,m,k,h,p,_,b,g,B,v,f,y,x,I,E,w){"use strict";function S(t,e,s){t.splice(s,0,t.splice(e,1)[0])}const C="bookmarks",T="data-bookmark-uid",A={addBookmark:!0,thumbnail:!0,time:!0},U=/^https:\/\/.*/i,M="esri.widgets.Bookmarks";let N=class extends m{constructor(t,e){super(t,e),this._tooltipReferenceMap=new Map,this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._addBookmarkButtonNode=null,this._focusAddBookmarkButton=!1,this._focusEditInputBox=!1,this._focusAddInputBox=!1,this._focusUrlEditInputBox=!1,this._sortable=null,this._sortableNode=null,this._focusSortUid=null,this._selectedSortUid=null,this._sortableSavedItems=[],this._editIncludeTimeExtent=void 0,this._userState=null,this.disabled=!1,this.editingEnabled=!1,this.headingLevel=2,this.iconClass=p.css.widgetIcon,this.icon=null,this.messages=null,this.messagesCommon=null,this.viewModel=new h,this.visibleElements={...A}}initialize(){this.addHandles([i.watch((()=>this.viewModel?.bookmarks),(()=>this._bookmarksInitialized()),i.initial),i.watch((()=>this.editingEnabled),(()=>this._toggleSorting()),i.initial)])}destroy(){this._destroySortable(),this._editMenu.destroy(),this._tooltipReferenceMap.clear()}loadDependencies(){return g.loadCalciteComponents({label:()=>new Promise(((e,s)=>t(["../chunks/calcite-label"],e,s))),switch:()=>new Promise(((e,s)=>t(["../chunks/calcite-switch"],e,s))),tooltip:()=>new Promise(((e,s)=>t(["../chunks/calcite-tooltip"],e,s)))})}get _editMenuItems(){const{messages:t,_userState:e}=this,o=e?.editedBookmark?.thumbnail?.url;return[new b({label:t?.menu.refreshThumbnail,iconClass:f.legacyIcon.refresh,clickFunction:()=>this._refreshThumbnail()}),new b({label:o&&U.test(o)?t?.menu.editImageUrl:t?.menu.useImageUrl,iconClass:f.legacyIcon.link,clickFunction:()=>this._startUseImageUrl()}),o?new b({label:t?.menu.removeThumbnail,iconClass:f.legacyIcon.erase,clickFunction:()=>this._removeThumbnail()}):null].filter(s.isSome)}get _editMenu(){const{_editMenuItems:t,messages:e,disabled:s}=this,o=this._get("_editMenu");o&&o.destroy();const i=new _({disabled:s,iconClass:f.legacyIcon.handleHorizontal,label:e?.menu.label});return i.items=t,i}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(t){this.viewModel.defaultCreateOptions=t}get defaultEditOptions(){return this.viewModel.defaultEditOptions}set defaultEditOptions(t){this.viewModel.defaultEditOptions=t}get bookmarks(){return this.viewModel.bookmarks}set bookmarks(t){this.viewModel.bookmarks=t}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}castVisibleElements(t){return{...A,...t}}endAddBookmark(){this._userState=null}goTo(t){return this.viewModel.goTo(t)}render(){const{state:t}=this.viewModel,e="loading"===t?this._renderLoading():this._renderBookmarks();return E.tsx("div",{class:this.classes(p.css.base,B.globalCss.widget,B.globalCss.panel,{[B.globalCss.widgetDisabled]:this.disabled})},e)}startAddBookmark(){this._userState=new k({state:"add"}),this._focusAddInputBox=!0,this.scheduleRender()}_renderBookmarkTooltips(t){return t.toArray().map((t=>this._renderBookmarkTooltip(t)))??[]}_renderBookmarkTooltip(t){const{_tooltipReferenceMap:e,messagesCommon:s}=this,o=this._getBookmarkTitle(t),i=`${s?.dragHandleTitle} ${o}`;return t?E.tsx("calcite-tooltip",{key:`tooltip-${t.uid}`,referenceElement:e.get(t.uid)},i):null}_renderLoading(){return E.tsx("div",{class:p.css.loaderContainer,key:"loader",tabIndex:this.disabled?-1:void 0},E.tsx("div",{class:p.css.loader}))}_renderNoBookmarksContainer(){const{messages:t,disabled:e}=this;return E.tsx("div",{class:B.globalCss.empty,key:"no-bookmarks",tabIndex:e?-1:void 0},E.tsx("span",{"aria-hidden":"true",class:this.classes(B.globalCss.noBookmarksIcon,p.css.widgetIcon)}),E.tsx(v.Heading,{class:this.classes(B.globalCss.heading,p.css.noBookmarksHeader),level:this.headingLevel},t?.noBookmarksHeading),E.tsx("p",{class:p.css.noBookmarksDescription},t?.noBookmarksDescription))}_renderAddBookmarkLoading(){return E.tsx("div",{class:p.css.addingBookmark,key:"adding-bookmark"},E.tsx("span",{"aria-hidden":"true",class:this.classes(f.legacyIcon.loadingIndicator,B.globalCss.rotating)}),this.messages?.addingBookmark)}_renderBookmarkItems(t){if(!t)return[];const{_userState:e,editingEnabled:s}=this;return t.map((t=>s&&t&&e&&("edit"===e.state||"edit-thumbnail"===e.state)&&e.bookmark===t?"edit-thumbnail"===e.state?this._renderEditingBookmarkUrl(e.editedBookmark):this._renderEditingBookmark(e.editedBookmark):this._renderBookmark(t))).toArray()}_renderBookmarksContainer(t){const{_userState:e,editingEnabled:s,disabled:o,view:i}=this,a="add"===e?.state,r=i&&s&&!a?this._renderAddBookmarkButton():null,n=s?a&&e.loading?this._renderAddBookmarkLoading():"add"===e?.state?this._renderAddingBookmark():null:null;return[E.tsx("ul",{afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"aria-label":this.messages?.widgetLabel,bind:this,class:this.classes(p.css.bookmarkList,{[p.css.bookmarkListSortable]:this.editingEnabled}),"data-node-ref":"_sortableNode",key:"bookmark-list",tabIndex:o?-1:void 0},this._renderBookmarkItems(t)),r,n]}_renderAddBookmarkButton(){return this.visibleElements.addBookmark?E.tsx("div",{class:p.css.addBookmark,key:"add-bookmark-item"},E.tsx("button",{afterCreate:this._storeAddBookmarkButton,afterUpdate:this._storeAddBookmarkButton,bind:this,class:this.classes(B.globalCss.button,B.globalCss.buttonTertiary,p.css.addBookmarkButton),"data-node-ref":"_addBookmarkButtonNode",disabled:this.disabled,onclick:this.startAddBookmark,type:"button"},E.tsx("span",{"aria-hidden":"true",class:this.classes(p.css.addBookmarkIcon,f.legacyIcon.plus)}),this.messages?.addBookmark)):null}_renderBookmarks(){const{bookmarks:t}=this.viewModel,e=t&&t.filter(Boolean),s=e&&e.length,o=s||this.editingEnabled?this._renderBookmarksContainer(e):null;return[s?null:this._renderNoBookmarksContainer(),o,this._renderBookmarkTooltips(t)]}_renderEditContainer(t){const{messagesCommon:e,disabled:s}=this,o=this._getBookmarkTitle(t);return E.tsx("div",{class:p.css.bookmarkEditButtonContainer,key:"edit-container"},E.tsx("button",{"aria-label":`${e?.edit} ${o}`,bind:this,class:p.css.bookmarkEditButton,"data-bookmark":t,disabled:s,onclick:this._showEditBookmarkForm,title:`${e?.edit} ${o}`,type:"button"},E.tsx("span",{"aria-hidden":"true",class:f.legacyIcon.edit})))}_renderDragHandle(t){const{messagesCommon:e,disabled:s}=this,o=this._getBookmarkTitle(t),i={[T]:t.uid};return E.tsx("div",{afterCreate:this._focusDragHandle,afterUpdate:this._focusDragHandle,"aria-label":`${e?.dragHandleTitle} ${o}`,"aria-pressed":this._selectedSortUid===t.uid?"true":"false",bind:this,class:p.css.bookmarkDragHandle,"data-bookmark":t,key:"drag-handle",onblur:this._dragHandleBlur,onkeydown:this._dragHandleKeydown,role:"button",tabIndex:s?-1:0,...i},E.tsx("span",{"aria-hidden":"true",class:this.classes(p.css.bookmarkDragHandleIcon,f.legacyIcon.handleVertical)}))}_renderBookmarkImageIcon(){return E.tsx("span",{"aria-hidden":"true",class:this.classes(p.css.bookmarkIcon,p.css.widgetIcon)})}_renderBookmarkImage(t){const{visibleElements:e}=this,{thumbnail:s}=t,o=s?.url||"";return e.thumbnail&&o?E.tsx("img",{alt:"",class:p.css.bookmarkImage,src:o}):null}_renderBookmarkTimeSwitch(t){const{messages:e,disabled:s}=this,{timeExtent:o}=t,{view:i}=this.viewModel;return i?.timeExtent??o?E.tsx("calcite-label",{layout:"inline-space-between"},e?.includeTimeExtent,E.tsx("calcite-switch",{checked:!!o,disabled:s,scale:"s",onCalciteSwitchChange:t=>{this._editIncludeTimeExtent=!!t.target.checked}})):null}_renderBookmarkTimeExtent(t){const{visibleElements:e}=this,{timeExtent:s}=t;return s?E.tsx("span",{class:p.css.timeExtent},[null!=s.start&&E.tsx("span",{class:p.css.timeExtentGroup,key:"start-date-group"},E.tsx("span",{class:p.css.timeExtentDate,key:"start-date"},this._formatDate(s.start)),e.time?E.tsx("span",{class:p.css.timeExtentTime,key:"start-time"},this._formatTime(s.start)):null),null!=s.end&&(null==s.start||s.start.getTime()!==s.end.getTime())&&E.tsx("span",{class:p.css.timeExtentGroup,key:"end-date-group"},E.tsx("span",{class:p.css.timeExtentDate,key:"end-date"},this._formatDate(s.end)),e.time?E.tsx("span",{class:p.css.timeExtentTime,key:"end-time"},this._formatTime(s.end)):null)]):null}_renderBookmarkButton(t){const{disabled:e}=this,{timeExtent:s}=t,{capabilities:o}=this.viewModel,i=this._getBookmarkTitle(t),{thumbnail:a}=t,r=E.tsx("div",{class:this.classes(p.css.bookmarkImageContainer,a?.url?p.css.bookmarkImageContainerHasImage:null)},this._renderBookmarkImage(t)||this._renderBookmarkImageIcon()),n=o.time&&s?E.tsx("span",{class:p.css.bookmarkTimeExtent,key:"time-extent"},this._renderBookmarkTimeExtent(t)):null;return E.tsx("button",{bind:this,class:p.css.bookmarkButton,"data-bookmark":t,disabled:e,key:"bookmark-button",onclick:this._goToBookmark,type:"button"},r,E.tsx("div",{class:p.css.bookmarkLabel},E.tsx("span",{class:p.css.bookmarkName,key:"bookmark-title"},i),n))}_renderBookmark(t){const{activeBookmark:e}=this.viewModel,s={[p.css.bookmarkActive]:e===t},o=this.editingEnabled?this._renderEditContainer(t):null,i={[T]:t.uid},a=this.editingEnabled?this._renderDragHandle(t):null;return E.tsx("li",{class:this.classes(p.css.bookmark,s),key:t,...i},a,this._renderBookmarkButton(t),o)}_renderEditingBookmarkName(t){const{messages:e,_userState:s,disabled:o}=this,i="name-required"===s?.validationState;return E.tsx("label",{class:this.classes({[p.css.authoringLabel]:!0,[p.css.authoringLabelStartPadding]:!!this.visibleElements?.thumbnail})},e?.title,i?E.tsx("strong",null,e?.invalidTitle):null,E.tsx("input",{afterCreate:this._storeEditInput,afterUpdate:this._focusEditInput,bind:this,class:this.classes(B.globalCss.input,i?p.css.authoringInputInvalid:null),"data-bookmark":t,"data-node-ref":"_editInputNode",disabled:o,placeholder:e?.titlePlaceholder,required:!0,type:"text",value:t.name}))}_renderEditingBookmarkUrlActions(){const{messagesCommon:t,disabled:e}=this;return E.tsx("div",{class:p.css.authoringActions},E.tsx("input",{bind:this,class:this.classes(B.globalCss.button,B.globalCss.buttonTertiary),disabled:e,onclick:this._closeUrlEditBookmarkForm,type:"button",value:t?.back}),E.tsx("input",{class:B.globalCss.button,disabled:e,type:"submit",value:t?.add}))}_renderEditingBookmarkActions(){const{messagesCommon:t,disabled:e}=this,s=this._userState?.bookmark;return E.tsx("div",{class:p.css.authoringActions},E.tsx("input",{bind:this,class:this.classes(B.globalCss.button,B.globalCss.buttonTertiary,p.css.authoringDeleteButton),"data-bookmark":s,disabled:e,onclick:this._deleteBookmark,type:"button",value:t?.delete}),E.tsx("input",{bind:this,class:this.classes(B.globalCss.button,B.globalCss.buttonTertiary),disabled:e,onclick:this._closeEditBookmarkForm,type:"button",value:t?.cancel}),E.tsx("input",{class:B.globalCss.button,disabled:e,type:"submit",value:t?.save}))}_renderEditingBookmarkUrlInput(t){const{messages:e,_userState:s,disabled:o}=this,i=t.thumbnail?.url,a=i&&U.test(i)?i:void 0,r="absolute-url-required"===s?.validationState;return E.tsx("label",{class:this.classes({[p.css.authoringLabel]:!0,[p.css.authoringLabelStartPadding]:!!this.visibleElements?.thumbnail})},r?E.tsx("strong",null,e?.invalidImageUrl):null,E.tsx("input",{afterCreate:this._storeUrlEditInput,afterUpdate:this._focusUrlEditInput,bind:this,class:this.classes(B.globalCss.input,r?p.css.authoringInputInvalid:null),"data-bookmark":t,"data-node-ref":"_urlEditInputNode",disabled:o,placeholder:e?`https://<${e.imageUrlPlaceholder}>`:void 0,required:!0,title:e?.imageUrlTooltip,type:"text",value:a}))}_renderEditingBookmarkUrl(t){if(!t)return null;const e={[T]:t.uid};return E.tsx("li",{class:p.css.authoringCard,key:"edit-bookmark-url-form",...e},E.tsx("form",{bind:this,class:p.css.authoringForm,disabled:this.disabled,onsubmit:this._editBookmarkUrlSubmit},this._renderEditingBookmarkUrlInput(t),this._renderEditingBookmarkUrlActions()))}_renderEditingBookmark(t){if(!t)return null;const e={[T]:t.uid},{capabilities:s}=this.viewModel,o=s.time?E.tsx("div",{class:p.css.timeExtentContainer,key:"edit-bookmark-time-container"},this._renderBookmarkTimeSwitch(t),this._editIncludeTimeExtent?this._renderBookmarkTimeExtent(t):null):null;return E.tsx("li",{class:p.css.authoringCard,key:"edit-bookmark-form",...e},E.tsx("form",{bind:this,class:p.css.authoringForm,disabled:this.disabled,onsubmit:this._editBookmarkSubmit},E.tsx("div",{class:p.css.authoringContainer},this.visibleElements.thumbnail?E.tsx("div",{class:p.css.bookmarkImageContainer},this._renderBookmarkImage(t),this._editMenu.render()):null,this._renderEditingBookmarkName(t)),o,this._renderEditingBookmarkActions()))}_renderAddingBookmarkName(){const{_userState:t,messages:e,disabled:s}=this,o="name-required"===t?.validationState;return E.tsx("label",{class:p.css.authoringLabel},e?.title,o?E.tsx("strong",null,e?.invalidTitle):null,E.tsx("input",{afterCreate:this._storeAddInput,afterUpdate:this._focusAddInput,bind:this,class:this.classes(B.globalCss.input,o?p.css.authoringInputInvalid:null),"data-node-ref":"_addInputNode",disabled:s,placeholder:e?.titlePlaceholder,required:!0,type:"text",value:""}))}_renderAddingBookmarkActions(){const{messagesCommon:t,disabled:e}=this;return E.tsx("div",{class:this.classes(p.css.authoringActions)},E.tsx("input",{bind:this,class:this.classes(B.globalCss.button,B.globalCss.buttonTertiary,p.css.authoringCancelButton),disabled:e,onclick:this._endAddBookmark.bind(this),type:"button",value:t?.cancel}),E.tsx("input",{class:B.globalCss.button,disabled:e,type:"submit",value:t?.add}))}_renderAddingBookmark(){return E.tsx("div",{class:p.css.authoringCard,key:"add-bookmark-form"},E.tsx("form",{bind:this,class:this.classes(p.css.authoringForm,p.css.authoringFormAdding),onsubmit:this._addBookmarkSubmit},this._renderAddingBookmarkName(),this._renderAddingBookmarkActions()))}_setTooltipReference(t,e){this._tooltipReferenceMap.set(e.uid,t),this.scheduleRender()}_getBookmarkTitle(t){return(t?.name||this.messagesCommon?.untitled)??""}_formatDate(t){return t?l.formatDate(t,{...l.convertDateFormatToIntlOptions("short-date"),timeZone:this.view?.timeZone??u.system}):""}_formatTime(t){return t?l.formatDate(t,{...l.convertDateFormatToIntlOptions("long-time"),timeZone:this.view?.timeZone??u.system}):""}_dragHandleBlur(){this._selectedSortUid=null,this.scheduleRender()}_dragHandleKeydown(t){const{_sortableSavedItems:e}=this,s=["ArrowDown","ArrowUp","Escape","Tab"," ","Enter"],i=o.eventKey(t);if(!s.includes(i))return;const{_sortable:a,_selectedSortUid:r}=this;if(!a)return;const n=a.toArray(),d=t.target.getAttribute(T),l=n.indexOf(d);if(y.isActivationKey(i)){const t=r&&r===d;return this._selectedSortUid=t?null:d,this._sortableSavedItems=t?[]:a.toArray(),void this.scheduleRender()}if("Tab"===i)return this._selectedSortUid=null,void this.scheduleRender();if("Escape"===i&&0!==e.length)return t.stopPropagation(),this._selectedSortUid=null,this._updateSortItems(e,a,d),void this.scheduleRender();if(-1===l||!r)return;const u="ArrowUp"===i?l-1:l+1;u>=n.length||u<=-1||(S(n,l,u),this._updateSortItems(n,a,d))}_updateSortItems(t,e,s){e.sort(t),this._sortBookmarks(e),this._focusSortUid=s,this._selectedSortUid=s}_focusDragHandle(t){const e=D(t);if(!e)return;this._setTooltipReference(t,e);const{_focusSortUid:s}=this;if(!t||!s)return;t.getAttribute(T)===s&&(t.focus(),this._focusSortUid=null)}_toggleSorting(){const{_sortable:t,_sortableNode:e,editingEnabled:s,disabled:o}=this;if(e)if(t)t.option("disabled",o||!s);else{const t=w.Sortable.create(e,{dataIdAttr:T,handle:`.${p.css.bookmarkDragHandle}`,group:C,disabled:o||!s,onSort:()=>this._sortBookmarks(t)});this._sortable=t}}_sortNodeCreated(t){this._sortableNode=t,this._toggleSorting()}_sortBookmarks(t){const{bookmarks:e}=this.viewModel;if(!e)return;const s=t.toArray();e.sort(((t,e)=>{const o=s.indexOf(t.uid),i=s.indexOf(e.uid);return o>i?1:o<i?-1:0}))}_destroySortable(){const{_sortable:t}=this;t&&t.destroy(),this._sortable=null}_endAddBookmark(){this._focusAddBookmarkButton=!0,this.endAddBookmark()}_bookmarksInitialized(){const t="bookmarks-init";this.removeHandles(t),this.addHandles(i.on((()=>this.viewModel?.bookmarks),"change",(()=>this._bookmarksChanged())),t)}_bookmarksChanged(){const t="bookmarks-change",{bookmarks:e}=this.viewModel;this.removeHandles(t);const s=e.map((t=>i.watch((()=>[t?.name,t?.thumbnail?.url]),(()=>this.scheduleRender()))));this.addHandles(s.toArray(),t),this.scheduleRender()}_showEditBookmarkForm(t){const e=D(t.currentTarget);e&&(this._editIncludeTimeExtent=!!e.timeExtent,this._focusEditInputBox=!0,this._userState=new k({bookmark:e,state:"edit"}),this.viewModel.goTo(e),this.scheduleRender())}_closeUrlEditBookmarkForm(){this._focusEditInputBox=!0,this._userState&&(this._userState.state="edit")}_closeEditBookmarkForm(){this._userState=null}_addBookmarkSubmit(t){t.preventDefault();const{_addInputNode:e,_userState:s}=this;if(!s)return;const o=e?e.value.trim():null;o?(s.loading=!0,this.viewModel.createBookmark().then((t=>{t.name=o,this.viewModel.bookmarks.add(t),this._endAddBookmark()}))):s.validationState="name-required"}async _editBookmarkAndClose(t,e){const{viewModel:s}=this;await s.editBookmark(t,{...s.defaultEditOptions,...e}),this._closeEditBookmarkForm()}_editBookmarkSubmit(t){t.preventDefault();const{_editInputNode:e,_userState:s,_editIncludeTimeExtent:o}=this;if(!s?.bookmark||!s.editedBookmark)return;const i=e&&e.value.trim();i?(s.bookmark.name=i,s.bookmark.thumbnail=s.editedBookmark.thumbnail,o||(s.bookmark.timeExtent=null),this._editBookmarkAndClose(s.bookmark,{takeScreenshot:!1,captureTimeExtent:o})):s.validationState="name-required"}_storeAddBookmarkButton(t){this._addBookmarkButtonNode=t,this._focusAddBookmark()}_storeEditInput(t){this._editInputNode=t,this._focusEditInput()}_storeAddInput(t){this._addInputNode=t,this._focusAddInput()}_storeUrlEditInput(t){this._urlEditInputNode=t,this._focusUrlEditInput()}_focusUrlEditInput(){this._urlEditInputNode&&this._focusUrlEditInputBox&&(this._focusUrlEditInputBox=!1,this._urlEditInputNode.focus())}_focusAddInput(){this._addInputNode&&this._focusAddInputBox&&(this._focusAddInputBox=!1,this._addInputNode.focus())}_focusAddBookmark(){this._addBookmarkButtonNode&&this._focusAddBookmarkButton&&(this._focusAddBookmarkButton=!1,this._addBookmarkButtonNode.focus())}_focusEditInput(){this._editInputNode&&this._focusEditInputBox&&(this._focusEditInputBox=!1,this._editInputNode.focus())}_deleteBookmark(t){const e=D(t.currentTarget);e&&this.viewModel.bookmarks.remove(e)}_goToBookmark(t){const e=D(t.currentTarget);e&&(this.endAddBookmark(),this._closeEditBookmarkForm(),this.viewModel.goTo(e))}async _refreshThumbnail(){const{_userState:t,_editMenu:e,viewModel:s}=this;t&&(t.validationState=void 0,await s.editBookmark(t.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1,captureTimeExtent:!1}),e.open=!1,this._focusEditInputBox=!0,this.scheduleRender())}_removeThumbnail(){const{_userState:t,_editMenu:e}=this;t?.editedBookmark&&(t.editedBookmark.thumbnail=null,t.validationState=void 0,e.open=!1,this._focusEditInputBox=!0,this.scheduleRender())}_startUseImageUrl(){this._userState&&(this._userState.state="edit-thumbnail"),this._editMenu.open=!1,this._focusUrlEditInputBox=!0,this.scheduleRender()}_editBookmarkUrlSubmit(t){t.preventDefault();const{_urlEditInputNode:e,_userState:s}=this;if(!e||!s)return;const o=e.value;U.test(o)?(o&&s.editedBookmark&&(s.editedBookmark.thumbnail=new c.SlideThumbnail({url:o})),this._closeUrlEditBookmarkForm()):s.validationState="absolute-url-required"}};function D(t){return t["data-bookmark"]}e.__decorate([a.property()],N.prototype,"_editIncludeTimeExtent",void 0),e.__decorate([a.property({type:k})],N.prototype,"_userState",void 0),e.__decorate([a.property({readOnly:!0})],N.prototype,"_editMenuItems",null),e.__decorate([a.property({readOnly:!0})],N.prototype,"_editMenu",null),e.__decorate([a.property()],N.prototype,"defaultCreateOptions",null),e.__decorate([a.property()],N.prototype,"defaultEditOptions",null),e.__decorate([a.property()],N.prototype,"bookmarks",null),e.__decorate([a.property()],N.prototype,"disabled",void 0),e.__decorate([a.property()],N.prototype,"editingEnabled",void 0),e.__decorate([a.property()],N.prototype,"headingLevel",void 0),e.__decorate([a.property()],N.prototype,"goToOverride",null),e.__decorate([a.property()],N.prototype,"iconClass",void 0),e.__decorate([a.property()],N.prototype,"icon",void 0),e.__decorate([a.property()],N.prototype,"label",null),e.__decorate([a.property(),x.messageBundle("esri/widgets/Bookmarks/t9n/Bookmarks")],N.prototype,"messages",void 0),e.__decorate([a.property(),x.messageBundle("esri/t9n/common")],N.prototype,"messagesCommon",void 0),e.__decorate([a.property()],N.prototype,"uiStrings",void 0),e.__decorate([a.property()],N.prototype,"view",null),e.__decorate([a.property({type:h}),I.vmEvent(["select-bookmark","bookmark-edit","bookmark-select"])],N.prototype,"viewModel",void 0),e.__decorate([a.property()],N.prototype,"visibleElements",void 0),e.__decorate([r.cast("visibleElements")],N.prototype,"castVisibleElements",null),e.__decorate([a.property()],N.prototype,"endAddBookmark",null),e.__decorate([a.property()],N.prototype,"startAddBookmark",null),N=e.__decorate([d.subclass(M)],N);return N}));
