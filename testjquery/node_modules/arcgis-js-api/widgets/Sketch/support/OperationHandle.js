/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../chunks/tslib.es6","../../../core/compilerUtils","../../../core/Evented","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/ensureType","../../../core/arrayUtils","../../../core/accessorSupport/decorators/subclass"],(function(e,t,o,r,a,p,n,d){"use strict";e.OperationHandle=class extends r.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:o.neverReached(this.activeComponent)}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){this.activeComponent?.reset()}refreshComponent(){const e=this.activeComponent;e&&("box"!==e.type&&"reshape"!==e.type&&"graphic-mover"!==e.type||e.refresh())}set undo(e){this._set("undo",(()=>{this.canUndo()&&e()}))}set redo(e){this._set("redo",(()=>{this.canRedo()&&e()}))}},t.__decorate([a.property()],e.OperationHandle.prototype,"activeComponent",void 0),t.__decorate([a.property()],e.OperationHandle.prototype,"cancelled",void 0),t.__decorate([a.property()],e.OperationHandle.prototype,"history",void 0),t.__decorate([a.property()],e.OperationHandle.prototype,"tool",null),t.__decorate([a.property()],e.OperationHandle.prototype,"type",void 0),t.__decorate([a.property()],e.OperationHandle.prototype,"canUndo",null),t.__decorate([a.property()],e.OperationHandle.prototype,"canRedo",null),t.__decorate([a.property()],e.OperationHandle.prototype,"onEnd",void 0),t.__decorate([a.property()],e.OperationHandle.prototype,"undo",null),t.__decorate([a.property()],e.OperationHandle.prototype,"redo",null),t.__decorate([a.property()],e.OperationHandle.prototype,"toggleTool",void 0),t.__decorate([a.property()],e.OperationHandle.prototype,"addToSelection",void 0),t.__decorate([a.property()],e.OperationHandle.prototype,"removeFromSelection",void 0),e.OperationHandle=t.__decorate([d.subclass("esri.widgets.Sketch.support.OperationHandle")],e.OperationHandle),e.CreateOperationHandle=class extends e.OperationHandle{},t.__decorate([a.property()],e.CreateOperationHandle.prototype,"activeComponent",void 0),e.CreateOperationHandle=t.__decorate([d.subclass("esri.widgets.Sketch.support.CreateOperationHandle")],e.CreateOperationHandle),e.UpdateOperationHandle=class extends e.OperationHandle{},t.__decorate([a.property()],e.UpdateOperationHandle.prototype,"activeComponent",void 0),e.UpdateOperationHandle=t.__decorate([d.subclass("esri.widgets.Sketch.support.UpdateOperationHandle")],e.UpdateOperationHandle),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
