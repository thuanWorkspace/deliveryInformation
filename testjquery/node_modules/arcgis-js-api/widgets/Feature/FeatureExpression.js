/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../../chunks/tslib.es6","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/has","../../core/accessorSupport/decorators/subclass","../Widget","./FeatureContent","./FeatureFields","./FeatureMedia","./FeatureExpression/FeatureExpressionViewModel","../support/globalCss","../support/legacyIcon","../support/widgetUtils","../support/jsxFactory"],(function(e,t,s,n,i,o,r,d,l,a,c,p,u,g,h,_){"use strict";const w="esri-feature",y={base:`${w}-expression`,loadingSpinnerContainer:`${w}__loading-container`,spinner:`${w}__loading-spinner`};let v=class extends d{constructor(e,t){super(e,t),this._contentWidget=null,this.viewModel=new p}initialize(){this.addHandles(t.watch((()=>this.viewModel?.contentElementViewModel),(()=>this._setupExpressionWidget()),t.initial))}destroy(){this._destroyContentWidget()}render(){const{state:e}=this.viewModel;return _.tsx("div",{class:y.base},"loading"===e?this._renderLoading():"disabled"===e?null:this._contentWidget?.render())}_renderLoading(){return _.tsx("div",{class:y.loadingSpinnerContainer,key:"loading-container"},_.tsx("span",{class:this.classes(g.legacyIcon.loadingIndicator,u.globalCss.rotating,y.spinner)}))}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,s=t?.type;this._destroyContentWidget();const n=e?"fields"===s?new a({viewModel:e}):"media"===s?new c({viewModel:e}):"text"===s?new l({viewModel:e}):null:null;this._contentWidget=n,this.scheduleRender()}};e.__decorate([s.property({type:p})],v.prototype,"viewModel",void 0),v=e.__decorate([r.subclass("esri.widgets.Feature.FeatureExpression")],v);return v}));
