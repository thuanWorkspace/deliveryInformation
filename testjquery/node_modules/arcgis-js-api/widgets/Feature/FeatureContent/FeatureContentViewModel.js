/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../../../chunks/tslib.es6","../../../Graphic","../../../core/Accessor","../../../core/reactiveUtils","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/ensureType","../../../core/arrayUtils","../../../core/has","../../../core/accessorSupport/decorators/subclass","../support/featureUtils"],(function(t,e,r,o,s,a,c,i,n,l){"use strict";let p=class extends r{constructor(t){super(t),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.addHandles(o.watch((()=>this.creator),(t=>{this._destroyContent(),this._createContent(t)}),o.initial))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:t,graphic:e,destroyer:r}=this;t&&e&&(l.graphicCallback(r,{graphic:e}).catch((()=>null)),this._set("created",null))}async _createContent(t){const e=this.graphic;if(!e||!t)return;const r=l.graphicCallback(t,{graphic:e}).catch((()=>null));this._loadingPromise=r,this.notifyChange("state");const o=await r;r===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",o))}};t.__decorate([s.property({readOnly:!0})],p.prototype,"created",void 0),t.__decorate([s.property()],p.prototype,"creator",void 0),t.__decorate([s.property()],p.prototype,"destroyer",void 0),t.__decorate([s.property({type:e})],p.prototype,"graphic",void 0),t.__decorate([s.property({readOnly:!0})],p.prototype,"state",null),p=t.__decorate([n.subclass("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],p);return p}));
