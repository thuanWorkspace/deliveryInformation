/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["require","../chunks/tslib.es6","../core/Collection","../core/events","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass","./Widget","./LayerList/LayerListViewModel","./LayerList/ListItem","./LayerList/support/layerListUtils","./support/componentsUtils","./support/globalCss","./support/legacyIcon","./support/decorators/accessibleHandler","./support/decorators/messageBundle","./support/decorators/vmEvent","./support/jsxFactory","./support/widgetUtils","../chunks/sortable.esm"],(function(e,t,i,s,n,o,l,a,r,c,d,h,g,u,p,_,m,b,y,I,v,C,f){"use strict";function S(e,t,i){e.splice(i,0,e.splice(t,1)[0])}const A=i.ofType(g),w="data-sort-filter",x="data-layer-uid",$="layerUid",k="esri-layer-list",T=`${k}__item`,M={base:k,widgetIcon:m.legacyIcon.layers,newUI:`${k}--new-ui`,noItems:`${k}__no-items`,list:`${k}__list`,listRoot:`${k}__list--root`,listExclusive:`${k}__list--exclusive`,listEmpty:`${k}__list--empty`,listEmptyState:`${k}__list-empty-state`,listEmptyStateDragEnabled:`${k}__list-empty-state--drag-enabled`,listInherited:`${k}__list--inherited`,listIndependent:`${k}__list--independent`,item:T,itemContent:`${T}-content`,itemMessage:`${T}--has-message`,itemInvisible:`${T}--invisible`,itemInvisibleAtScale:`${T}--invisible-at-scale`,itemChildren:`${T}--has-children`,itemSelectable:`${T}--selectable`,itemContainer:`${T}-container`,actionsMenu:`${T}-actions-menu`,actionsMenuItem:`${T}-actions-menu-item`,actionsMenuItemActive:`${T}-actions-menu-item--active`,actions:`${T}-actions`,actionsList:`${T}-actions-list`,action:`${T}-action`,actionIcon:`${T}-action-icon`,actionImage:`${T}-action-image`,actionTitle:`${T}-action-title`,actionToggle:`${k}__action-toggle`,actionToggleOn:`${k}__action-toggle--on`,label:`${T}-label`,message:`${T}-message`,title:`${T}-title`,statusIndicator:`${k}__status-indicator`,publishing:`${k}__publishing`,updating:`${k}__updating`,connectionStatus:`${k}__connection-status`,connectionStatusConnected:`${k}__connection-status--connected`,toggleVisible:`${T}-toggle`,toggleVisibleIcon:`${T}-toggle-icon`,toggleIcon:`${T}-toggle-icon`,radioIcon:`${T}-radio-icon`,childToggle:`${k}__child-toggle`,childToggleOpen:`${k}__child-toggle--open`,childOpened:`${k}__child-toggle-icon--opened`,childClosed:`${k}__child-toggle-icon--closed`,childClosed_RTL:`${k}__child-toggle-icon--closed-rtl`,sortableChosen:`${k}--chosen`},E={actions:"actions",actionSection:"action-section",items:"items"},L={exclusive:"exclusive",inherited:"inherited",independent:"independent"};function R(e){const{actionsOpen:t,children:i}=e;t&&(e.actionsOpen=!1),i.forEach((e=>R(e)))}const N="root",O={statusIndicators:!0,errors:!1};let U=class extends d{constructor(e,t){super(e,t),this._sortableNodes=new Map,this._sortableMap=new Map,this._focusSortUid=null,this._tooltipReferenceMap=new Map,this.visibleItems=null,this.iconClass=M.widgetIcon,this.icon=null,this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.messages=null,this.messagesCommon=null,this.multipleSelectionEnabled=!1,this.selectionEnabled=!1,this.selectedItems=new A,this.style="classic",this.viewModel=new h,this.visibleElements={...O},this._onSortableSort=({to:e,from:t,item:i,newIndex:s})=>{t&&e&&(t===e?this._sortLayers(this._sortableMap.get(t.dataset.group)):this._moveLayerFromChildList({to:e,from:t,item:i,newIndex:s}))},this._sortableCanSort=(e,t)=>!(!e.el.dataset.group||!t.el.dataset.group),this._sortableCanPull=(e,t,i)=>{const{listItemCanGiveFunction:s}=this,n={selected:V(i),from:V(t.el),to:V(e.el)};return!this._sortableCanSort(e,t)||"function"!=typeof s||s.call(null,n)},this._sortableCanPut=(e,t,i)=>{const{listItemCanReceiveFunction:s}=this,n={selected:V(i),from:V(t.el),to:V(e.el)};return!this._sortableCanSort(e,t)||"function"!=typeof s||s.call(null,n)},this._onSortableEnd=({oldIndex:e,from:t,to:i,item:s})=>{t!==i&&t.insertBefore(s,t.children[e])}}initialize(){const e=this.operationalItems;this._setVisibleItems(e),this.addHandles([n.on((()=>this.operationalItems),"change",(()=>this._itemsChanged(e))),n.watch((()=>this.visibleElements),(()=>this._itemsChanged(e))),n.watch((()=>this.selectionEnabled),(()=>this._toggleAllSorting()),n.initial)])}loadDependencies(){return p.loadCalciteComponents({icon:()=>new Promise(((t,i)=>e(["../chunks/calcite-icon"],t,i))),tooltip:()=>new Promise(((t,i)=>e(["../chunks/calcite-tooltip"],t,i)))})}destroy(){this._destroySortables(),this._tooltipReferenceMap.clear()}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...O,...e}}triggerAction(e,t){return this.viewModel.triggerAction(e,t)}render(){const{visibleItems:e,style:t}=this,i=this.viewModel?.state,s={[M.newUI]:"modern"===t,[_.globalCss.hidden]:"loading"===i,[_.globalCss.disabled]:"disabled"===i},n=this._renderItemTooltips(),o=this._renderItems();return v.tsx("div",{class:this.classes(M.base,_.globalCss.widget,_.globalCss.panel,s)},e.length?[n,o]:this._renderNoItems())}_renderItemTooltip(e){const{_tooltipReferenceMap:t,messages:i}=this;return e?v.tsx("calcite-tooltip",{referenceElement:t.get(e.uid)},i.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){const{incompatible:t,children:i}=e;return[t?this._renderItemTooltip(e):null,...!t&&i?i.toArray().map((e=>this._renderItemTooltipNodes(e))):[]]}_renderItemTooltips(){return this.visibleItems.toArray().map((e=>this._renderItemTooltipNodes(e)))??[]}_renderNoItems(){return v.tsx("div",{class:M.noItems},this.messages.noItemsToDisplay)}_renderItems(){const{visibleItems:e,selectionEnabled:t,messages:i}=this;return v.tsx("ul",{afterCreate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,afterUpdate:this._sortNodeCreated,"aria-label":i.widgetLabel,bind:this,class:this.classes(M.list,M.listRoot,M.listIndependent),"data-group":N,role:t?"listbox":void 0},e.map((e=>this._renderItem(e,null))).toArray())}_renderActionsMenuIcon(e,t){const{messagesCommon:i}=this,s={[M.actionsMenuItemActive]:e.actionsOpen};return v.tsx("div",{"aria-controls":t,"aria-label":i.options,bind:this,class:this.classes(M.actionsMenuItem,s),"data-item":e,key:"actions-menu-toggle",onclick:this._toggleActionsOpen,onkeydown:this._toggleActionsOpen,role:"button",tabIndex:0,title:i.options},v.tsx("span",{"aria-hidden":"true",class:m.legacyIcon.handleHorizontal}))}_renderActionsMenu(e,t,i,s){const{panel:n}=e,o=n&&n.visible?this._renderPanelButton(n):null,l=1===i&&this._getSingleActionButton(t),a=l?this._renderAction({item:e,action:l,singleAction:!0}):null,r=!l&&i?this._renderActionsMenuIcon(e,s):null;return r||o||l?v.tsx("div",{class:M.actionsMenu,key:"actions-menu"},o,a,r):null}_renderChildList(e,t){const{selectionEnabled:i}=this,{visibilityMode:s,children:n}=e,o=this._hasChildren(e),l=!o&&i&&"group"===e.layer?.type,{exclusive:a,inherited:r}=L,c={[M.listEmpty]:!o,[M.listExclusive]:s===a,[M.listInherited]:s===r,[M.listIndependent]:s!==r&&s!==a},d={[M.listEmptyState]:!0,[M.listEmptyStateDragEnabled]:i};return o||l?o?v.tsx("ul",{afterCreate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,afterUpdate:this._sortNodeCreated,"aria-expanded":e.open?"true":"false",bind:this,class:this.classes(M.list,c),"data-group":e.uid,"data-item":e,hidden:!e.open&&!l||null,id:t,key:"list-items",role:i?"listbox":s===a?"radiogroup":"group"},n?.map((t=>this._renderItem(t,e))).toArray()):v.tsx("div",{afterCreate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,afterUpdate:this._sortNodeCreated,bind:this,class:this.classes(d),"data-group":e.uid,"data-item":e,id:t,key:"list-items"},this.messages.noItemsToDisplay):null}_renderChildrenToggle(e,t){const{messagesCommon:i}=this,s=this._hasChildren(e),n={[M.childToggleOpen]:e.open},o=e.open?i.collapse:i.expand;return s?v.tsx("span",{"aria-controls":t,"aria-label":o,class:this.classes(M.childToggle,n),"data-item":e,key:"toggle-children",onclick:this._toggleChildrenClick,onkeydown:this._toggleChildrenClick,role:"button",tabIndex:0,title:o},v.tsx("span",{"aria-hidden":"true",class:this.classes(M.childClosed,m.legacyIcon.rightTriangleArrow)}),v.tsx("span",{"aria-hidden":"true",class:this.classes(M.childOpened,m.legacyIcon.downArrow)}),v.tsx("span",{"aria-hidden":"true",class:this.classes(M.childClosed_RTL,m.legacyIcon.leftTriangleArrow)})):null}_renderItemMessage(e){return e.error?v.tsx("div",{class:M.message,key:"esri-layer-list__error",role:"alert"},v.tsx("span",{"aria-hidden":"true",class:m.legacyIcon.noticeTriangle}),this.messages.layerError):e.incompatible?v.tsx("div",{class:M.message,key:"esri-layer-list__incompatible",role:"alert"},v.tsx("span",{afterCreate:t=>this._setTooltipReference(t,e),"aria-hidden":"true",bind:this,class:m.legacyIcon.noticeTriangle,tabIndex:0}),this.messages.layerIncompatible):null}_renderItemContent(e,t,i){const{id:s}=this,n=`${s}_${e.uid}`,o=`${n}_actions`,l=`${n}__list`,{panel:a}=e,r=this._filterActions(e.actionsSections),c=this._countActions(r);return[v.tsx("div",{class:M.itemContainer,key:"list-item-container"},this._renderChildrenToggle(e,l),this._renderLabel(e,t,i),this._renderActionsMenu(e,r,c,o)),this._renderItemMessage(e),c?this._renderActionsSections(e,r,o):null,a&&a.open&&!a.disabled?a.render():null,this._renderChildList(e,l)]}_renderItem(e,t){const{style:i,id:s,selectionEnabled:n,selectedItems:o}=this,l=`${`${s}_${e.uid}`}__title`,a=this._hasMessage(e),r=this._hasChildren(e),c={[M.itemChildren]:r,[M.itemMessage]:!!a,[M.itemInvisible]:"modern"===i&&!e.visible,[M.itemInvisibleAtScale]:!e.visibleAtCurrentScale,[M.itemSelectable]:n};if(n){const i={[x]:e.layer?.uid,[w]:(!e.sortable).toString()};return v.tsx("li",{afterCreate:this._focusListItem,afterUpdate:this._focusListItem,"aria-labelledby":l,"aria-selected":u.findSelectedItem(e,o)?"true":"false",bind:this,class:this.classes(M.item,c),"data-group":t?t.uid:N,"data-item":e,key:`item-with-selection-${e.uid}`,onclick:this._toggleSelection,onkeydown:this._selectionKeydown,role:"option",tabIndex:0,...i},this._renderItemContent(e,t,l))}return v.tsx("li",{afterCreate:this._focusListItem,afterUpdate:this._focusListItem,"aria-labelledby":l,bind:this,class:this.classes(M.item,c),key:`item-no-selection-${e.uid}`},this._renderItemContent(e,t,l))}_renderConnectionIcon(e){const{connectionStatus:t}=e;return null!=t?v.tsx("calcite-icon",{icon:"connected"===t?"beacon":"offline",scale:"s"}):null}_renderItemStatus(e,t){const{visibleElements:i}=this;if(!i.statusIndicators)return null;const{connectionStatus:s,publishing:n,updating:o}=e,l=o&&!t,a=!!s;return v.tsx("span",{class:this.classes({[M.statusIndicator]:!0,[M.publishing]:n,[M.updating]:l,[M.connectionStatus]:a,[M.connectionStatusConnected]:a&&"connected"===s}),key:"layer-item-status"},this._renderConnectionIcon(e))}_renderItemTitle(e,t){const{messages:i}=this;if(!e)return null;const s=e.title||i.untitledLayer,n=e.visibleAtCurrentScale?s:`${s} (${i.layerInvisibleAtScale})`;return v.tsx("span",{"aria-label":n,class:M.title,id:t,key:"layer-title-container",title:n},s)}_renderItemToggleIcon({visible:e},t){const{style:i}=this,{exclusive:s}=L,n=t?.visibilityMode,o="modern"===i,l=n===s,a={[M.toggleVisibleIcon]:o,[M.toggleIcon]:o&&!l,[M.radioIcon]:o&&l,[m.legacyIcon.radioChecked]:l&&e,[m.legacyIcon.radioUnchecked]:l&&!e,[m.legacyIcon.visible]:!l&&e,[m.legacyIcon.nonVisible]:!l&&!e};return v.tsx("span",{"aria-hidden":"true",class:this.classes(a),key:"item-toggle-icon"})}_renderItemToggle(e,t,i){const{selectionEnabled:s,messages:n}=this,{exclusive:o}=L,l=t?.visibilityMode,a=l===o?"radio":"switch";return s?v.tsx("span",{"aria-checked":e.visible?"true":"false","aria-labelledby":i,bind:this,class:M.toggleVisible,"data-item":e,"data-parent-visibility":l,key:"item-toggle-selection-enabled",onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,role:a,tabIndex:0,title:n.layerVisibility},this._renderItemToggleIcon(e,t)):v.tsx("span",{class:M.toggleVisible,key:"item-toggle"},this._renderItemToggleIcon(e,t))}_renderLabel(e,t,i){const{selectionEnabled:s,style:n,messages:o}=this,{inherited:l,exclusive:a}=L,r=t?.visibilityMode,c=r===a?"radio":"switch",d=this._renderItemTitle(e,i),h=this._renderItemStatus(e,t),g=this._renderItemToggle(e,t,i),u="modern"===n?[d,h,g]:[g,d,h],p=s?v.tsx("div",{class:M.label,key:`item-label-no-selection-${e.uid}`},u):v.tsx("div",{"aria-checked":e.visible?"true":"false","aria-labelledby":i,bind:this,class:M.label,"data-item":e,"data-parent-visibility":r,key:`item-label-with-selection-${e.uid}`,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,role:c,tabIndex:0,title:o.layerVisibility},u);return r===l||e.error?v.tsx("div",{class:M.label,key:`item-label-container-${e.uid}`},this._renderItemTitle(e,i),this._renderItemStatus(e,t)):p}_renderPanelButton(e){const{className:t,open:i,title:s,image:n,disabled:o}=e,l=n||t?t:m.legacyIcon.defaultAction,a=this._getIconImageStyles(e),r={[M.actionsMenuItemActive]:i&&!o},c={[M.actionImage]:!!a["background-image"],[_.globalCss.disabledElement]:e.disabled};return l&&(c[l]=!!l),v.tsx("div",{"aria-disabled":e.disabled.toString(),"aria-label":s,bind:this,class:this.classes(M.actionsMenuItem,r),"data-panel":e,key:`panel-${e.uid}`,onclick:this._triggerPanel,onkeydown:this._triggerPanel,role:"button",tabIndex:e.disabled?void 0:0,title:s},v.tsx("span",{class:this.classes(c),styles:a}))}_renderActionsSections(e,t,i){const s=t.toArray().map(((t,i)=>v.tsx("ul",{class:M.actionsList,key:`${e}-action-section-${i}`},this._renderActionSection(e,t))));return v.tsx("div",{"aria-expanded":e.actionsOpen?"true":"false",class:M.actions,hidden:!e.actionsOpen||null,id:i,key:"actions-section",role:"group"},s)}_renderActionSection(e,t){return(t&&t.toArray()).map((t=>this._renderAction({item:e,action:t})))}_renderActionIcon(e){const{active:t,className:i}=e,s=this._getIconImageStyles(e),n="button"!==e.type||e.image||i?i:m.legacyIcon.defaultAction,o={[M.actionImage]:!t&&!!s["background-image"],[m.legacyIcon.loadingIndicator]:t,[_.globalCss.rotating]:t};return n&&!t&&(o[n]=!0),v.tsx("span",{"aria-hidden":"true",class:this.classes(M.actionIcon,o),key:"action-icon",styles:s})}_renderActionTitle(e,t){return t?null:v.tsx("span",{class:M.actionTitle,key:"action-title"},e)}_renderAction(e){const{item:t,action:i,singleAction:s}=e,{active:n,disabled:o,title:l}=i,a={[M.actionsMenuItem]:s&&"button"===i.type,[M.action]:n||!s&&"toggle"!==i.type,[M.actionToggle]:!n&&"toggle"===i.type,[M.actionToggleOn]:!n&&"toggle"===i.type&&i.value,[_.globalCss.disabledElement]:o},r=[this._renderActionIcon(i),this._renderActionTitle(l,s)];return s?v.tsx("div",{"aria-label":l??void 0,bind:this,classes:a,"data-action":i,"data-item":t,key:`single-action-${i.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:0,title:l??void 0},r):v.tsx("li",{"aria-label":l??void 0,bind:this,classes:a,"data-action":i,"data-item":t,key:`action-${i.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:0,title:l??void 0},r)}_setTooltipReference(e,t){this._tooltipReferenceMap.set(t.uid,e),this.scheduleRender()}_hasMessage(e){return!!e.error||e.incompatible}_hasChildren(e){return!!e.children.length&&!this._hasMessage(e)}_sortNodeRemoved(e){const{_sortableMap:t}=this,i=e.dataset.group,s=t.get(i);s&&s.destroy(),t.delete(i)}_destroySortables(){const{_sortableMap:e,_sortableNodes:t}=this;e.forEach((e=>e&&e.destroy())),e.clear(),t.clear()}_moveLayerFromChildList({to:e,from:t,item:i,newIndex:s}){const n=V(i),o=V(e),l=V(t);this.viewModel.moveListItem(n,l,o,s)}_sortLayers(e){if(!e)return;const t=V(e.el),i=e.toArray();t?u.sortChildLayersToIds(t,i):u.sortLayersToIds(this.view?.map?.layers,i)}_toggleSorting(e,t){const{_sortableMap:i,selectionEnabled:s}=this,n=i.get(t),o=V(e),l=(t===N||o?.childrenSortable&&u.canSortSublayers(o))&&s;if(n)n.option("disabled",!l);else if(l){const s=f.Sortable.create(e,{dataIdAttr:x,group:{name:t,pull:this._sortableCanPull,put:this._sortableCanPut},filter:`[${w}="true"]`,fallbackTolerance:4,onSort:this._onSortableSort,onEnd:this._onSortableEnd,disabled:!l,chosenClass:M.sortableChosen});i.set(t,s)}}_toggleAllSorting(){this._sortableNodes.forEach(((e,t)=>this._toggleSorting(e,t)))}_sortNodeCreated(e){const t=e.dataset.group;t&&(this._sortableNodes.set(t,e),this._toggleSorting(e,t))}_setVisibleItems(e){this.visibleItems=e.filter((e=>!e.hidden&&(this.visibleElements.errors||!e.error)))}_getSingleActionButton(e){return e.reduce((e=>e)).filter((e=>e&&"button"===e.type)).at(0)}_focusListItem(e){const{_focusSortUid:t}=this;if(!e||!t)return;const i=V(e);i?.layer?.uid===t&&(e.focus(),this._focusSortUid=null)}_watchActionSectionChanges(e){this.addHandles(e.on("change",this.scheduleRender.bind(this)),E.actionSection),e.forEach((e=>this._renderOnActionChanges(e)))}_renderOnActionChanges(e){"toggle"!==e.type?"slider"!==e.type?this.addHandles(n.watch((()=>[e?.className,e?.image,e?.id,e?.title,e?.visible]),(()=>this.scheduleRender()),n.initial),E.actions):this.addHandles(n.watch((()=>[e?.className,e?.id,e?.title,e?.visible,e?.value,e?.displayValueEnabled,e?.max,e?.min,e?.step]),(()=>this.scheduleRender()),n.initial),E.actions):this.addHandles(n.watch((()=>[e?.className,e?.image,e?.id,e?.title,e?.visible,e?.value]),(()=>this.scheduleRender()),n.initial),E.actions)}_renderOnItemChanges(e){this.addHandles([n.watch((()=>[e?.actionsOpen,e?.visible,e?.open,e?.updating,e?.connectionStatus,e?.publishing,e?.title,e?.visibleAtCurrentScale,e?.error,e?.visibilityMode,e?.panel,e?.panel?.title,e?.panel?.content,e?.panel?.className,e?.sortable,e?.childrenSortable]),(()=>this.scheduleRender()),n.syncAndInitial),n.watch((()=>[e?.hidden,e?.error]),(()=>this._setVisibleItems(this.operationalItems))),e.actionsSections.on("change",(()=>this.scheduleRender())),e.children.on("change",(()=>this.scheduleRender()))],E.items),e.children.forEach((e=>this._renderOnItemChanges(e))),e.actionsSections.forEach((e=>this._watchActionSectionChanges(e)))}_itemsChanged(e){this.removeHandles(E.items),this.removeHandles(E.actions),this.removeHandles(E.actionSection),e.forEach((e=>this._renderOnItemChanges(e))),this._tooltipReferenceMap.clear(),this._setVisibleItems(e),this.scheduleRender()}_filterActions(e){return e.map((e=>e.filter((e=>e.visible))))}_countActions(e){return e.reduce(((e,t)=>e+t.length),0)}_getIconImageStyles(e){const t="esri.widgets.LayerList.ListItemPanel"===e.declaredClass||"esri.support.Action.ActionButton"===e.declaredClass||"esri.support.Action.ActionToggle"===e.declaredClass?e.image:null;return{"background-image":t?`url("${t}")`:void 0}}_selectionKeydown(e){const t=["ArrowDown","ArrowUp"],i=s.eventKey(e);if(!t.includes(i))return void this._toggleSelection(e);e.stopPropagation();const n=e.currentTarget,o=V(n),{_sortableMap:l,selectedItems:a}=this,r=n.dataset.group,c=l.get(r);if(!c||!o)return;const d=u.findSelectedItem(o,a),h=c.toArray(),g=e.target,p=h.indexOf(g.dataset[$]);if(-1!==p){if("ArrowDown"===i){const e=p+1;if(e>=h.length)return;d?(S(h,p,e),c.sort(h),this._sortLayers(c),this._focusSortUid=o.layer?.uid):(this._focusSortUid=o.layer?.uid,this.scheduleRender())}if("ArrowUp"===i){const e=p-1;if(e<=-1)return;d?(S(h,p,e),c.sort(h),this._sortLayers(c),this._focusSortUid=o.layer?.uid):(this._focusSortUid=o.layer?.uid,this.scheduleRender())}}}_toggleActionsOpen(e){const t=V(e.currentTarget);if(!t)return;const{actionsOpen:i}=t,s=!i;s&&this.operationalItems.forEach((e=>R(e))),t.actionsOpen=s,e.stopPropagation()}_triggerPanel(e){const t=P(e.currentTarget);e.stopPropagation(),t&&!t.disabled&&(t.open=!t.open)}_triggerAction(e){const t=e.currentTarget,i=H(t),s=V(t);i&&s&&("toggle"===i.type&&(i.value=!i.value),this.triggerAction(i,s),e.stopPropagation())}_toggleVisibility(e){const t=e.currentTarget,i=t.getAttribute("data-parent-visibility"),s=V(t);s&&(i===L.exclusive&&s.visible||(s.visible=!s.visible),e.stopPropagation())}_toggleChildrenClick(e){const t=V(e.currentTarget);t&&(t.open=!t.open,e.stopPropagation())}_toggleSelection(e){e.stopPropagation();const{multipleSelectionEnabled:t,selectedItems:i}=this,s=V(e.currentTarget);if(!s)return;const n=u.findSelectedItem(s,i),{length:o}=i;if(!t)return o&&!(n&&1===o)?(i.removeAll(),void i.add(s)):void(n?i.remove?.(n):i.add(s));n?i.remove?.(n):i.add(s)}get test(){return{visibleItems:this.visibleItems}}};function V(e){return e?.["data-item"]}function P(e){return e?.["data-panel"]}function H(e){return e?.["data-action"]}t.__decorate([o.property()],U.prototype,"visibleItems",void 0),t.__decorate([o.property()],U.prototype,"iconClass",void 0),t.__decorate([o.property()],U.prototype,"icon",void 0),t.__decorate([o.property()],U.prototype,"label",null),t.__decorate([o.property()],U.prototype,"listItemCanGiveFunction",void 0),t.__decorate([o.property()],U.prototype,"listItemCanReceiveFunction",void 0),t.__decorate([o.property()],U.prototype,"listItemCreatedFunction",null),t.__decorate([o.property(),y.messageBundle("esri/widgets/LayerList/t9n/LayerList")],U.prototype,"messages",void 0),t.__decorate([o.property(),y.messageBundle("esri/t9n/common")],U.prototype,"messagesCommon",void 0),t.__decorate([o.property()],U.prototype,"multipleSelectionEnabled",void 0),t.__decorate([o.property()],U.prototype,"operationalItems",null),t.__decorate([o.property()],U.prototype,"selectionEnabled",void 0),t.__decorate([o.property()],U.prototype,"selectedItems",void 0),t.__decorate([o.property()],U.prototype,"style",void 0),t.__decorate([o.property()],U.prototype,"view",null),t.__decorate([I.vmEvent("trigger-action"),o.property({type:h})],U.prototype,"viewModel",void 0),t.__decorate([o.property()],U.prototype,"visibleElements",void 0),t.__decorate([l.cast("visibleElements")],U.prototype,"castVisibleElements",null),t.__decorate([b.accessibleHandler()],U.prototype,"_toggleActionsOpen",null),t.__decorate([b.accessibleHandler()],U.prototype,"_triggerPanel",null),t.__decorate([b.accessibleHandler()],U.prototype,"_triggerAction",null),t.__decorate([b.accessibleHandler()],U.prototype,"_toggleVisibility",null),t.__decorate([b.accessibleHandler()],U.prototype,"_toggleChildrenClick",null),t.__decorate([b.accessibleHandler()],U.prototype,"_toggleSelection",null),U=t.__decorate([c.subclass("esri.widgets.LayerList")],U);return U}));
