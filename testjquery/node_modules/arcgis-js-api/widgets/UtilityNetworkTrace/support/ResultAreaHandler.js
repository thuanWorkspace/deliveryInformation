/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../Graphic","../../../layers/GraphicsLayer","../../../symbols/SimpleFillSymbol","./GeometryHandler"],(function(e,r,t,a,o){"use strict";const n=`utility-network-trace-result-area-${Date.now()}`;function l(e){return"graphics"===e.type}class i{constructor(){this.traceInformation={},this._geometryHandler=new o.GeometryHandler}addResultAreaToMap(e,r){const t=this.createGraphicLayer(r);t&&l(t)&&t.add(e)}changeResultAreaColor(e,r,t){const o=this._findGraphicsByTraceId(e,t);o&&o.forEach((e=>{const t=new a({color:r.color,style:"solid",outline:{color:r.color,width:1}});e.symbol=t}))}createBuffer(e,r,t,a){return this._geometryHandler.createBuffer(e,r,t,a)}createConvexHull(e,r,t){const a=this._geometryHandler.createConvexHull(e);return r>0&&a?this.createBuffer(a,[r],t,!1):a}createResultAreaGraphic(e,t,o,n,l,i){const s=new a({color:i.color,style:"solid",outline:{color:i.color,width:1}}),c=[];for(const r in t)c.push({fieldName:r,label:"areaStatistic"===r?n.attributeStrings[r]+" ("+l.units[o]?.abbr+")":n.attributeStrings[r],value:t[r]});return new r({geometry:e,symbol:s,attributes:t,popupTemplate:{title:t.traceName,content:[{type:"fields",fieldInfos:c}]}})}removeResultArea(e,r){const t=r.findLayerById(n);if(t&&l(t)){const a=this._findGraphicsByTraceId(e,r);return a&&t.removeMany(a),a}return null}removeAllResultAreaGraphics(e){if(e){const r=e.findLayerById(n);r&&l(r)&&r.removeAll()}}createGraphicLayer(e,r){const a=e.findLayerById(n);if(a&&l(a))return a;const o=new t({title:r??n,listMode:"hide",id:n});return e.add(o),o}_findGraphicsByTraceId(e,r){const t=r.findLayerById(n);if(t&&l(t)){const r=t.graphics.filter((r=>r.attributes.traceId===e));return r.length>0?r.toArray():null}return null}}e.ResultAreaHandler=i,e.resultAreaGraphicLayer=n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
