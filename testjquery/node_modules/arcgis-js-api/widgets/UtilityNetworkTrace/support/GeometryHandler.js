/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["exports","../../../geometry","../../../geometry/geometryEngine","../../../geometry/Polyline","../../../geometry/projection","../../../geometry/SpatialReference"],(function(e,t,r,n,o,a){"use strict";function i(e){return"polygon"===e.type||"polyline"===e.type}function l(e){return e.hasOwnProperty("points")}function s(e){return l(e)&&2===e.points.length}class c{createBuffer(e,t,n,o){if(Array.isArray(e)){if(e.length>0){const i=a.fromJSON(e[0].spatialReference);return i.isWGS84||i.isWebMercator?r.geodesicBuffer(e,t,n):r.buffer(e,t,n,o)}return}const i=a.fromJSON(e.spatialReference);return i.isWGS84||i.isWebMercator?r.geodesicBuffer(e,t[0],n):r.buffer(e,t[0],n)}createConvexHull(e){if(Array.isArray(e)){if(1===e.length&&s(e[0])){const t=r.convexHull(e[0]);if(i(t))return t}return r.convexHull(e,!0).filter(i)}const t=r.convexHull(e);if(i(t))return t}calculateArea(e,t){const n=new a({wkid:e.spatialReference.wkid});return n.isWGS84||n.isWebMercator?parseFloat(r.geodesicArea(e,t).toFixed(2)):parseFloat(r.planarArea(e,t).toFixed(2))}mergeAggregatedToGeometries(e){const t=[],{line:r,multipoint:n,polygon:o}=e;return r&&t.push(r),n&&t.push(n),o&&t.push(o),t}getPercentageAlong(e,t,n){let a=e;const i=this._createPolyline(e.paths,n.wkid);if("point"===t.type){const e=t.x-5,l=t.x+5,s=[[e,t.y-5],[l,t.y+5]];a=this._createPolyline(s,t.spatialReference.wkid);a=o.project(a,n);const c=r.cut(i,a);if(c.length>0){const e=r.planarLength(i,"feet");let t;t=c[0].paths[0][0][0]===i.paths[0][0][0]?r.planarLength(c[0],"feet"):r.planarLength(c[1],"feet");return[t/e]}return[.5]}a=o.project(t,n);const l=r.cut(i,a);if(l.length>0){const e=r.planarLength(i,"feet");return[r.planarLength(l[0],"feet")/e]}return[.5]}async projectGeometry(e,t){return await o.load(),o.project(e,t)}_createPolyline(e,t){return new n({hasZ:!1,hasM:!0,paths:e,spatialReference:{wkid:t}})}}e.GeometryHandler=c,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
