/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../chunks/tslib.es6","../core/promiseUtils","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass","./Widget","./Spinner/SpinnerViewModel","./support/widgetUtils","./support/jsxFactory"],(function(e,i,t,s,o,n,r,l,a,c,p,h){"use strict";const d="esri-spinner",v={base:d,spinnerStart:`${d}--start`,spinnerFinish:`${d}--finish`};let u=class extends a{constructor(e,i){super(e,i),this._animationDelay=500,this._animationPromise=null,this.viewModel=new c}initialize(){this.addHandles(t.watch((()=>this.visible),(e=>this._visibleChange(e))))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:i,promise:t}=e??{};i&&(this.viewModel.location=i),this.visible=!0;const s=()=>this.hide();t&&t.catch((()=>{})).then(s)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:i}=this.viewModel,t=!!i,s=e&&t,o=!e&&t,n={[v.spinnerStart]:s,[v.spinnerFinish]:o},r=this._getPositionStyles();return h.tsx("div",{class:this.classes(v.base,n),styles:r})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const t=i.after(this._animationDelay);this._animationPromise=t,t.catch((()=>{})).then((()=>{this._animationPromise===t&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)}))}_getPositionStyles(){const{screenLocation:e,view:i}=this.viewModel;if(null==i||null==e)return{};const{padding:t}=i;return{left:e.x-t.left+"px",top:e.y-t.top+"px"}}};e.__decorate([s.property()],u.prototype,"location",null),e.__decorate([s.property()],u.prototype,"view",null),e.__decorate([s.property({type:c})],u.prototype,"viewModel",void 0),e.__decorate([s.property()],u.prototype,"visible",null),u=e.__decorate([l.subclass("esri.widgets.Spinner")],u);return u}));
