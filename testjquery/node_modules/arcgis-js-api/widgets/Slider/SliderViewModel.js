/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../../chunks/tslib.es6","../../core/Accessor","../../core/Error","../../core/Logger","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/has","../../core/accessorSupport/decorators/subclass"],(function(e,t,i,r,s,o,n,l,a){"use strict";let u=class extends t{constructor(e){super(e),this.precision=4,this.thumbsConstrained=!0}set effectiveMax(e){this.setEffectiveMax(e)}set effectiveMin(e){this.setEffectiveMin(e)}set labelFormatFunction(e){this._set("labelFormatFunction",e)}set inputFormatFunction(e){this._set("inputFormatFunction",e)}set inputParseFunction(e){this._set("inputParseFunction",e)}get labels(){const{max:e,min:t,values:i}=this,r=i?.length?i.map(((e,t)=>this.getLabelForValue(e,"value",t))):[];return{max:this.getLabelForValue(e,"max"),min:this.getLabelForValue(t,"min"),values:r}}set max(e){this.setMax(e)}set min(e){this.setMin(e)}get state(){const{max:e,min:t}=this;return null!=e&&null!=t&&e>t?"ready":"disabled"}set values(e){const{max:t,min:i}=this,r=this.values;r&&e&&r.length===e.length&&r.every(((t,i)=>t===e[i]))||(this._set("values",null),e?.length&&(null!=i&&e.some((e=>e<i))&&(this.min=Math.min(...e)),null!=t&&e.some((e=>e>t))&&(this.max=Math.max(...e))),this._set("values",e))}toPrecision(e){return parseFloat(e.toFixed(this.precision))}defaultLabelFormatFunction(e){const{max:t,min:i,precision:r}=this,s=null!=t&&null!=i&&t-i>10?2:r;return parseFloat(e.toFixed(s)).toString()}defaultInputFormatFunction(e){return e.toString()}defaultInputParseFunction(e){return parseFloat(e)}getBounds(){const{effectiveMax:e,effectiveMin:t,max:i,min:r}=this;return{min:null!=t&&null!=r?Math.max(r,t):r,max:null!=e&&null!=i?Math.min(i,e):i}}getBoundsForValueAtIndex(e){const{thumbsConstrained:t,values:i}=this,{min:r,max:s}=this.getBounds();if(t&&i){const t=e-1,o=e+1;return{min:null!=i[t]?i[t]:r,max:null!=i[o]?i[o]:s}}return{min:r,max:s}}getLabelForValue(e,t,i){return null==e?null:this.labelFormatFunction?this.labelFormatFunction(e,t,i):this.defaultLabelFormatFunction(e)}setMax(e){const{max:t,values:i}=this;if(null==e)return void this._set("max",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'max' is NaN.");const r=this.toPrecision(e);if(t!==r&&(this._set("max",r),i?.length))for(let s=0;s<i.length;s++)r<i[s]&&this.setValue(s,r)}setMin(e){const{min:t,values:i}=this;if(null==e)return void this._set("min",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'min' is NaN.");const r=this.toPrecision(e);if(t!==r&&(this._set("min",r),i?.length))for(let s=0;s<i.length;s++)r>i[s]&&this.setValue(s,r)}setEffectiveMax(e){if(null==e)return void this._set("effectiveMax",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMax' is NaN.");const t=this.toPrecision(e);this.effectiveMax!==t&&this._set("effectiveMax",this._applyBoundsToValue(t))}setEffectiveMin(e){if(null==e)return void this._set("effectiveMin",null);if(isNaN(e))return void this._logError("slider:invalid-value","Supplied value for property 'effectiveMin' is NaN.");const t=this.toPrecision(e);this.effectiveMin!==t&&this._set("effectiveMin",this._applyBoundsToValue(t))}setValue(e,t){if(isNaN(t))return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is NaN.");const{values:i}=this;if(null==i)return void this._logError("slider:invalid-value","Supplied value for member of property 'values' is null.");const r=i[e],s=this.toPrecision(t);if(r===s)return;const o=[...i];o[e]=s,this._set("values",o),this.notifyChange("labels")}_applyBoundsToValue(e){const{max:t,min:i}=this;return null!=i&&e<i?i:null!=t&&e>t?t:e}_logError(e,t,s){r.getLogger(this).error(new i(e,t,s))}};e.__decorate([s.property()],u.prototype,"effectiveMax",null),e.__decorate([s.property()],u.prototype,"effectiveMin",null),e.__decorate([s.property()],u.prototype,"labelFormatFunction",null),e.__decorate([s.property()],u.prototype,"inputFormatFunction",null),e.__decorate([s.property()],u.prototype,"inputParseFunction",null),e.__decorate([s.property({readOnly:!0})],u.prototype,"labels",null),e.__decorate([s.property()],u.prototype,"max",null),e.__decorate([s.property()],u.prototype,"min",null),e.__decorate([s.property()],u.prototype,"precision",void 0),e.__decorate([s.property({readOnly:!0})],u.prototype,"state",null),e.__decorate([s.property()],u.prototype,"thumbsConstrained",void 0),e.__decorate([s.property()],u.prototype,"values",null),u=e.__decorate([a.subclass("esri.widgets.Slider.SliderViewModel")],u);return u}));
