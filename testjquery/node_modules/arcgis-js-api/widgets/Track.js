/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["require","../chunks/tslib.es6","../core/deprecate","../core/Logger","../core/accessorSupport/decorators/property","../core/accessorSupport/ensureType","../core/arrayUtils","../core/has","../core/accessorSupport/decorators/subclass","./Widget","./support/componentsUtils","./support/globalCss","./support/legacyIcon","./support/decorators/accessibleHandler","./support/decorators/messageBundle","./support/decorators/vmEvent","./support/jsxFactory","./support/widgetUtils","./Track/TrackViewModel"],(function(e,t,o,r,s,a,i,n,l,c,d,p,g,u,h,w,v,y,b){"use strict";const _={base:"esri-track",widgetIcon:g.legacyIcon.tracking},k="compass-north-circle",M="esri.widgets.Track",T=r.getLogger(M);let E=class extends c{constructor(e,t){super(e,t),this.iconClass=_.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new b}loadDependencies(){return d.loadCalciteComponents({icon:()=>new Promise(((t,o)=>e(["../chunks/calcite-icon"],t,o))),loader:()=>new Promise(((t,o)=>e(["../chunks/calcite-loader"],t,o)))})}get geolocationOptions(){return this.viewModel.geolocationOptions}set geolocationOptions(e){this.viewModel.geolocationOptions=e}get goToLocationEnabled(){return this.viewModel.goToLocationEnabled}set goToLocationEnabled(e){this.viewModel.goToLocationEnabled=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get rotationEnabled(){return this.viewModel.rotationEnabled}set rotationEnabled(e){this.viewModel.rotationEnabled=e}get scale(){return this.viewModel.scale}set scale(e){this.viewModel.scale=e}get tracking(){return this.viewModel.tracking}get useHeadingEnabled(){return o.deprecatedProperty(T,"useHeadingEnabled",{replacement:"rotationEnabled",version:"4.27",warnOnce:!0}),this.viewModel.rotationEnabled}set useHeadingEnabled(e){o.deprecatedProperty(T,"useHeadingEnabled",{replacement:"rotationEnabled",version:"4.27",warnOnce:!0}),this.viewModel.rotationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}start(){this.viewModel.start()}stop(){this.viewModel.stop()}render(){const e=this.viewModel?.state,t={[p.globalCss.disabled]:"disabled"===e,[p.globalCss.hidden]:"feature-unsupported"===e},o="tracking"===e,{messages:r}=this,s=(o?r?.stopTracking:r?.startTracking)??"";return v.tsx("div",{"aria-label":s,bind:this,class:this.classes(_.base,p.globalCss.widget,p.globalCss.widgetButton,t),hidden:"feature-unsupported"===e,onclick:this._toggleTracking,onkeydown:this._toggleTracking,role:"button",tabIndex:0,title:s},this._renderIcon(),v.tsx("span",{class:g.legacyIcon.fontFallbackText},s))}_renderIcon(){const{icon:e,iconClass:t,viewModel:o}=this;switch(o?.state){case"waiting":return v.tsx("calcite-loader",{inline:!0,key:"loader",label:"",scale:"s",type:"indeterminate"});case"tracking":return this._renderCalciteIcon("pause");default:return e?this._renderCalciteIcon(e):t&&t!==_.widgetIcon?this._renderLegacyIcon(t):this._renderCalciteIcon(k)}}_renderCalciteIcon(e){return v.tsx("calcite-icon",{icon:e,key:"icon",scale:"s"})}_renderLegacyIcon(e){return v.tsx("span",{"aria-hidden":"true",class:e,key:"legacy-icon"})}_toggleTracking(){const e=this.viewModel;e&&"feature-unsupported"!==e.state&&"disabled"!==e.state&&("tracking"!==e.state&&"waiting"!==e.state?this.viewModel.start():this.viewModel.stop())}};t.__decorate([s.property()],E.prototype,"geolocationOptions",null),t.__decorate([s.property()],E.prototype,"goToLocationEnabled",null),t.__decorate([s.property()],E.prototype,"goToOverride",null),t.__decorate([s.property()],E.prototype,"graphic",null),t.__decorate([s.property()],E.prototype,"iconClass",void 0),t.__decorate([s.property()],E.prototype,"icon",void 0),t.__decorate([s.property()],E.prototype,"label",null),t.__decorate([s.property(),h.messageBundle("esri/widgets/Track/t9n/Track")],E.prototype,"messages",void 0),t.__decorate([s.property()],E.prototype,"rotationEnabled",null),t.__decorate([s.property()],E.prototype,"scale",null),t.__decorate([s.property({readOnly:!0})],E.prototype,"tracking",null),t.__decorate([s.property()],E.prototype,"useHeadingEnabled",null),t.__decorate([s.property()],E.prototype,"view",null),t.__decorate([s.property({type:b}),w.vmEvent(["track","track-error"])],E.prototype,"viewModel",void 0),t.__decorate([u.accessibleHandler()],E.prototype,"_toggleTracking",null),E=t.__decorate([l.subclass(M)],E);return E}));
