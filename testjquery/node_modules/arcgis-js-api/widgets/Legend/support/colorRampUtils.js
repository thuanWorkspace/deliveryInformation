/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["require","exports","../../../Color","./utils"],(function(l,e,o,t){"use strict";const n=new o([64,64,64]);function r(l,e){const o=[],n=l.length-1;return 5===l.length?o.push(0,2,4):o.push(0,n),l.map(((l,r)=>o.includes(r)?t.createStopLabel(l,r,n,e):null))}async function a(e,o,t){let n=!1,a=[],s=[];if(e.stops){const l=e.stops;a=l.map((l=>l.value)),n=l.some((l=>!!l.label)),n&&(s=l.map((l=>l.label)))}const i=a[0],c=a[a.length-1];if(null==i&&null==c)return null;const p=n?null:r(a,t);return(await Promise.all(a.map((async(t,r)=>({value:t,color:"opacity"===e.type?await u(t,e,o):(await new Promise(((e,o)=>l(["../../../renderers/visualVariables/support/visualVariableUtils"],e,o)))).getColor(e,t),label:n?s[r]:p?.[r]??""}))))).reverse()}async function u(e,t,r){const a=new o(r??n),u=(await new Promise(((e,o)=>l(["../../../renderers/visualVariables/support/visualVariableUtils"],e,o)))).getOpacity(t,e);return null!=u&&(a.a=u),a}function s(l){let e=!1,o=[],t=[];o=l.map((l=>l.value)),e=l.some((l=>!!l.label)),e&&(t=l.map((l=>l.label??"")));const n=o[0],a=o[o.length-1];if(null==n&&null==a)return null;const u=e?null:r(o);return o.map(((o,n)=>({value:o,color:i(o,l),label:e?t[n]:u?.[n]??""}))).reverse()}function i(l,e){const{startIndex:t,endIndex:n,weight:r}=c(l,e);if(t===n)return e[t].color;const a=o.blendColors(e[t].color,e[n].color,r);return new o(a)}function c(l,e){let o=0,t=e.length-1;return e.some(((e,n)=>l<e.value?(t=n,!0):(o=n,!1))),{startIndex:o,endIndex:t,weight:(l-e[o].value)/(e[t].value-e[o].value)}}function p(l,e){let t=[];if(l&&"multipart"===l.type)l.colorRamps.reverse().forEach(((n,r)=>{0===r?t.push({value:e.max,color:new o(n.toColor),label:"high"}):t.push({value:null,color:new o(n.toColor),label:""}),r===l.colorRamps.length-1?t.push({value:e.min,color:new o(n.fromColor),label:"low"}):t.push({value:null,color:new o(n.fromColor),label:""})}));else{let n,r;l&&"algorithmic"===l.type?(n=l.fromColor,r=l.toColor):(n=[0,0,0,1],r=[255,255,255,1]),t=[{value:e.max,color:new o(r),label:"high"},{value:e.min,color:new o(n),label:"low"}]}return t}e.getColorFromPointCloudStops=i,e.getRampStops=a,e.getRampStopsForPointCloud=s,e.getStrectchRampStops=p,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
