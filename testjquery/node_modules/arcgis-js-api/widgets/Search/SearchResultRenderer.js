/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
define(["../../chunks/tslib.es6","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/arrayUtils","../../core/has","../../core/accessorSupport/decorators/subclass","../Widget","./searchResultRendererCSS","./SearchViewModel","../support/globalCss","../support/decorators/accessibleHandler","../support/decorators/messageBundle","../support/jsxFactory","../support/widgetUtils"],(function(e,s,r,t,l,o,i,u,n,c,a,d,h,_){"use strict";let p=class extends i{constructor(e,s){super(e,s),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}destroy(){this.viewModel=null}render(){const e={[u.css.showMoreResults]:this.showMoreResultsOpen};return h.tsx("div",{class:this.classes(u.css.base,c.globalCss.widget)},h.tsx("div",{class:this.classes(u.css.moreResults,e),key:"esri-search-renderer__container"},this._renderSearchResultName(),this._renderMoreResults()))}_renderMoreResults(){return h.tsx("div",{key:"esri-search-renderer__more-results"},this._renderMoreResultsButton(),this._renderMoreResultsLists())}_renderSearchResultName(){const e=this.viewModel?.selectedResult,s=e?.name||"";return h.tsx("div",{class:u.css.moreResultsItem,key:"esri-search-renderer__result-name"},s)}_renderMoreResultsLists(){const{viewModel:e}=this;if(!e)return[];const s=e.results;if((e.resultCount??0)<2)return null;const r=s?.map((e=>this._renderMoreResultsList(e)));return h.tsx("div",{class:u.css.moreResultsList,key:"esri-search-renderer__more-results-container"},r)}_renderMoreResultsButton(){const{messages:e,viewModel:s}=this;if(!s)return null;return(s.resultCount??0)<2?null:h.tsx("div",{class:u.css.moreResultsItem,key:"esri-search-renderer__more-results-button"},h.tsx("a",{bind:this,class:c.globalCss.anchor,href:"#",onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults))}_renderMoreResultsHeader(e,s){return h.tsx("div",{class:u.css.moreResultsListHeader,key:`esri-search-result-renderer__header-${s}`},e)}_renderMoreResultsList(e){const{results:s}=e,r=s?.length??0,t=r>0,l=this.viewModel?.selectedResult,o=1===r&&s[0]===l,i=this._getSourceName(e.source,e.sourceIndex),u=(this.viewModel?.results?.length??0)>1&&!o?this._renderMoreResultsHeader(i,e.sourceIndex):null,n=t&&s.map(((e,s)=>this._renderMoreResultsListItem(e,s))),c=t&&!o?h.tsx("ul",{key:`esri-search-result-renderer__list-${e.sourceIndex}`},n):null;return t?h.tsx("div",{key:`esri-search-result-renderer__results-${e.sourceIndex}`},u,c):null}_renderMoreResultsListItem(e,s){const r=this.viewModel?.selectedResult;return e!==r?h.tsx("li",{key:`esri-search-result-renderer__list-item-${s}`},h.tsx("a",{bind:this,class:c.globalCss.anchor,"data-result":e,href:"#",onclick:this._selectResultClick,onkeydown:this._selectResultClick,tabIndex:0},e.name)):null}_showMoreResultsClick(e){e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const s=this.viewModel?.view?.popup;s&&"reposition"in s&&s.reposition()}_selectResultClick(e){e.preventDefault();const s=e.currentTarget["data-result"];this.viewModel?.select(s)}_getSourceName(e,s){return s===n.ALL_INDEX?this.messages.all:e.name}};e.__decorate([s.property(),d.messageBundle("esri/widgets/Search/t9n/Search")],p.prototype,"messages",void 0),e.__decorate([s.property()],p.prototype,"showMoreResultsOpen",void 0),e.__decorate([s.property()],p.prototype,"viewModel",void 0),e.__decorate([a.accessibleHandler()],p.prototype,"_showMoreResultsClick",null),e.__decorate([a.accessibleHandler()],p.prototype,"_selectResultClick",null),p=e.__decorate([o.subclass("esri.widgets.Search.SearchResultRenderer")],p);return p}));
